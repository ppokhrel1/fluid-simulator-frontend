/* See third-party-licenses.txt for licenses of any bundled software. */
(()=>{"use strict";var e,t,s,a={3324:(e,t,s)=>{var a=s(3696),n=s(7470),r=s(908),i=(s(3617),s(9930),s(6792)),l=s(4426),o=s(5184),c=s(8608),d=s(9024),m=s(6374),u=s(1906),p=s(6062),h=s(2540);const g=({gridVisible:e,autoRotateEnabled:t,currentFile:s,onModelLoaded:n,onPartHover:r,onPartSelect:p})=>{const g=(0,a.useRef)(null),f=(0,a.useRef)(new o.YJl),{invalidate:x,camera:b,gl:y,size:j}=(0,u.C)(),v=(0,a.useRef)(null),w=(0,a.useRef)(null),N=e=>{let t=e;for(;t&&"Mesh"!==t.type;)t=t.parent;return t};return a.useEffect(()=>{n({controlsRef:g,isolatePart:e=>{if(!f.current)return;let t;if(f.current.traverse(s=>{(s.name&&s.name===e||s.uuid===e)&&(t=s)}),t){let e=t;for(;e&&e.parent!==f.current;)e=e.parent;f.current.children.forEach(t=>{t.visible=t===e})}},clearIsolation:()=>{f.current&&f.current.traverse(e=>e.visible=!0)}})},[n]),a.useEffect(()=>{g.current&&(g.current.autoRotate=t,x())},[t,x]),a.useEffect(()=>{if(!s)return;let e=null;(async()=>{try{const t=s.name.toLowerCase().split(".").pop();let a;switch(e=URL.createObjectURL(s),t){case"stl":const s=new c.t,n=await new Promise((t,a)=>{s.load(e,t,void 0,a)});a=new o.eaF(n,new o._4j({color:"#3b82f6",roughness:.3,metalness:.1}));break;case"obj":const r=new d.L;a=await new Promise((t,s)=>{r.load(e,t,void 0,s)}),a.traverse(e=>{e instanceof o.eaF&&(e.material=new o._4j({color:"#3b82f6",roughness:.3,metalness:.1}))});break;case"glb":case"gltf":const i=new m.B;a=(await new Promise((t,s)=>{i.load(e,t,void 0,s)})).scene;break;default:throw new Error(`Unsupported file format: ${t}`)}f.current.clear();const r=(new o.NRn).setFromObject(a),i=r.getCenter(new o.Pq0),l=r.getSize(new o.Pq0);a.position.sub(i);const u=Math.max(l.x,l.y,l.z),p=3/(u||1);a.scale.setScalar(p),f.current.add(a);const h=new o.iyt;r.getBoundingSphere(h);const x=(h.radius||u/2)*p;if(g.current&&g.current.object){const e=g.current.object,t=Math.max(3,2.2*x);e.position.set(t,Math.max(.8*x,1)+.05*t,t),e.lookAt(0,0,0),g.current.target.set(0,0,0),g.current.update()}else g.current&&g.current.reset();n({controlsRef:g,isolatePart:e=>{},clearIsolation:()=>{}})}catch(e){console.error("Error loading model:",e),alert(`Error loading model: ${e}`)}finally{e&&(URL.revokeObjectURL(e),e=null)}})()},[s]),a.useEffect(()=>{const e=y.domElement,t=new o.tBo,s=new o.I9Y,a=a=>{if(!f.current)return;const n=e.getBoundingClientRect();s.x=(a.clientX-n.left)/n.width*2-1,s.y=-(a.clientY-n.top)/n.height*2+1,t.setFromCamera(s,b);const i=t.intersectObjects(f.current.children,!0);if(i.length){const e=i[0].object,t=N(e);if(t){const e=new o.Pq0;t.getWorldPosition(e);const s=e.clone().project(b),a=(s.x+1)/2*n.width+n.left,i=(1-s.y)/2*n.height+n.top;if(v.current!==t){if(v.current&&v.current.material){const e=v.current.material;v.current.userData&&v.current.userData._origEmissive&&(e.emissive=v.current.userData._origEmissive)}if(t.material){const e=t.material;t.userData._origEmissive=e.emissive?e.emissive.clone():new o.Q1f(0);try{e.emissive=new o.Q1f(10451690)}catch(e){}}v.current=t}return void(r&&r({name:t.name||t.uuid,metadata:t.userData||{},screen:{x:a,y:i}}))}}if(v.current&&v.current.material){const e=v.current.material;v.current.userData&&v.current.userData._origEmissive&&(e.emissive=v.current.userData._origEmissive)}v.current=null,r&&r(null)},n=a=>{if(!f.current)return;const n=e.getBoundingClientRect();s.x=(a.clientX-n.left)/n.width*2-1,s.y=-(a.clientY-n.top)/n.height*2+1,t.setFromCamera(s,b);const r=t.intersectObjects(f.current.children,!0);if(r.length){const e=r[0].object,t=N(e);if(t){let e=t;for(;e&&e.parent!==f.current;)e=e.parent;if(e)return f.current.children.forEach(t=>t.visible=t===e),w.current=e,void(p&&p({name:t.name||t.uuid,metadata:t.userData||{}}))}}f.current.children.forEach(e=>e.visible=!0),w.current=null,p&&p(null)};return e.addEventListener("pointermove",a),e.addEventListener("pointerdown",n),()=>{e.removeEventListener("pointermove",a),e.removeEventListener("pointerdown",n)}},[y,b,r,p]),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("ambientLight",{intensity:.5}),(0,h.jsx)("directionalLight",{position:[10,10,10],intensity:1,castShadow:!0}),(0,h.jsx)("hemisphereLight",{color:8947967,groundColor:4473924,intensity:.6}),e&&(0,h.jsx)(i.x,{position:[0,-1,0],args:[20,20],cellSize:1,cellColor:4473924,sectionSize:5,sectionColor:2236962,fadeDistance:30}),(0,h.jsx)("group",{ref:f}),(0,h.jsx)(l.N,{ref:g,enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,dampingFactor:.05,minDistance:.5,maxDistance:100,maxPolarAngle:Math.PI,mouseButtons:{LEFT:o.kBv.ROTATE,MIDDLE:o.kBv.DOLLY,RIGHT:o.kBv.PAN}})]})},f=(0,a.forwardRef)(({onStateUpdate:e,appState:t},s)=>{const[n,r]=(0,a.useState)(null),i=(0,a.useRef)(null),l=(0,a.useRef)(null),o=(0,a.useRef)(null),[c,d]=(0,a.useState)(null),[m,u]=(0,a.useState)(null),f=t=>{[".stl",".obj",".glb",".gltf"].some(e=>t.name.toLowerCase().endsWith(e))?(e({status:`Loading ${t.name}...`}),r(t)):alert("Please upload STL, OBJ, GLB, or GLTF files only.")};return(0,a.useImperativeHandle)(s,()=>({loadFile:f,processMessage:s=>{s.file&&f(s.file),setTimeout(()=>{const a={type:"ai",content:`Processed: "${s.message}"`,time:(new Date).toLocaleTimeString()};e({chatMessages:[...t.chatMessages,a]})},1e3)},resetCamera:()=>{i.current&&(i.current.reset(),e({status:"Camera reset to initial view."}),setTimeout(()=>{e({status:n?`${n.name} loaded - Analysis ready`:"Ready for upload"})},1500))},toggleGrid:()=>{e({gridVisible:!t.gridVisible})},toggleAutoRotate:()=>{e({autoRotateEnabled:!t.autoRotateEnabled})},takeScreenshot:()=>{const e=document.querySelector("canvas");if(e){const t=document.createElement("a");t.download=`curfd_screenshot_${Date.now()}.png`,t.href=e.toDataURL(),t.click()}},isolatePart:e=>{l.current&&l.current(e)},clearIsolation:()=>{o.current&&o.current()}})),(0,h.jsxs)("div",{style:{position:"relative",width:"100%",height:"100%"},children:[(0,h.jsx)(p.Hl,{shadows:!0,camera:{position:[5,3,5],fov:50,near:.1,far:1e3},gl:{antialias:!0,alpha:!0},style:{background:"transparent",width:"100%",height:"100%"},onCreated:({gl:e})=>{e.setClearColor(988970)},children:(0,h.jsx)(g,{gridVisible:t.gridVisible,autoRotateEnabled:t.autoRotateEnabled,currentFile:n,onModelLoaded:t=>{t?.controlsRef&&(i.current=t.controlsRef.current),t?.isolatePart&&(l.current=t.isolatePart),t?.clearIsolation&&(o.current=t.clearIsolation),n&&e({status:`${n.name} loaded - Analysis ready`})},onPartHover:e=>d(e),onPartSelect:e=>u(e)})}),c&&(0,h.jsx)("div",{className:"three-tooltip",style:{position:"absolute",left:Math.max(8,c.screen.x)+"px",top:Math.max(8,c.screen.y)+"px",transform:"translate(-50%, -120%)",pointerEvents:"none",zIndex:2e3},children:(0,h.jsxs)("div",{style:{background:"rgba(0,0,0,0.7)",color:"white",padding:"6px 10px",borderRadius:6,fontSize:12,maxWidth:220},children:[(0,h.jsx)("div",{style:{fontWeight:600,marginBottom:4},children:c.name}),c.metadata&&Object.keys(c.metadata).length>0&&(0,h.jsx)("div",{style:{fontSize:11,opacity:.9},children:JSON.stringify(c.metadata)})]})}),m&&(0,h.jsx)("div",{style:{position:"absolute",right:12,bottom:12,zIndex:2e3},children:(0,h.jsxs)("div",{style:{background:"rgba(0,0,0,0.7)",color:"white",padding:"10px 12px",borderRadius:8,minWidth:200},children:[(0,h.jsx)("div",{style:{fontWeight:700},children:m.name}),(0,h.jsx)("div",{style:{fontSize:12,marginTop:6},children:Object.keys(m.metadata||{}).length?JSON.stringify(m.metadata):"No metadata"}),(0,h.jsx)("div",{style:{marginTop:8},children:(0,h.jsx)("button",{className:"btn btn-sm btn-light",onClick:()=>{o.current&&(o.current(),u(null))},children:"Clear Isolation"})})]})})]})});f.displayName="ThreeJSCanvas";const x=f;s(3991);const b=(e=new Date)=>e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),y=[{id:"gpt-4-turbo",name:"GPT-4 Turbo"},{id:"claude-3.5",name:"Claude 3.5"},{id:"openfoam",name:"OpenFOAM"},{id:"gemini-pro",name:"Gemini Pro"}],j=({onSendMessage:e,selectedModel:t=y[0].id,onModelChange:s})=>{const[n,r]=(0,a.useState)([]),[i,l]=(0,a.useState)(""),[o,c]=(0,a.useState)(!1),d=(0,a.useRef)(null);(0,a.useEffect)(()=>{r([{type:"ai",content:"Hello â€” I can help with your simulation. Ask me anything!",time:b()}])},[]),(0,a.useEffect)(()=>{d.current?.scrollIntoView({behavior:"smooth"})},[n,o]);const m=t=>{const s=i.trim();if(!s&&!t)return;const a={type:"user",content:s||(t?`Uploaded ${t.name}`:""),time:b(),file:void 0};r(e=>[...e,a]),e&&e(s,t),l(""),c(!0),setTimeout(()=>{const e={type:"ai",content:t?`I've received ${t.name}. What would you like me to analyze?`:`Echo: ${s}`,time:b()};r(t=>[...t,e]),c(!1)},700+800*Math.random())};return(0,h.jsxs)("div",{className:"chat-container d-flex flex-column rounded-3 shadow-lg",style:{maxHeight:"calc(100vh - 92px)"},children:[(0,h.jsxs)("div",{className:"d-flex align-items-center justify-content-between p-3 border-bottom border-secondary",children:[(0,h.jsxs)("div",{className:"d-flex align-items-center gap-3",children:[(0,h.jsx)("img",{src:"/curfdlogo.png",alt:"CURFD",style:{height:"24px"}}),(0,h.jsx)("div",{children:(0,h.jsx)("strong",{className:"text-white",children:"CURFD AI"})})]}),(0,h.jsx)("select",{value:t,onChange:e=>s?.(e.target.value),className:"form-select form-select-sm chat-input rounded-pill px-3",style:{width:"auto",backgroundColor:"rgba(255,255,255,0.1)"},children:y.map(e=>(0,h.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,h.jsxs)("div",{className:"flex-grow-1 p-3",style:{overflowY:"auto",maxHeight:"60vh"},children:[n.map((e,t)=>(0,h.jsxs)("div",{className:"mb-4 "+("user"===e.type?"text-end":"text-start"),children:["ai"===e.type&&(0,h.jsxs)("div",{className:"d-flex align-items-center mb-2",children:[(0,h.jsx)("div",{className:"p-1 me-2",style:{background:"var(--brand-gradient)",borderRadius:"50%"},children:(0,h.jsx)("i",{className:"fas fa-robot text-white",style:{fontSize:12}})}),(0,h.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,h.jsx)("span",{className:"text-white fw-medium",children:"CURFD AI"}),(0,h.jsx)("span",{className:"text-white-50 small",children:e.time})]})]}),(0,h.jsx)("div",{className:"message-bubble "+("user"===e.type?"user":"ai"),children:e.content}),"user"===e.type&&(0,h.jsx)("div",{className:"text-white-50 small mt-1",children:e.time})]},t)),o&&(0,h.jsxs)("div",{className:"text-start mb-3",children:[(0,h.jsxs)("div",{className:"d-flex align-items-center mb-1",children:[(0,h.jsx)("div",{className:"bg-primary rounded-circle p-1 me-2",children:(0,h.jsx)("i",{className:"fas fa-robot text-white",style:{fontSize:12}})}),(0,h.jsx)("small",{className:"text-primary",children:"AI"})]}),(0,h.jsx)("div",{className:"bg-secondary bg-opacity-25 text-white p-3 rounded d-inline-block border border-secondary",children:(0,h.jsxs)("div",{className:"d-flex align-items-center gap-2 text-muted",children:[(0,h.jsx)("span",{children:"Typing"}),(0,h.jsxs)("div",{className:"d-flex gap-1",children:[(0,h.jsx)("div",{className:"bg-primary rounded-circle",style:{width:6,height:6}}),(0,h.jsx)("div",{className:"bg-primary rounded-circle",style:{width:6,height:6}}),(0,h.jsx)("div",{className:"bg-primary rounded-circle",style:{width:6,height:6}})]})]})})]}),(0,h.jsx)("div",{ref:d})]}),(0,h.jsxs)("div",{className:"p-3 mt-auto",children:[(0,h.jsx)("div",{className:"d-flex gap-2",children:(0,h.jsxs)("div",{className:"input-group",children:[(0,h.jsx)("input",{type:"text",className:"chat-input form-control rounded-start-pill px-3 py-2",placeholder:"Type your message...",value:i,onChange:e=>l(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),m())}}),(0,h.jsx)("button",{type:"button",className:"btn chat-input rounded-0 px-3",onClick:()=>document.getElementById("chat-file-input")?.click(),title:"Upload file",style:{borderLeft:"1px solid var(--chat-border)",borderRight:"1px solid var(--chat-border)"},children:(0,h.jsx)("i",{className:"fas fa-paperclip text-white-50"})}),(0,h.jsx)("button",{type:"button",className:"btn rounded-end-pill px-4 "+(i.trim()?"btn-brand":"chat-input"),onClick:()=>m(),disabled:o||!i.trim(),children:(0,h.jsx)("i",{className:"fas fa-paper-plane"})})]})}),(0,h.jsx)("input",{id:"chat-file-input",type:"file",className:"d-none",onChange:e=>{const t=e.target.files?.[0];t&&m(t),e.target&&(e.target.value="")},accept:".stl,.obj,.step,.stp,.iges,.glb"})]})]})},v=({onUploadModel:e,onResetView:t,onToggleGrid:s,onAutoRotate:a,onScreenshot:n,gridVisible:r,autoRotateEnabled:i})=>{const l=e=>{const t="btn rounded-pill mx-1 border-0";return e?`${t} btn-primary text-white`:`${t} btn-outline-secondary text-white`};return(0,h.jsxs)("div",{className:"bg-light bg-opacity-75 rounded-pill p-2 border border-secondary d-flex",children:[(0,h.jsxs)("button",{className:l(r),onClick:s,children:[(0,h.jsx)("i",{className:"fas fa-th me-2"}),"Grid"]}),(0,h.jsxs)("button",{className:l(i),onClick:a,children:[(0,h.jsx)("i",{className:"fas fa-sync-alt me-2"}),"Auto Rotate"]}),(0,h.jsxs)("button",{className:l(!1),onClick:t,children:[(0,h.jsx)("i",{className:"fas fa-refresh me-2"}),"Reset View"]}),(0,h.jsxs)("button",{className:l(!1),onClick:e,children:[(0,h.jsx)("i",{className:"fas fa-upload me-2"}),"Upload"]}),(0,h.jsxs)("button",{className:l(!1),onClick:n,children:[(0,h.jsx)("i",{className:"fas fa-camera me-2"}),"Screenshot"]})]})};async function w(e,t,s="gpt-4-turbo",a){return a?.apiUrl||process.env.REACT_APP_AI_API_URL?async function(e,t,s,a){const n=a?.apiUrl||process.env.REACT_APP_AI_API_URL;if(!n)return"[API URL not configured]";try{if(t){const a=new FormData;a.append("message",e),a.append("file",t),s&&a.append("model",s);const r=await fetch(n,{method:"POST",body:a});if(!r.ok)throw new Error(`API returned ${r.status}`);const i=await r.json();return i?.reply||JSON.stringify(i)}const a=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,model:s})});if(!a.ok)throw new Error(`API returned ${a.status}`);const r=await a.json();return r?.reply||JSON.stringify(r)}catch(e){return console.error("API error:",e),`[API error] ${e?.message||String(e)}`}}(e,t,s,a):s.startsWith("gpt-")?async function(e,t,s="gpt-4-turbo",a){const n=a?.apiKey||process.env.REACT_APP_OPENAI_API_KEY;if(!n)return"[OpenAI API key not configured]";try{let a=[{role:"user",content:e}];if(t){const s=await new Promise(e=>{const s=new FileReader;s.onload=()=>e(s.result),s.readAsDataURL(t)});a=[{role:"system",content:"The user is uploading a 3D model file for analysis."},{role:"user",content:`Analyzing file: ${t.name}\nBase64 data: ${s}\n\nUser message: ${e}`}]}const r=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({model:s,messages:a,temperature:.7})});if(!r.ok)throw new Error(`OpenAI API returned ${r.status}`);const i=await r.json();return i.choices?.[0]?.message?.content||JSON.stringify(i)}catch(e){return console.error("OpenAI API error:",e),`[OpenAI error] ${e?.message||String(e)}`}}(e,t,s,a):s.startsWith("claude-")?async function(e,t,s="claude-3-opus-20240229",a){const n=a?.apiKey||process.env.REACT_APP_ANTHROPIC_API_KEY;if(!n)return"[Claude API key not configured]";try{let a=[{role:"user",content:e}];if(t){const s=await new Promise(e=>{const s=new FileReader;s.onload=()=>e(s.result),s.readAsDataURL(t)});a=[{role:"system",content:"You are analyzing 3D model files for CFD simulation."},{role:"user",content:`File: ${t.name}\nData: ${s}\n\nQuery: ${e}`}]}const r=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":n,"anthropic-version":"2023-06-01"},body:JSON.stringify({model:s,messages:a,max_tokens:1024})});if(!r.ok)throw new Error(`Claude API returned ${r.status}`);const i=await r.json();return i.content?.[0]?.text||JSON.stringify(i)}catch(e){return console.error("Claude API error:",e),`[Claude error] ${e?.message||String(e)}`}}(e,t,s,a):"gemini-pro"===s?async function(e,t,s){const a=s?.apiKey||process.env.REACT_APP_GEMINI_API_KEY;if(!a)return"[Gemini API key not configured]";try{const s=[{text:e}];if(t){const e=await new Promise(e=>{const s=new FileReader;s.onload=()=>e(s.result),s.readAsDataURL(t)});s.push({inlineData:{mimeType:t.type,data:e.split(",")[1]}})}const n=await fetch(`https://generativelanguage.googleapis.com/v1/models/gemini-pro:generateContent?key=${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:s}]})});if(!n.ok)throw new Error(`Gemini API returned ${n.status}`);const r=await n.json();return r.candidates?.[0]?.content?.parts?.[0]?.text||JSON.stringify(r)}catch(e){return console.error("Gemini API error:",e),`[Gemini error] ${e?.message||String(e)}`}}(e,t,a):"openfoam"===s?"[OpenFOAM integration not yet implemented]":`[Unknown model: ${s}] Please configure an AI provider`}s(3110);const N=()=>{const[e,t]=(0,a.useState)({leftDockExpanded:!1,isTyping:!1,chatMessages:[{type:"ai",content:"Hello! I'm CURFD AI. Upload a 3D model to begin CFD analysis.",time:(new Date).toLocaleTimeString()}],selectedAiModel:"gpt-4-turbo",uploadedFiles:[],status:"Ready for analysis",gridVisible:!0,autoRotateEnabled:!1,view:"main"}),s=(0,a.useRef)(null),n=(0,a.useRef)(null),r=e=>{t(t=>({...t,...e}))},i=(e,t)=>{console.log(`Three action: ${e}`,t),s.current&&s.current[e]?s.current[e](t):console.warn(`Three action ${e} not available`)};return(0,h.jsxs)("div",{className:"app vh-100 vw-100 p-0 m-0 bg-dark overflow-hidden",children:[(0,h.jsxs)("div",{className:"fixed-top d-flex align-items-center px-4 py-2",style:{zIndex:1050,background:"var(--chat-bg)",backdropFilter:"blur(20px)",borderBottom:"1px solid var(--chat-border)"},children:[(0,h.jsxs)("div",{className:"d-flex align-items-center gap-3",children:[(0,h.jsx)("img",{src:"/curfdlogo.png",alt:"CURFD",style:{height:"40px",filter:"brightness(1.2) contrast(1.1)"}}),(0,h.jsxs)("div",{className:"d-flex flex-column",children:[(0,h.jsx)("strong",{className:"text-white",style:{fontSize:"1.2rem"},children:"CURFD"}),(0,h.jsx)("small",{className:"text-white-50",children:"V3 - Advanced AI CFD Engine"})]})]}),(0,h.jsx)("div",{className:"ms-auto",children:(0,h.jsx)("span",{className:"text-white-50",children:e.status})})]}),(0,h.jsx)("div",{className:"position-fixed inset-0 w-100 h-100",style:{top:"60px"},children:(0,h.jsx)(x,{ref:s,onStateUpdate:r,appState:e})}),(0,h.jsx)("div",{className:"position-fixed",style:{top:"76px",right:"16px",width:"400px",zIndex:1040},children:(0,h.jsx)(j,{onSendMessage:async(t,s)=>{const a={type:"user",content:t||(s?`Uploaded ${s.name}`:""),time:(new Date).toLocaleTimeString()};r({chatMessages:[...e.chatMessages,a],isTyping:!0}),s&&i("loadFile",s),i("processMessage",{message:t,file:s});let n="";try{n=await w(t,s,e.selectedAiModel)}catch(e){n=`[AI error] ${e?.message||String(e)}`}const l={type:"ai",content:n,time:(new Date).toLocaleTimeString()};r({chatMessages:[...e.chatMessages,a,l],isTyping:!1})},selectedModel:e.selectedAiModel,onModelChange:e=>r({selectedAiModel:e})})}),(0,h.jsxs)("div",{className:"fab-container",children:[(0,h.jsx)("button",{className:"fab-button "+(e.gridVisible?"active":""),onClick:()=>{const t=!e.gridVisible;r({gridVisible:t}),i("toggleGrid")},children:"Grid"}),(0,h.jsx)("button",{className:"fab-button "+(e.autoRotateEnabled?"active":""),onClick:()=>{const t=!e.autoRotateEnabled;r({autoRotateEnabled:t}),i("toggleAutoRotate")},children:"Auto Rotate"}),(0,h.jsx)("button",{className:"fab-button",onClick:()=>{console.log("Reset view called"),i("resetCamera")},children:"Reset View"}),(0,h.jsx)("button",{className:"fab-button",onClick:()=>n.current?.click(),children:"Upload"}),(0,h.jsx)("button",{className:"fab-button",onClick:()=>i("takeScreenshot"),children:"Screenshot"}),(0,h.jsx)("input",{ref:n,type:"file",className:"d-none",accept:".stl,.obj,.step,.stp,.iges,.glb",onChange:e=>{console.log("File input changed",e.target.files),e.target.files?.[0]&&(i("loadFile",e.target.files[0]),e.target.value="")}})]}),(0,h.jsx)("div",{className:"position-fixed start-0 ms-4 rounded chat-container",style:{zIndex:1040,top:"50%",transform:"translateY(-50%)",padding:"1rem",background:"rgba(0, 0, 0, 0.7)",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:(0,h.jsxs)("div",{className:"d-flex flex-column align-items-center gap-2",children:[(0,h.jsx)("div",{className:"text-white small mb-1 fw-bold",children:"High"}),(0,h.jsx)("div",{style:{width:"28px",height:"220px",background:"linear-gradient(to bottom, #F44336, #FFC107, #4CAF50)",borderRadius:"14px",boxShadow:"0 6px 20px rgba(0,0,0,0.4) inset, 0 4px 12px rgba(0,0,0,0.3)",border:"2px solid rgba(255,255,255,0.04)"}}),(0,h.jsx)("div",{className:"text-white small mt-1 fw-bold",children:"Low"}),(0,h.jsx)("div",{className:"text-white-50 small text-center mt-2",style:{width:"140px"},children:"Pressure Distribution"})]})})]})};var S=s(4264),A=s(1660),C=s(9211),R=s(9101),T=s(6132);const k=({onModelSelect:e,onBackToMain:t})=>{const[s,n]=(0,a.useState)([]),[r,i]=(0,a.useState)(!0),l=[{id:"1",name:"Car Design v2.stl",fileName:"Car Design v2.stl",uploadDate:"2024-01-15T10:30:00Z",fileSize:"2.4 MB",type:"stl",analysisStatus:"completed",lastOpened:"2024-01-16T14:20:00Z",thumbnail:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQU2_3Bc48L58cNSMvnWkHQMCh2Ue9jNIC6kw&s",tags:["vehicle","aerodynamics"]},{id:"2",name:"Airplane Wing.stl",fileName:"Airplane Wing.stl",uploadDate:"2024-01-14T16:45:00Z",fileSize:"1.8 MB",type:"stl",analysisStatus:"completed",lastOpened:"2024-01-15T09:15:00Z",thumbnail:"https://media.printables.com/media/prints/768011/images/5979348_a352c031-c3ea-4c4a-9265-edc84a2e2fe8_d49f1449-a16b-452b-8894-2d3c9acbeb53/thumbs/inside/1280x960/png/screen-shot-2024-02-16-at-51843-pm.webp",tags:["aerospace","wing"]},{id:"3",name:"Turbine Blade.stl",fileName:"Turbine Blade.stl",uploadDate:"2024-01-13T11:20:00Z",fileSize:"3.1 MB",type:"stl",analysisStatus:"in-progress",lastOpened:"2024-01-14T10:30:00Z",thumbnail:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTmiO1QxCldQwWTMRMYEH5mN84-UHqLSg03CQ&s",tags:["energy","blade"]},{id:"4",name:"Building Structure.obj",fileName:"Building Structure.obj",uploadDate:"2024-01-12T08:15:00Z",fileSize:"5.2 MB",type:"obj",analysisStatus:"completed",lastOpened:"2024-01-13T16:45:00Z",thumbnail:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTy8Lfol3dmMkE5nv_LcUWL6LmZkuwGfkBmFQ&s",tags:["architecture","structural"]},{id:"5",name:"Drone Frame.glb",fileName:"Drone Frame.glb",uploadDate:"2024-01-11T14:30:00Z",fileSize:"4.7 MB",type:"glb",analysisStatus:"pending",lastOpened:null,thumbnail:"https://content.instructables.com/FK2/TEUK/I3THY4DM/FK2TEUKI3THY4DM.jpg?auto=webp&frame=1&width=2100",tags:["uav","frame"]}];(0,a.useEffect)(()=>{setTimeout(()=>{n(l),i(!1)},1e3)},[]);const o=e=>{switch(e){case"completed":return(0,h.jsx)(S.A,{bg:"success",children:"Completed"});case"in-progress":return(0,h.jsx)(S.A,{bg:"warning",children:"In Progress"});case"pending":default:return(0,h.jsx)(S.A,{bg:"secondary",children:"Pending"});case"error":return(0,h.jsx)(S.A,{bg:"danger",children:"Error"})}},c=e=>({stl:"fas fa-cube",obj:"fas fa-shapes",glb:"fas fa-cube",gltf:"fas fa-cube",step:"fas fa-project-diagram",stp:"fas fa-project-diagram"}[e]||"fas fa-file"),d=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never";return r?(0,h.jsx)("div",{className:"bg-light min-vh-100 text-white",children:(0,h.jsx)(A.A,{className:"py-4",children:(0,h.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{height:"50vh"},children:(0,h.jsxs)("div",{className:"text-center",children:[(0,h.jsx)("div",{className:"spinner-border text-primary mb-3",role:"status",children:(0,h.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,h.jsx)("p",{children:"Loading your models..."})]})})})}):(0,h.jsx)("div",{className:"bg-light min-vh-100 text-white",children:(0,h.jsxs)(A.A,{className:"py-4",children:[(0,h.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsxs)("h1",{className:"h3 mb-1",children:[(0,h.jsx)("i",{className:"fas fa-folder-open text-primary me-2"}),"My Models"]}),(0,h.jsxs)("p",{className:"text-muted mb-0",children:[s.length," model",1!==s.length?"s":""," uploaded"]})]}),(0,h.jsxs)("button",{className:"btn btn-outline-primary",onClick:t,children:[(0,h.jsx)("i",{className:"fas fa-arrow-left me-2"}),"Back to Analysis"]})]}),(0,h.jsx)(C.A,{children:s.map(t=>(0,h.jsx)(R.A,{lg:4,md:6,className:"mb-4",children:(0,h.jsxs)(T.A,{className:"h-100 bg-light border-secondary hover-shadow",children:[(0,h.jsxs)("div",{className:"position-relative",children:[t.thumbnail&&!t.thumbnail.includes("/api/placeholder")?(0,h.jsx)(T.A.Img,{variant:"top",src:t.thumbnail,alt:`Thumbnail for ${t.name}`,style:{height:"200px",objectFit:"cover",borderTopLeftRadius:"0.375rem",borderTopRightRadius:"0.375rem"}}):(0,h.jsx)("div",{className:"bg-secondary bg-opacity-25 d-flex align-items-center justify-content-center",style:{height:"200px",borderTopLeftRadius:"0.375rem",borderTopRightRadius:"0.375rem"},children:(0,h.jsx)("i",{className:`${c(t.type)} text-primary`,style:{fontSize:"3rem"}})}),(0,h.jsx)("div",{className:"position-absolute top-0 end-0 m-2",children:o(t.analysisStatus)})]}),(0,h.jsxs)(T.A.Body,{className:"d-flex flex-column",children:[(0,h.jsxs)("div",{className:"mb-2",children:[(0,h.jsx)("h6",{className:"card-title text-white mb-1",children:t.name}),(0,h.jsxs)("small",{className:"text-muted",children:[(0,h.jsx)("i",{className:`${c(t.type)} me-1`}),t.type.toUpperCase()," â€¢ ",t.fileSize]})]}),(0,h.jsxs)("div",{className:"mb-3",children:[t.tags.slice(0,3).map((e,t)=>(0,h.jsx)(S.A,{bg:"outline-secondary",text:"muted",className:"me-1 mb-1 border border-secondary",style:{fontSize:"0.7rem"},children:e},t)),t.tags.length>3&&(0,h.jsxs)(S.A,{bg:"outline-secondary",text:"muted",className:"border border-secondary",style:{fontSize:"0.7rem"},children:["+",t.tags.length-3]})]}),(0,h.jsx)("div",{className:"mt-auto",children:(0,h.jsxs)("div",{className:"d-flex justify-content-between text-muted small",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("i",{className:"fas fa-calendar me-1"}),d(t.uploadDate)]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("i",{className:"fas fa-clock me-1"}),d(t.lastOpened)]})]})})]}),(0,h.jsx)(T.A.Footer,{className:"bg-light border-secondary",children:(0,h.jsx)("div",{className:"d-grid gap-2",children:(0,h.jsxs)("button",{className:"btn btn-primary btn-sm",onClick:()=>e(t),children:[(0,h.jsx)("i",{className:"fas fa-wind me-2"}),"Analyze Model"]})})})]})},t.id))}),0===s.length&&(0,h.jsxs)("div",{className:"text-center py-5",children:[(0,h.jsx)("div",{className:"mb-4",children:(0,h.jsx)("i",{className:"fas fa-folder-open text-muted",style:{fontSize:"4rem"}})}),(0,h.jsx)("h4",{className:"text-muted mb-3",children:"No models uploaded yet"}),(0,h.jsx)("p",{className:"text-muted mb-4",children:"Upload your first 3D model to get started with CFD analysis."}),(0,h.jsxs)("button",{className:"btn btn-primary",onClick:t,children:[(0,h.jsx)("i",{className:"fas fa-upload me-2"}),"Upload First Model"]})]})]})})};s(1975);var P=s(8868),E=s(8688);const O=({onUpload:e,onCancel:t})=>{const[s,n]=(0,a.useState)(null),[r,i]=(0,a.useState)(""),[l,o]=(0,a.useState)(""),[c,d]=(0,a.useState)(""),[m,u]=(0,a.useState)(""),p=e=>`btn ${"primary"===e?"btn-primary text-white":"btn-secondary text-white"} rounded`;return(0,h.jsxs)(P.A,{onSubmit:e=>{e.preventDefault()},className:"p-3 bg-light rounded",children:[m&&(0,h.jsx)(E.A,{variant:"danger",children:m}),(0,h.jsxs)(P.A.Group,{className:"mb-3",children:[(0,h.jsx)(P.A.Label,{children:"3D Model File"}),(0,h.jsx)(P.A.Control,{type:"file",accept:".stl,.obj,.glb,.gltf,.step,.stp",onChange:t=>{const s=t.target.files?.[0];if(!s)return;const a=s.name.split(".").pop()?.toLowerCase()??"";if(!["stl","obj","glb","gltf","step","stp"].includes(a))return u("Unsupported file type. Allowed: STL, OBJ, GLB, GLTF, STEP, STP"),void n(null);n(s),i(s.name),u("");const r={id:Date.now().toString(),name:s.name,fileName:s.name,uploadDate:(new Date).toISOString(),fileSize:`${(s.size/1048576).toFixed(2)} MB`,type:a,analysisStatus:"pending",lastOpened:null,thumbnail:"",tags:c.split(",").map(e=>e.trim()).filter(Boolean),description:l,webLink:""};e(r,s)}})]}),(0,h.jsxs)(P.A.Group,{className:"mb-3",children:[(0,h.jsx)(P.A.Label,{children:"Name"}),(0,h.jsx)(P.A.Control,{type:"text",value:r,onChange:e=>i(e.target.value),placeholder:"Optional, will use file name if empty"})]}),(0,h.jsxs)(P.A.Group,{className:"mb-3",children:[(0,h.jsx)(P.A.Label,{children:"Description"}),(0,h.jsx)(P.A.Control,{as:"textarea",rows:3,value:l,onChange:e=>o(e.target.value),placeholder:"Optional notes"})]}),(0,h.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,h.jsx)("button",{type:"button",className:p("secondary"),onClick:t,children:"Cancel"}),(0,h.jsx)("button",{type:"submit",className:p("primary"),children:"Save Metadata"})]})]})},D=()=>{const e=(0,a.useRef)(null),[t,s]=(0,a.useState)(null),[n,r]=(0,a.useState)({gridVisible:!0,autoRotateEnabled:!1,chatMessages:[],leftDockExpanded:!1,selectedAiModel:"gpt-4-turbo",status:"Ready for upload",uploadedFiles:[],isTyping:!1,view:"main"});return(0,h.jsxs)("div",{className:"p-3",children:[(0,h.jsx)(O,{onUpload:(t,a)=>{console.log("Model selected:",t),console.log("File:",a),s(t),r(e=>({...e,uploadedFiles:[...e.uploadedFiles,t],status:`Loading ${t.name}...`})),e.current&&e.current.loadFile(a)},onCancel:()=>{console.log("Back to main"),alert("Going back to main page")}}),(0,h.jsx)("div",{className:"mt-3",style:{height:"500px",position:"relative"},children:(0,h.jsx)(x,{ref:e,appState:n,onStateUpdate:e=>r(t=>({...t,...e}))})}),(0,h.jsx)("div",{className:"mt-2",children:(0,h.jsx)(v,{gridVisible:n.gridVisible,autoRotateEnabled:n.autoRotateEnabled,onToggleGrid:()=>r(e=>({...e,gridVisible:!e.gridVisible})),onAutoRotate:()=>r(e=>({...e,autoRotateEnabled:!e.autoRotateEnabled})),onResetView:()=>e.current?.resetCamera(),onUploadModel:()=>console.log("Trigger upload"),onScreenshot:()=>e.current?.takeScreenshot()})})]})};function M(){return(0,h.jsxs)("div",{children:[(0,h.jsxs)("nav",{children:[(0,h.jsx)(r.N_,{to:"/",children:"Home"})," | ",(0,h.jsx)(r.N_,{to:"/about",children:"About"})," | ",(0,h.jsx)(r.N_,{to:"/contact",children:"Contact"})]}),(0,h.jsxs)(r.BV,{children:[(0,h.jsx)(r.qh,{path:"/",element:(0,h.jsx)(N,{})}),(0,h.jsx)(r.qh,{path:"/feed",element:(0,h.jsx)(k,{onModelSelect:e=>console.log("Selected:",e),onBackToMain:()=>window.history.back()})}),(0,h.jsx)(r.qh,{path:"/upload",element:(0,h.jsx)(D,{})})]})]})}const I=document.createElement("div");document.body.appendChild(I);n.createRoot(I).render((0,h.jsx)(a.StrictMode,{children:(0,h.jsx)(r.I9,{children:(0,h.jsx)(M,{})})}))}},n={};function r(e){var t=n[e];if(void 0!==t)return t.exports;var s=n[e]={exports:{}};return a[e].call(s.exports,s,s.exports,r),s.exports}r.m=a,e=[],r.O=(t,s,a,n)=>{if(!s){var i=1/0;for(d=0;d<e.length;d++){for(var[s,a,n]=e[d],l=!0,o=0;o<s.length;o++)(!1&n||i>=n)&&Object.keys(r.O).every(e=>r.O[e](s[o]))?s.splice(o--,1):(l=!1,n<i&&(i=n));if(l){e.splice(d--,1);var c=a();void 0!==c&&(t=c)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[s,a,n]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},s=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,r.t=function(e,a){if(1&a&&(e=this(e)),8&a)return e;if("object"==typeof e&&e){if(4&a&&e.__esModule)return e;if(16&a&&"function"==typeof e.then)return e}var n=Object.create(null);r.r(n);var i={};t=t||[null,s({}),s([]),s(s)];for(var l=2&a&&e;("object"==typeof l||"function"==typeof l)&&!~t.indexOf(l);l=s(l))Object.getOwnPropertyNames(l).forEach(t=>i[t]=()=>e[t]);return i.default=()=>e,r.d(n,i),n},r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={792:0};r.O.j=t=>0===e[t];var t=(t,s)=>{var a,n,[i,l,o]=s,c=0;if(i.some(t=>0!==e[t])){for(a in l)r.o(l,a)&&(r.m[a]=l[a]);if(o)var d=o(r)}for(t&&t(s);c<i.length;c++)n=i[c],r.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return r.O(d)},s=globalThis.webpackChunk=globalThis.webpackChunk||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var i=r.O(void 0,[360],()=>r(3324));i=r.O(i)})();