/* See third-party-licenses.txt for licenses of any bundled software. */
(()=>{"use strict";var e,s,a,t={4579:(e,s,a)=>{var t=a(3696),n=a(7470),r=a(908),l=(a(3617),a(1975),a(3242),a(3991),a(7227),a(1336),a(9858),a(8620),a(769),a(1591),a(6237),a(507),a(6993),a(7918),a(2455),a(5281),a(194),a(6913),a(8608),a(1e3),a(7368),a(2822),a(9828),a(7854),a(2477),a(9930),a(9659),a(4832),a(5963),a(3044),a(837),a(2680)),i=a(6792),o=a(4426),c=a(5184),d=a(6227),m=a(9024),h=a(6374),u=a(1906),g=a(6062),x=a(2540);const p=({position:e,pressure:s,onRemove:a})=>(0,x.jsxs)("group",{position:e,children:[(0,x.jsxs)("mesh",{children:[(0,x.jsx)("sphereGeometry",{args:[.05,16,16]}),(0,x.jsx)("meshStandardMaterial",{color:"#9F7AEA",emissive:"#6366F1",emissiveIntensity:.5})]}),(0,x.jsx)(l.E,{position:[0,.15,0],center:!0,distanceFactor:2,style:{pointerEvents:"auto"},children:(0,x.jsxs)("div",{style:{background:"linear-gradient(135deg, rgba(159, 122, 234, 0.95), rgba(99, 102, 241, 0.95))",color:"white",padding:"8px 12px",borderRadius:8,fontSize:13,fontWeight:600,boxShadow:"0 4px 12px rgba(0,0,0,0.4)",border:"2px solid rgba(255,255,255,0.2)",minWidth:80,textAlign:"center",position:"relative",userSelect:"none"},children:[(0,x.jsxs)("div",{style:{fontSize:16,fontWeight:700},children:[s.toFixed(1)," kPa"]}),(0,x.jsx)("div",{style:{fontSize:10,opacity:.9,marginTop:2},children:"Pressure"}),(0,x.jsx)("button",{onClick:a,style:{position:"absolute",top:-6,right:-6,width:18,height:18,borderRadius:"50%",background:"rgba(239, 68, 68, 0.9)",border:"1px solid white",color:"white",fontSize:10,fontWeight:700,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",padding:0},children:"✕"})]})})]}),b=({gridVisible:e,autoRotateEnabled:s,currentFile:a,onModelLoaded:n,onPartHover:r,onPartSelect:l,onPressureClick:g,pressureMarkers:b,onRemoveMarker:f})=>{const j=(0,t.useRef)(null),y=(0,t.useRef)(new c.YJl),{invalidate:v,camera:N,gl:w,size:S}=(0,u.C)(),k=((0,t.useRef)(null),(0,t.useRef)(null)),A=(0,t.useRef)(null);return t.useEffect(()=>{n({controlsRef:j,isolatePart:e=>{if(!y.current)return;let s;if(y.current.traverse(a=>{(a.name&&a.name===e||a.uuid===e)&&(s=a)}),s){let e=s;for(;e&&e.parent!==y.current;)e=e.parent;y.current.children.forEach(s=>{s.visible=s===e})}},clearIsolation:()=>{y.current&&y.current.traverse(e=>e.visible=!0)}})},[n]),t.useEffect(()=>{j.current&&(j.current.autoRotate=s,v())},[s,v]),t.useEffect(()=>{if(!a)return;let e=null;(async()=>{try{const s=a.name.toLowerCase().split(".").pop();let t;switch(e=URL.createObjectURL(a),s){case"stl":const a=new d.t,n=await new Promise((s,t)=>{a.load(e,s,void 0,t)});n.computeBoundingBox(),n.boundingBox&&(A.current={minY:n.boundingBox.min.y,maxY:n.boundingBox.max.y});const r=n.attributes.position,l=new Float32Array(3*r.count);for(let e=0;e<r.count;e++){const s=r.getY(e),a=n.boundingBox?.min.y??-1,t=(s-a)/((n.boundingBox?.max.y??1)-a),i=new c.Q1f;t<.5?i.setRGB(2*t,1,0):i.setRGB(1,1-2*(t-.5),0),l[3*e]=i.r,l[3*e+1]=i.g,l[3*e+2]=i.b}n.setAttribute("color",new c.THS(l,3)),t=new c.eaF(n,new c._4j({vertexColors:!0,roughness:.3,metalness:.1}));break;case"obj":const i=new m.L;t=await new Promise((s,a)=>{i.load(e,s,void 0,a)}),t.traverse(e=>{if(e instanceof c.eaF&&e.geometry){const s=e.geometry;s.boundingBox||s.computeBoundingBox(),!A.current&&s.boundingBox&&(A.current={minY:s.boundingBox.min.y,maxY:s.boundingBox.max.y});const a=s.attributes.position,t=new Float32Array(3*a.count);for(let e=0;e<a.count;e++){const n=a.getY(e),r=s.boundingBox?.min.y??-1,l=(n-r)/((s.boundingBox?.max.y??1)-r),i=new c.Q1f;l<.5?i.setRGB(2*l,1,0):i.setRGB(1,1-2*(l-.5),0),t[3*e]=i.r,t[3*e+1]=i.g,t[3*e+2]=i.b}s.setAttribute("color",new c.THS(t,3)),e.material=new c._4j({vertexColors:!0,roughness:.3,metalness:.1})}});break;case"glb":case"gltf":const o=new h.B;t=(await new Promise((s,a)=>{o.load(e,s,void 0,a)})).scene;break;default:throw new Error(`Unsupported file format: ${s}`)}y.current.clear(),y.current.add(t);const r=(new c.NRn).setFromObject(y.current),l=r.getCenter(new c.Pq0),i=r.getSize(new c.Pq0),o=Math.max(i.x,i.y,i.z);y.current.position.set(-l.x,-l.y,-l.z);const u=3,g=u/(o||1);if(y.current.scale.setScalar(g),j.current&&j.current.object){const e=j.current.object,s=2.5*u;e.position.set(s,.6*s,s),e.lookAt(0,0,0),j.current.target.set(0,0,0),j.current.update()}else j.current&&j.current.reset();n({controlsRef:j,isolatePart:e=>{},clearIsolation:()=>{}})}catch(e){console.error("Error loading model:",e),alert(`Error loading model: ${e}`)}finally{e&&(URL.revokeObjectURL(e),e=null)}})()},[a]),t.useEffect(()=>{const e=w.domElement,s=new c.tBo,a=new c.I9Y,t=t=>{if(!y.current)return;const n=e.getBoundingClientRect();a.x=(t.clientX-n.left)/n.width*2-1,a.y=-(t.clientY-n.top)/n.height*2+1,s.setFromCamera(a,N);const r=s.intersectObjects(y.current.children,!0);if(r.length){const e=r[0],s=e.object;if(A.current&&e.point){const s=e.point.y,{minY:a,maxY:t}=A.current,n=100*((s-a)/(t-a)),r=[e.point.x,e.point.y,e.point.z];g&&g({pressure:n,worldPosition:r})}const a=(e=>{let s=e;for(;s&&"Mesh"!==s.type;)s=s.parent;return s})(s);if(a){let e=a;for(;e&&e.parent!==y.current;)e=e.parent;if(e)return y.current.children.forEach(s=>s.visible=s===e),k.current=e,void(l&&l({name:a.name||a.uuid,metadata:a.userData||{}}))}}y.current.children.forEach(e=>e.visible=!0),k.current=null,l&&l(null)};return e.addEventListener("pointerdown",t),()=>{e.removeEventListener("pointerdown",t)}},[w,N,l,g]),(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("ambientLight",{intensity:.5}),(0,x.jsx)("directionalLight",{position:[10,10,10],intensity:1,castShadow:!0}),(0,x.jsx)("hemisphereLight",{color:8947967,groundColor:4473924,intensity:.6}),e&&(0,x.jsx)(i.x,{position:[0,-1,0],args:[20,20],cellSize:1,cellColor:4473924,sectionSize:5,sectionColor:2236962,fadeDistance:30}),(0,x.jsx)("group",{ref:y}),b.map(e=>(0,x.jsx)(p,{position:e.worldPosition,pressure:e.pressure,onRemove:()=>f(e.id)},e.id)),(0,x.jsx)(o.N,{ref:j,enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,dampingFactor:.08,minDistance:1,maxDistance:50,maxPolarAngle:Math.PI,zoomSpeed:1.2,rotateSpeed:.8,panSpeed:.8,screenSpacePanning:!1,mouseButtons:{LEFT:c.kBv.ROTATE,MIDDLE:c.kBv.DOLLY,RIGHT:c.kBv.PAN}})]})},f=(0,t.forwardRef)(({onStateUpdate:e,appState:s},a)=>{const[n,r]=(0,t.useState)(null),l=(0,t.useRef)(null),i=(0,t.useRef)(null),o=(0,t.useRef)(null),[c,d]=(0,t.useState)(null),[m,h]=(0,t.useState)(null),[u,p]=(0,t.useState)([]),f=s=>{[".stl",".obj",".glb",".gltf"].some(e=>s.name.toLowerCase().endsWith(e))?(e({status:`Loading ${s.name}...`}),r(s)):alert("Please upload STL, OBJ, GLB, or GLTF files only.")};return(0,t.useImperativeHandle)(a,()=>({loadFile:f,processMessage:a=>{a.file&&f(a.file),setTimeout(()=>{const t={type:"ai",content:`Processed: "${a.message}"`,time:(new Date).toLocaleTimeString()};e({chatMessages:[...s.chatMessages,t]})},1e3)},resetCamera:()=>{l.current&&(l.current.reset(),e({status:"Camera reset to initial view."}),setTimeout(()=>{e({status:n?`${n.name} loaded - Analysis ready`:"Ready for upload"})},1500))},toggleGrid:()=>{e({gridVisible:!s.gridVisible})},toggleAutoRotate:()=>{e({autoRotateEnabled:!s.autoRotateEnabled})},takeScreenshot:()=>{const e=document.querySelector("canvas");if(e){const s=document.createElement("a");s.download=`curfd_screenshot_${Date.now()}.png`,s.href=e.toDataURL(),s.click()}},isolatePart:e=>{i.current&&i.current(e)},clearIsolation:()=>{o.current&&o.current()}})),(0,x.jsxs)("div",{style:{position:"relative",width:"100%",height:"100%"},children:[(0,x.jsx)(g.Hl,{shadows:!0,camera:{position:[5,3,5],fov:50,near:.1,far:1e3},gl:{antialias:!0,alpha:!0},style:{background:"transparent",width:"100%",height:"100%"},onCreated:({gl:e})=>{e.setClearColor(988970)},children:(0,x.jsx)(b,{gridVisible:s.gridVisible,autoRotateEnabled:s.autoRotateEnabled,currentFile:n,onModelLoaded:s=>{s?.controlsRef&&(l.current=s.controlsRef.current),s?.isolatePart&&(i.current=s.isolatePart),s?.clearIsolation&&(o.current=s.clearIsolation),n&&e({status:`${n.name} loaded - Analysis ready`})},onPartHover:e=>d(e),onPartSelect:e=>h(e),onPressureClick:e=>{const s={id:`marker-${Date.now()}`,pressure:e.pressure,worldPosition:e.worldPosition};p(e=>[...e,s])},pressureMarkers:u,onRemoveMarker:e=>{p(s=>s.filter(s=>s.id!==e))}})}),m&&(0,x.jsx)("div",{style:{position:"absolute",right:12,bottom:12,zIndex:2e3},children:(0,x.jsxs)("div",{style:{background:"rgba(0,0,0,0.7)",color:"white",padding:"10px 12px",borderRadius:8,minWidth:200},children:[(0,x.jsx)("div",{style:{fontWeight:700},children:m.name}),(0,x.jsx)("div",{style:{fontSize:12,marginTop:6},children:Object.keys(m.metadata||{}).length?JSON.stringify(m.metadata):"No metadata"}),(0,x.jsx)("div",{style:{marginTop:8},children:(0,x.jsx)("button",{className:"btn btn-sm btn-light",onClick:()=>{o.current&&(o.current(),h(null))},children:"Clear Isolation"})})]})}),u.length>0&&(0,x.jsx)("div",{style:{position:"absolute",top:12,left:"50%",transform:"translateX(-50%)",zIndex:2e3},children:(0,x.jsxs)("button",{className:"btn btn-sm",onClick:()=>{p([])},style:{background:"rgba(239, 68, 68, 0.9)",color:"white",border:"1px solid rgba(255, 255, 255, 0.2)",fontWeight:600,fontSize:12,padding:"6px 12px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",borderRadius:"6px",whiteSpace:"nowrap"},children:["Clear All Markers (",u.length,")"]})})]})});f.displayName="ThreeJSCanvas";const j=f,y=({visible:e,onClose:s,placement:a})=>{if(!e)return null;const t={};return a?(void 0!==a.top&&(t.top=a.top),void 0!==a.right&&(t.right=a.right),void 0!==a.bottom&&(t.bottom=a.bottom),void 0!==a.left&&(t.left=a.left)):(t.left=16,t.bottom=96),(0,x.jsx)("div",{className:"position-fixed",style:{...t,zIndex:2e3},children:(0,x.jsxs)("div",{className:"chat-container shadow",style:{width:300,background:"rgba(0, 0, 0, 0.8)",border:"1px solid rgba(255, 255, 255, 0.15)",backdropFilter:"blur(12px)",borderRadius:12,color:"white",padding:"16px",marginLeft:"24px"},children:[(0,x.jsxs)("div",{className:"d-flex align-items-center mb-2",children:[(0,x.jsx)("div",{className:"me-3",style:{width:36,height:36,borderRadius:10,background:"linear-gradient(135deg, #3B82F6, #1D4ED8)",display:"grid",placeItems:"center",boxShadow:"0 4px 16px rgba(59, 130, 246, 0.3)",border:"1px solid rgba(59, 130, 246, 0.2)"},children:(0,x.jsx)("i",{className:"fas fa-mouse-pointer",style:{fontSize:"14px",color:"white"}})}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:700,fontSize:"16px",marginBottom:"2px"},children:"Navigation"}),(0,x.jsx)("div",{className:"text-white-50",style:{fontSize:"13px"},children:"Use your mouse to move around the model"})]})]}),(0,x.jsxs)("div",{className:"d-flex align-items-center gap-4 mt-3",children:[(0,x.jsxs)("div",{style:{position:"relative",width:70,height:100},children:[(0,x.jsx)("div",{style:{width:70,height:100,borderRadius:35,background:"linear-gradient(180deg, rgba(30,41,59,0.95), rgba(15,23,42,0.95))",border:"1px solid rgba(255,255,255,0.1)",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"}}),(0,x.jsx)("div",{style:{position:"absolute",top:8,left:8,right:35,height:32,borderRadius:8,background:"rgba(255,255,255,0.1)"}}),(0,x.jsx)("div",{style:{position:"absolute",top:8,left:35,right:8,height:32,borderRadius:8,background:"rgba(255,255,255,0.08)"}}),(0,x.jsx)("div",{style:{position:"absolute",top:14,left:"50%",transform:"translateX(-50%)",width:8,height:20,borderRadius:4,background:"rgba(34,211,238,0.9)"}})]}),(0,x.jsxs)("div",{className:"flex-grow-1",children:[(0,x.jsxs)("div",{className:"d-flex align-items-center gap-3 mb-2",children:[(0,x.jsx)("div",{style:{width:10,height:10,borderRadius:5,background:"#ffffff",flexShrink:0}}),(0,x.jsxs)("div",{style:{fontSize:"14px"},children:[(0,x.jsx)("strong",{children:"Left Click + Drag"})," — Rotate"]})]}),(0,x.jsxs)("div",{className:"d-flex align-items-center gap-3 mb-2",children:[(0,x.jsx)("div",{style:{width:10,height:10,borderRadius:5,background:"#A5B4FC",flexShrink:0}}),(0,x.jsxs)("div",{style:{fontSize:"14px"},children:[(0,x.jsx)("strong",{children:"Right Click + Drag"})," — Pan"]})]}),(0,x.jsxs)("div",{className:"d-flex align-items-center gap-3",children:[(0,x.jsx)("div",{style:{width:10,height:10,borderRadius:5,background:"#22D3EE",flexShrink:0}}),(0,x.jsxs)("div",{style:{fontSize:"14px"},children:[(0,x.jsx)("strong",{children:"Mouse Wheel"})," — Zoom"]})]})]})]}),(0,x.jsx)("div",{className:"text-white-50 mt-3 pt-2",style:{fontSize:"12px",borderTop:"1px solid rgba(255,255,255,0.1)"},children:"💡 Tip: Use Reset View at the bottom if you get lost."})]})})},v=(e=new Date)=>e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),N=({onSendMessage:e,selectedModel:s="gpt-4-turbo",onModelChange:a,onMinimize:n})=>{const[r,l]=(0,t.useState)([]),[i,o]=(0,t.useState)(""),[c,d]=(0,t.useState)(!1),m=(0,t.useRef)(null);(0,t.useEffect)(()=>{l([{type:"ai",content:"Hello — I can help with your simulation. Ask me anything!",time:v()}])},[]),(0,t.useEffect)(()=>{m.current?.scrollIntoView({behavior:"smooth"})},[r,c]);const h=s=>{const a=i.trim();if(!a&&!s)return;const t={type:"user",content:a||(s?`Uploaded ${s.name}`:""),time:v(),file:void 0};l(e=>[...e,t]),e&&e(a,s),o(""),d(!0),setTimeout(()=>{const e={type:"ai",content:s?`I've received ${s.name}. What would you like me to analyze?`:`Echo: ${a}`,time:v()};l(s=>[...s,e]),d(!1)},700+800*Math.random())};return(0,x.jsxs)("div",{className:"chat-container d-flex flex-column rounded-3 shadow-lg",style:{maxHeight:"calc(100vh - 92px)"},children:[(0,x.jsxs)("div",{className:"d-flex align-items-center justify-content-between p-3 border-bottom border-secondary",children:[(0,x.jsxs)("div",{className:"d-flex align-items-center gap-3",children:[(0,x.jsx)("img",{src:"/curfdlogo.png",alt:"CURFD",style:{height:"24px"}}),(0,x.jsx)("div",{children:(0,x.jsx)("strong",{className:"text-white",children:"CURFD AI"})})]}),n&&(0,x.jsx)("button",{onClick:n,className:"btn btn-sm",style:{background:"rgba(220, 53, 69, 0.8)",border:"2px solid rgba(220, 53, 69, 0.9)",color:"white",width:"32px",height:"32px",borderRadius:"50%",padding:"0",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 8px rgba(220, 53, 69, 0.3)",transition:"all 0.2s ease"},title:"Minimize AI Assistant",onMouseEnter:e=>{e.currentTarget.style.background="rgba(220, 53, 69, 1)",e.currentTarget.style.transform="scale(1.1)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(220, 53, 69, 0.8)",e.currentTarget.style.transform="scale(1)"},children:(0,x.jsx)("i",{className:"fas fa-times",style:{fontSize:"12px"}})})]}),(0,x.jsxs)("div",{className:"flex-grow-1 p-3",style:{overflowY:"auto",maxHeight:"60vh"},children:[r.map((e,s)=>(0,x.jsxs)("div",{className:"mb-4 "+("user"===e.type?"text-end":"text-start"),children:["ai"===e.type&&(0,x.jsxs)("div",{className:"d-flex align-items-center mb-2",children:[(0,x.jsx)("div",{className:"p-1 me-2",style:{background:"var(--brand-gradient)",borderRadius:"50%"},children:(0,x.jsx)("i",{className:"fas fa-robot text-white",style:{fontSize:12}})}),(0,x.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,x.jsx)("span",{className:"text-white fw-medium",children:"CURFD AI"}),(0,x.jsx)("span",{className:"text-white-50 small",children:e.time})]})]}),(0,x.jsx)("div",{className:"message-bubble "+("user"===e.type?"user":"ai"),children:e.content}),"user"===e.type&&(0,x.jsx)("div",{className:"text-white-50 small mt-1",children:e.time})]},s)),c&&(0,x.jsxs)("div",{className:"text-start mb-3",children:[(0,x.jsxs)("div",{className:"d-flex align-items-center mb-1",children:[(0,x.jsx)("div",{className:"bg-primary rounded-circle p-1 me-2",children:(0,x.jsx)("i",{className:"fas fa-robot text-white",style:{fontSize:12}})}),(0,x.jsx)("small",{className:"text-primary",children:"AI"})]}),(0,x.jsx)("div",{className:"bg-secondary bg-opacity-25 text-white p-3 rounded d-inline-block border border-secondary",children:(0,x.jsxs)("div",{className:"d-flex align-items-center gap-2 text-muted",children:[(0,x.jsx)("span",{children:"Typing"}),(0,x.jsxs)("div",{className:"d-flex gap-1",children:[(0,x.jsx)("div",{className:"bg-primary rounded-circle",style:{width:6,height:6}}),(0,x.jsx)("div",{className:"bg-primary rounded-circle",style:{width:6,height:6}}),(0,x.jsx)("div",{className:"bg-primary rounded-circle",style:{width:6,height:6}})]})]})})]}),(0,x.jsx)("div",{ref:m})]}),(0,x.jsxs)("div",{className:"p-3 mt-auto",children:[(0,x.jsx)("div",{className:"d-flex gap-2",children:(0,x.jsxs)("div",{className:"input-group",children:[(0,x.jsx)("input",{type:"text",className:"chat-input form-control rounded-start-pill px-3 py-2",placeholder:"Type your message...",value:i,onChange:e=>o(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),h())}}),(0,x.jsx)("button",{type:"button",className:"btn chat-input rounded-0 px-3",onClick:()=>document.getElementById("chat-file-input")?.click(),title:"Upload file",style:{borderLeft:"1px solid var(--chat-border)",borderRight:"1px solid var(--chat-border)"},children:(0,x.jsx)("i",{className:"fas fa-paperclip text-white-50"})}),(0,x.jsx)("button",{type:"button",className:"btn rounded-end-pill px-4 "+(i.trim()?"btn-brand":"chat-input"),onClick:()=>h(),disabled:c||!i.trim(),children:(0,x.jsx)("i",{className:"fas fa-paper-plane"})})]})}),(0,x.jsx)("input",{id:"chat-file-input",type:"file",className:"d-none",onChange:e=>{const s=e.target.files?.[0];s&&h(s),e.target&&(e.target.value="")},accept:".stl,.obj,.step,.stp,.iges,.glb"})]})]})};var w=a(4917);const S={apiUrl:"http://127.0.0.1:8000",googleOAuthUrl:"http://127.0.0.1:8000/auth/google"},k=S.apiUrl,A=w.A.create({baseURL:`${k}/api/v1`,headers:{"Content-Type":"application/json"}});A.interceptors.request.use(e=>{const s=localStorage.getItem("access_token");return s&&(e.headers.Authorization=`Bearer ${s}`),e}),A.interceptors.response.use(e=>e,e=>(401===e.response?.status&&localStorage.removeItem("access_token"),Promise.reject(e)));const C=async e=>(await A.post("/upload",e,{headers:{"Content-Type":"multipart/form-data"}})).data,P=async(e=100,s=0)=>(await A.get(`/models/?limit=${e}&offset=${s}`)).data,T={designs:{getAll:async(e,s=100,a=0)=>{const t=new URLSearchParams({limit:s.toString(),offset:a.toString(),...e&&{category:e}});return(await A.get(`/commerce/designs?${t}`)).data},sellDesign:async e=>(await A.post("/commerce/designs/sell",{designName:e.designName,description:e.description,price:e.price,category:e.category,fileOrigin:e.fileOrigin,licenseType:e.licenseType,originDeclaration:e.originDeclaration,qualityAssurance:e.qualityAssurance,technicalSpecs:e.technicalSpecs||"",tags:e.tags||"",instructions:e.instructions||""})).data,create:async e=>(await A.post("/commerce/designs",e)).data,get:async e=>(await A.get(`/commerce/designs/${e}`)).data,update:async(e,s)=>(await A.put(`/commerce/designs/${e}`,s)).data,like:async e=>(await A.post(`/commerce/designs/${e}/like`)).data},cart:{get:async()=>(await A.get("/commerce/cart")).data,add:async e=>(await A.post("/commerce/cart",{design_id:e.designId,name:e.name,price:e.price,original_price:e.originalPrice||null,size:e.size,color:e.color,icon:e.icon,quantity:e.quantity||1})).data,update:async(e,s)=>(await A.put(`/commerce/cart/${e}`,s)).data,remove:async e=>(await A.delete(`/commerce/cart/${e}`)).data,clear:async()=>(await A.delete("/commerce/cart")).data},sales:{checkout:async()=>(await A.post("/commerce/checkout")).data,getPurchases:async()=>(await A.get("/commerce/sales/purchases")).data,getSellerSales:async()=>(await A.get("/commerce/sales/seller")).data},payouts:{get:async()=>(await A.get("/commerce/payouts")).data,request:async e=>(await A.post("/commerce/payouts",{amount:e.amount,method:e.method,fees:e.fees||0,net_amount:e.netAmount,payout_account:e.payoutAccount||null})).data}},F=async(e,s)=>{console.log(e,s,"cartItems in createPaymentIntent");return(await A.post("/payments/create-payment-intent",{amount:s,currency:"usd",items:e.map(e=>({id:e.id,name:e.name,price:Number(e.price),amount:Number(e.price)*e.quantity,quantity:e.quantity,type:"3d_model"})),purchase_type:"one_time",metadata:{cart_items:e.map(e=>e.id.toString()).join(",")}})).data},R=async(e,s,a)=>(await A.post("/payments/confirm-payment",{payment_intent_id:e,payment_method_id:s,items:a})).data,D=async e=>(await A.post("/payments/create-payment-link",e)).data,I=A,E=async(e,s)=>{const a=new URLSearchParams;a.append("grant_type","password"),a.append("username",e),a.append("password",s),a.append("scope","");const t=await I.post("/login",a,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}),n=t.data;return localStorage.setItem("access_token",n.access_token),localStorage.setItem("token_type",n.token_type),I.defaults.headers.common.Authorization=`${n.token_type} ${n.access_token}`,t.data},z=async e=>(await I.post("/register",{username:e?.username,email:e?.email,password:e.password,full_name:e?.full_name,name:e?.full_name})).data,L=async()=>(await I.get("/user/me/")).data,U=async()=>(await I.post("/auth/logout")).data,$=(0,t.createContext)(void 0),M=({children:e})=>{const[s,a]=(0,t.useState)(null),[n,r]=(0,t.useState)(!0);(0,t.useEffect)(()=>{l()},[]);const l=async()=>{try{if(localStorage.getItem("authToken"))try{const e=await L();a(e),console.log("✅ Auth restored from localStorage:",e)}catch(e){console.warn("⚠️ Auth check failed, clearing invalid token:",e),localStorage.removeItem("authToken"),a(null)}else console.log("ℹ️ No auth token found in localStorage")}catch(e){console.error("❌ Error during auth check:",e)}finally{r(!1)}},i=async(e,s)=>{try{const t=await E(e,s);localStorage.setItem("authToken",t.access_token),console.log("✅ Login successful, token stored");const n=await L();a(n),console.log("✅ User profile loaded:",n)}catch(e){throw console.error("❌ Login failed:",e),localStorage.removeItem("authToken"),a(null),e}},o={user:s,login:i,register:async(e,s,a,t)=>{try{const n=await z({username:e,email:s,password:a,full_name:t});console.log("✅ Registration successful:",n),await i(e,a)}catch(e){throw console.error("❌ Registration failed:",e),e}},logout:()=>{try{localStorage.removeItem("authToken"),a(null),console.log("✅ Logout successful"),U().catch(console.error)}catch(e){console.error("❌ Logout error:",e)}},loading:n};return(0,x.jsx)($.Provider,{value:o,children:e})},B=()=>{const e=(0,t.useContext)($);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e};var _=a(563),O=a(8868),W=a(1163),q=a(1038),G=a(8007),H=a(4989);const Y=(0,G.c)("undefined"!=typeof window&&window.STRIPE_PUBLISHABLE_KEY?window.STRIPE_PUBLISHABLE_KEY:(console.warn("Using fallback Stripe test key. Please set REACT_APP_STRIPE_PUBLISHABLE_KEY in your environment."),"pk_test_51SOdbLCCJxhpzPUf4KupyJK5ZAj68mvOc8NHVUJXvobdwxBRqSv461w5VP2tzB1GLiQkY4U5Aqu1iVUUhhZzYLL100INISOdLc")),J=e=>{let s;return s=e.response?.data?.detail?Array.isArray(e.response.data.detail)?e.response.data.detail.map(e=>`${e.loc.length>1?e.loc.slice(1).join("."):"API"} - ${e.msg}`).join("; "):"object"==typeof e.response.data.detail?JSON.stringify(e.response.data.detail):e.response.data.detail:e.message||"Payment failed",s},V=({clientSecret:e,totalAmount:s,cartItems:a,onSuccess:n,onError:r,onProcessing:l,userData:i})=>{const o=(0,H.t2)(),c=(0,H.HH)(),[d,m]=(0,t.useState)(!1),[h,u]=(0,t.useState)(null),[g,p]=(0,t.useState)({name:i?.name||"",email:i?.email||""}),b=(e,s)=>{p(a=>({...a,[e]:s}))};return(0,x.jsxs)(O.A,{onSubmit:async s=>{if(s.preventDefault(),o&&c){m(!0),l(!0),u(null);try{const s=c.getElement(H.hA);if(!s)throw new Error("Card element not found");if(!g.name.trim()||!g.email.trim())throw new Error("Please fill in all billing details");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(g.email))throw new Error("Please enter a valid email address");const{error:t,paymentIntent:r}=await o.confirmCardPayment(e,{payment_method:{card:s,billing_details:{name:g.name,email:g.email}}});if(t)throw new Error(t.message||"Payment failed");if(!r||"succeeded"!==r.status)throw new Error(`Payment status: ${r?.status||"unknown"}. Please check your payment details.`);{console.log("PaymentIntent succeeded:",r);const e=await R(r.id,r.payment_method,a);n(e)}}catch(e){const s=J(e);u(s),r(s)}finally{m(!1),l(!1)}}else u("Payment system not ready. Please try again.")},children:[h&&(0,x.jsxs)(W.A,{variant:"danger",className:"mb-3",dismissible:!0,onClose:()=>u(null),children:[(0,x.jsx)("i",{className:"fas fa-exclamation-triangle me-2"}),h]}),(0,x.jsxs)("div",{className:"order-summary mb-4 p-3",style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"10px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[(0,x.jsxs)("h6",{className:"text-white mb-3",children:[(0,x.jsx)("i",{className:"fas fa-receipt me-2"}),"Order Summary"]}),a.map((e,s)=>(0,x.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[(0,x.jsxs)("div",{className:"text-white-50",style:{fontSize:"0.9rem"},children:[e.name,e.quantity>1&&(0,x.jsxs)("span",{className:"text-white-50 ms-1",children:["× ",e.quantity]})]}),(0,x.jsxs)("span",{className:"text-white",children:["$",(e.price*e.quantity).toFixed(2)]})]},s)),(0,x.jsx)("hr",{style:{borderColor:"rgba(255, 255, 255, 0.2)"}}),(0,x.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,x.jsx)("strong",{className:"text-white",children:"Total Amount"}),(0,x.jsxs)("strong",{className:"text-success",style:{fontSize:"1.2rem"},children:["$",s.toFixed(2)]})]})]}),(0,x.jsxs)("div",{className:"billing-info mb-4",children:[(0,x.jsxs)("h6",{className:"text-white mb-3",children:[(0,x.jsx)("i",{className:"fas fa-user me-2"}),"Billing Information"]}),(0,x.jsxs)("div",{className:"row g-3",children:[(0,x.jsx)("div",{className:"col-md-6",children:(0,x.jsxs)(O.A.Group,{children:[(0,x.jsx)(O.A.Label,{className:"text-white-50 small",children:"Full Name"}),(0,x.jsx)(O.A.Control,{type:"text",value:g.name,onChange:e=>b("name",e.target.value),placeholder:"Enter your full name",disabled:d,style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",color:"white",borderRadius:"8px"}})]})}),(0,x.jsx)("div",{className:"col-md-6",children:(0,x.jsxs)(O.A.Group,{children:[(0,x.jsx)(O.A.Label,{className:"text-white-50 small",children:"Email Address"}),(0,x.jsx)(O.A.Control,{type:"email",value:g.email,onChange:e=>b("email",e.target.value),placeholder:"Enter your email",disabled:d,style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",color:"white",borderRadius:"8px"}})]})})]})]}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsxs)("label",{className:"form-label text-white mb-3",children:[(0,x.jsx)("i",{className:"fas fa-credit-card me-2"}),"Card Details"]}),(0,x.jsx)("div",{style:{padding:"12px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"8px",border:"1px solid rgba(255, 255, 255, 0.2)"},children:(0,x.jsx)(H.hA,{options:{style:{base:{fontSize:"16px",color:"#ffffff","::placeholder":{color:"#aab7c4"},backgroundColor:"rgba(255, 255, 255, 0.1)",padding:"10px"}},hidePostalCode:!0}})})]}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsxs)("div",{className:"d-flex align-items-center text-white-50 mb-2",children:[(0,x.jsx)("i",{className:"fas fa-lock me-2 text-success"}),(0,x.jsx)("small",{children:"Your payment is secure and encrypted"})]}),(0,x.jsxs)("div",{className:"d-flex align-items-center text-white-50",children:[(0,x.jsx)("i",{className:"fas fa-shield-alt me-2 text-warning"}),(0,x.jsx)("small",{children:"Protected by Stripe - PCI DSS compliant"})]})]}),(0,x.jsx)("button",{type:"submit",disabled:!o||d||!g.name||!g.email,className:"w-100 py-3",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"50px",fontSize:"1.1rem",fontWeight:"bold",color:"white",cursor:o&&!d&&g.name&&g.email?"pointer":"not-allowed",opacity:o&&!d&&g.name&&g.email?1:.6,transition:"all 0.3s ease",position:"relative",overflow:"hidden"},onMouseEnter:e=>{o&&!d&&g.name&&g.email&&(e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(102, 126, 234, 0.4)")},onMouseLeave:e=>{o&&!d&&g.name&&g.email&&(e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none")},children:d?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(q.A,{animation:"border",size:"sm",className:"me-2"}),"Processing Payment..."]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("i",{className:"fas fa-lock me-2"}),"Pay $",s.toFixed(2)]})})]})},K=({show:e,onClose:s,onSuccess:a,cartItems:n=[],totalAmount:r,isQuickPurchase:l=!1,assetData:i,userData:o})=>{const[c,d]=(0,t.useState)(null),[m,h]=(0,t.useState)(!1),[u,g]=(0,t.useState)(null),[p,b]=(0,t.useState)(!1),f=(0,t.useCallback)(async()=>{if(h(!0),g(null),r<=0)return g("Invalid payment amount. Please ensure your cart total is greater than $0.00."),void h(!1);try{let e;l&&i?e=await D(i):(console.log("cartItems being sent to createPaymentIntent:",n),e=await F(n,r)),d(e.client_secret)}catch(e){const s=J(e);g(s),console.error("Payment initialization error:",e)}finally{h(!1)}},[e,l,i,n,r]);(0,t.useEffect)(()=>{e?f():(d(null),g(null),h(!1),b(!1))},[e,f]);return(0,x.jsxs)(_.A,{show:e,onHide:p?void 0:s,size:"lg",centered:!0,backdrop:!p||"static",keyboard:!p,className:"payment-modal",children:[(0,x.jsx)(_.A.Header,{closeButton:!p,style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderBottom:"2px solid rgba(255, 255, 255, 0.1)",color:"white"},children:(0,x.jsxs)(_.A.Title,{className:"d-flex align-items-center",children:[(0,x.jsx)("i",{className:"fas fa-credit-card me-3",style:{color:"#FFD700"}}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontSize:"1.3rem",fontWeight:"bold"},children:"Secure Payment"}),(0,x.jsx)("small",{style:{opacity:.9},children:l?"Quick Purchase":"Complete Your Purchase"})]})]})}),(0,x.jsxs)(_.A.Body,{style:{background:"linear-gradient(to bottom, #1a1a2e 0%, #16213e 100%)",padding:"2rem"},children:[m?(0,x.jsxs)("div",{className:"text-center py-5",children:[(0,x.jsx)(q.A,{animation:"border",variant:"primary",style:{width:"3rem",height:"3rem"}}),(0,x.jsx)("div",{className:"mt-3 text-white",children:"Initializing secure payment..."}),(0,x.jsx)("small",{className:"text-white-50 mt-2",children:"This may take a few seconds"})]}):u?(0,x.jsxs)("div",{className:"text-center py-4",children:[(0,x.jsx)("i",{className:"fas fa-exclamation-circle text-danger",style:{fontSize:"3rem"}}),(0,x.jsx)("h5",{className:"text-white mt-3",children:"Payment Error"}),(0,x.jsx)("p",{className:"text-white-50",children:u}),(0,x.jsxs)("div",{className:"d-flex gap-2 justify-content-center mt-3",children:[(0,x.jsxs)("button",{onClick:()=>{g(null),f()},className:"btn btn-primary",style:{borderRadius:"50px",padding:"0.5rem 1.5rem"},children:[(0,x.jsx)("i",{className:"fas fa-redo me-2"}),"Try Again"]}),(0,x.jsxs)("button",{onClick:s,className:"btn btn-outline-light",style:{borderRadius:"50px",padding:"0.5rem 1.5rem"},children:[(0,x.jsx)("i",{className:"fas fa-times me-2"}),"Cancel"]})]})]}):c?(0,x.jsx)(H.S8,{stripe:Y,options:{clientSecret:c},children:(0,x.jsx)(V,{clientSecret:c,totalAmount:r,cartItems:n,onSuccess:e=>{a(e),s()},onError:e=>{g(e)},onProcessing:e=>{b(e)},userData:o})}):null,!m&&!u&&(0,x.jsxs)("div",{className:"text-center mt-4 pt-3",style:{borderTop:"1px solid rgba(255, 255, 255, 0.1)"},children:[(0,x.jsx)("small",{className:"text-white-50 mb-2 d-block",children:"We Accept"}),(0,x.jsxs)("div",{className:"d-flex justify-content-center gap-3 flex-wrap",children:[(0,x.jsx)("i",{className:"fab fa-cc-visa text-white",style:{fontSize:"2rem"},title:"Visa"}),(0,x.jsx)("i",{className:"fab fa-cc-mastercard text-white",style:{fontSize:"2rem"},title:"Mastercard"}),(0,x.jsx)("i",{className:"fab fa-cc-amex text-white",style:{fontSize:"2rem"},title:"American Express"}),(0,x.jsx)("i",{className:"fab fa-cc-discover text-white",style:{fontSize:"2rem"},title:"Discover"}),(0,x.jsx)("i",{className:"fab fa-cc-stripe text-white",style:{fontSize:"2rem"},title:"Stripe"})]})]})]}),(0,x.jsx)(_.A.Footer,{style:{background:"rgba(0, 0, 0, 0.3)",borderTop:"1px solid rgba(255, 255, 255, 0.1)"},children:(0,x.jsx)("div",{className:"w-100 text-center",children:(0,x.jsxs)("small",{className:"text-white-50",children:[(0,x.jsx)("i",{className:"fas fa-lock me-1"}),"All transactions are secured with 256-bit SSL encryption"]})})})]})},Q=({show:e,onClose:s,cartItems:a,onUpdateQuantity:n,onRemoveItem:r,onCheckout:l})=>{const[i,o]=(0,t.useState)(!1),c=a.reduce((e,s)=>e+s.price*s.quantity,0),d=.08*c,m=c+d;console.log("CartModal: calculated total =",m);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(_.A,{show:e,onHide:s,size:"lg",centered:!0,className:"cart-modal",children:[(0,x.jsx)(_.A.Header,{closeButton:!0,style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderBottom:"2px solid rgba(255, 255, 255, 0.1)",color:"white"},children:(0,x.jsxs)(_.A.Title,{className:"d-flex align-items-center",children:[(0,x.jsx)("i",{className:"fas fa-shopping-cart me-3",style:{color:"#FFD700",fontSize:"1.5rem"}}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontSize:"1.3rem",fontWeight:"bold"},children:"Shopping Cart"}),(0,x.jsxs)("small",{style:{opacity:.9,fontSize:"0.85rem"},children:[a.length," ",1===a.length?"item":"items"," in your cart"]})]})]})}),(0,x.jsx)(_.A.Body,{style:{background:"linear-gradient(to bottom, #1a1a2e 0%, #16213e 100%)",padding:"2rem",maxHeight:"60vh",overflowY:"auto"},children:0===a.length?(0,x.jsxs)("div",{className:"text-center py-5",children:[(0,x.jsx)("i",{className:"fas fa-shopping-cart text-white-50",style:{fontSize:"4rem",marginBottom:"1rem"}}),(0,x.jsx)("h4",{className:"text-white-50 mb-3",children:"Your cart is empty"}),(0,x.jsx)("p",{className:"text-white-50",children:"Browse our store to add items to your cart"}),(0,x.jsx)("button",{className:"btn btn-outline-light mt-3",onClick:s,style:{borderRadius:"50px",padding:"0.75rem 2rem"},children:"Continue Shopping"})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"cart-items mb-4",children:a.map(e=>(0,x.jsx)("div",{className:"cart-item mb-3 p-3",style:{background:"rgba(255, 255, 255, 0.08)",borderRadius:"15px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:(0,x.jsxs)("div",{className:"row align-items-center",children:[(0,x.jsx)("div",{className:"col-md-6",children:(0,x.jsxs)("div",{className:"d-flex align-items-center",children:[(0,x.jsx)("div",{className:"rounded-circle p-2 me-3",style:{background:`linear-gradient(135deg, ${e.color}20, ${e.color}40)`,border:`2px solid ${e.color}30`,minWidth:"50px",height:"50px",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,x.jsx)("i",{className:e.icon,style:{color:e.color,fontSize:"20px"}})}),(0,x.jsxs)("div",{children:[(0,x.jsx)("h6",{className:"text-white mb-1",style:{fontSize:"0.9rem",fontWeight:"600"},children:e.name}),(0,x.jsx)("small",{className:"text-white-50",children:e.size})]})]})}),(0,x.jsx)("div",{className:"col-md-2",children:(0,x.jsxs)("div",{className:"d-flex align-items-center",children:[(0,x.jsx)("button",{className:"btn btn-sm",onClick:()=>n(e.id,Math.max(1,e.quantity-1)),style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",color:"white",width:"30px",height:"30px",padding:0,borderRadius:"50%"},children:(0,x.jsx)("i",{className:"fas fa-minus",style:{fontSize:"0.7rem"}})}),(0,x.jsx)("span",{className:"text-white mx-3",style:{minWidth:"20px",textAlign:"center"},children:e.quantity}),(0,x.jsx)("button",{className:"btn btn-sm",onClick:()=>n(e.id,e.quantity+1),style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",color:"white",width:"30px",height:"30px",padding:0,borderRadius:"50%"},children:(0,x.jsx)("i",{className:"fas fa-plus",style:{fontSize:"0.7rem"}})})]})}),(0,x.jsx)("div",{className:"col-md-2",children:(0,x.jsxs)("div",{className:"text-center",children:[(0,x.jsxs)("div",{className:"text-success fw-bold",style:{fontSize:"1.1rem"},children:["$",(e.price*e.quantity).toFixed(2)]}),e.originalPrice&&(0,x.jsxs)("small",{className:"text-white-50 text-decoration-line-through",children:["$",(e.originalPrice*e.quantity).toFixed(2)]})]})}),(0,x.jsx)("div",{className:"col-md-2",children:(0,x.jsx)("button",{className:"btn btn-sm",onClick:()=>r(e.id),style:{background:"rgba(220, 53, 69, 0.1)",border:"1px solid rgba(220, 53, 69, 0.3)",color:"#dc3545",borderRadius:"50%",width:"35px",height:"35px",padding:0},children:(0,x.jsx)("i",{className:"fas fa-trash",style:{fontSize:"0.8rem"}})})})]})},e.id))}),(0,x.jsxs)("div",{className:"order-summary p-4",style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"15px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[(0,x.jsx)("h5",{className:"text-white mb-3",children:"Order Summary"}),(0,x.jsxs)("div",{className:"d-flex justify-content-between mb-2",children:[(0,x.jsxs)("span",{className:"text-white-50",children:["Subtotal (",a.length," items)"]}),(0,x.jsxs)("span",{className:"text-white",children:["$",c.toFixed(2)]})]}),(0,x.jsxs)("div",{className:"d-flex justify-content-between mb-2",children:[(0,x.jsx)("span",{className:"text-white-50",children:"Tax (8%)"}),(0,x.jsxs)("span",{className:"text-white",children:["$",d.toFixed(2)]})]}),(0,x.jsxs)("div",{className:"d-flex justify-content-between mb-3",children:[(0,x.jsx)("span",{className:"text-white-50",children:"Shipping"}),(0,x.jsx)("span",{className:"text-success",children:"FREE"})]}),(0,x.jsx)("hr",{style:{borderColor:"rgba(255, 255, 255, 0.2)"}}),(0,x.jsxs)("div",{className:"d-flex justify-content-between mb-4",children:[(0,x.jsx)("span",{className:"text-white fw-bold",style:{fontSize:"1.2rem"},children:"Total"}),(0,x.jsxs)("span",{className:"text-success fw-bold",style:{fontSize:"1.3rem"},children:["$",m.toFixed(2)]})]}),(0,x.jsxs)("div",{className:"d-flex gap-3",children:[(0,x.jsx)("button",{className:"btn btn-outline-light flex-fill",onClick:s,style:{borderRadius:"50px",padding:"0.75rem",fontWeight:"500",background:"transparent",border:"1px solid rgba(255, 255, 255, 0.5)",color:"white",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.1)",e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.8)"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.5)"},children:"Continue Shopping"}),(0,x.jsxs)("button",{className:"btn flex-fill",onClick:()=>{if(m<=0)alert("Cannot proceed to checkout with a total amount of $0.00.");else{console.log("CartModal: checkout clicked, opening payment modal"),o(!0);try{l&&l()}catch(e){console.error("CartModal: onCheckout threw:",e)}}},disabled:m<=0,style:{background:"linear-gradient(135deg, #28a745, #20c997)",border:"none",color:"white",borderRadius:"50px",padding:"0.75rem",fontWeight:"bold",boxShadow:"0 4px 15px rgba(40, 167, 69, 0.3)",transition:"all 0.3s ease",opacity:m<=0?.6:1},onMouseEnter:e=>{m>0&&(e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(40, 167, 69, 0.4)")},onMouseLeave:e=>{m>0&&(e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 15px rgba(40, 167, 69, 0.3)")},children:[(0,x.jsx)("i",{className:"fas fa-credit-card me-2"}),"Proceed to Checkout"]})]})]})]})})]}),(0,x.jsx)(K,{show:i,onClose:()=>o(!1),onSuccess:e=>{console.log("Payment successful:",e),s(),alert("Payment successful! Your items are now available in your purchases.")},cartItems:a,totalAmount:m})]})},Z=({onBack:e,cartItems:s,onAddToCart:a,onShowCart:n,onViewItem:r})=>{const{user:l}=B(),[i,o]=(0,t.useState)([]),[c,d]=(0,t.useState)(!0);if((0,t.useEffect)(()=>{(async()=>{d(!0);try{const e=await T.designs.getAll();console.log("📦 Fetched designs from commerce API:",e);const s=e.map(e=>({id:e.id||e._id,name:e.name||e.title||"Untitled Design",color:e.color||"#4CAF50",icon:e.icon||"fas fa-cube",size:e.size||"2.5 MB",price:e.price||19.99,originalPrice:e.originalPrice||e.price||29.99,description:e.description||"A premium 3D design model",category:e.category||"3D Models",seller:e.seller||e.sellerName||"Unknown Seller",sellerId:e.sellerId||e.seller_id||e.userId,rating:e.rating||4.5,downloads:e.downloads||e.downloadCount||100,preview:e.preview||e.image||e.thumbnail})),a=s.filter(e=>e.sellerId!==l?.id&&e.sellerId!==String(l?.id));console.log(`🔍 Filtered ${s.length} items to ${a.length} (excluding user's own listings)`),o(a)}catch(e){console.log("⚠️ Commerce API failed, trying models API. Error:",e);try{const e=await P();console.log("📦 Fetched models from models API:",e);const s=e.map(e=>({id:e.id||e._id,name:e.name||e.title||"Untitled Model",color:e.color||"#2196F3",icon:e.icon||"fas fa-cube",size:e.size||"3.1 MB",price:e.price||24.99,originalPrice:e.originalPrice||e.price||34.99,description:e.description||"A detailed 3D model",category:e.category||"3D Models",seller:e.seller||e.creator||"Unknown Creator",sellerId:e.sellerId||e.creatorId||e.userId,rating:e.rating||4.7,downloads:e.downloads||e.downloadCount||150,preview:e.preview||e.image||e.thumbnail})),a=s.filter(e=>e.sellerId!==l?.id&&e.sellerId!==String(l?.id));console.log(`🔍 Filtered ${s.length} models to ${a.length} (excluding user's own listings)`),o(a)}catch(e){console.log("❌ Both APIs failed, using empty store. Error:",e),o([])}}finally{d(!1)}})()},[l]),c)return(0,x.jsx)("div",{className:"store-page position-fixed inset-0 d-flex justify-content-center align-items-center",style:{zIndex:1030,paddingTop:"60px",background:"var(--curfd-dark, #0A0F29)"},children:(0,x.jsxs)("div",{className:"text-center",children:[(0,x.jsx)("div",{className:"spinner-border text-primary mb-3",role:"status",children:(0,x.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,x.jsx)("h5",{className:"text-white",children:"Loading Store..."})]})});return(0,x.jsxs)("div",{className:"store-page position-fixed inset-0",style:{zIndex:1030,paddingTop:"60px",paddingBottom:"80px",background:"var(--curfd-dark, #0A0F29)",overflow:"hidden"},children:[(0,x.jsx)("div",{className:"position-absolute bottom-0 start-0 end-0",style:{height:"120px",background:"linear-gradient(to top, rgba(10, 15, 41, 0.95) 0%, rgba(10, 15, 41, 0.8) 40%, transparent 100%)",pointerEvents:"none",zIndex:1}}),(0,x.jsx)("div",{className:"container-fluid h-100",style:{paddingTop:"20px",paddingLeft:"24px",paddingRight:"24px",overflowY:"auto",height:"100%"},children:(0,x.jsx)("div",{className:"row",children:(0,x.jsx)("div",{className:"col-12 py-4",children:0===i.length?(0,x.jsxs)("div",{className:"text-center py-5",children:[(0,x.jsx)("i",{className:"fas fa-store fa-4x text-muted mb-3"}),(0,x.jsx)("h4",{className:"text-white mb-3",children:"No items available"}),(0,x.jsx)("p",{className:"text-white-50 mb-4",children:l?"There are no other sellers' items in the store right now. Check back later for new listings!":"The store is empty right now. Check back later for new listings!"})]}):(0,x.jsx)("div",{className:"row g-4",children:i.map((e,s)=>(0,x.jsx)("div",{className:"col-xl-3 col-lg-4 col-md-6 col-sm-12",children:(0,x.jsx)("div",{className:"card h-100 shadow-lg border-0",style:{background:"rgba(255, 255, 255, 0.08)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.15)",borderRadius:"20px",overflow:"hidden",transition:"all 0.3s ease",boxShadow:"0 10px 30px rgba(0, 0, 0, 0.3)",minHeight:"280px"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-8px)",e.currentTarget.style.boxShadow="0 20px 40px rgba(0, 0, 0, 0.4)",e.currentTarget.style.background="rgba(255, 255, 255, 0.12)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0px)",e.currentTarget.style.boxShadow="0 10px 30px rgba(0, 0, 0, 0.3)",e.currentTarget.style.background="rgba(255, 255, 255, 0.08)"},children:(0,x.jsxs)("div",{className:"card-body d-flex flex-column",style:{padding:"1.5rem 1.5rem 1.5rem 1.5rem"},children:[(0,x.jsxs)("div",{className:"d-flex align-items-center mb-3",children:[(0,x.jsx)("div",{className:"rounded-circle p-3 me-3",style:{background:`linear-gradient(135deg, ${e.color}20, ${e.color}40)`,border:`2px solid ${e.color}30`},children:(0,x.jsx)("i",{className:e.icon,style:{color:e.color,fontSize:"24px"}})}),(0,x.jsxs)("div",{className:"flex-grow-1",children:[(0,x.jsx)("h5",{className:"card-title mb-1 fw-bold text-white",style:{fontSize:"1rem",lineHeight:"1.3"},children:e.name}),(0,x.jsxs)("small",{className:"text-white-50 d-block mb-1",children:["by ",e.seller]}),(0,x.jsxs)("div",{className:"d-flex align-items-center",children:[(0,x.jsx)("span",{className:"badge bg-light text-dark me-2",style:{fontSize:"0.7rem"},children:e.size}),(0,x.jsx)("span",{className:"badge me-2",style:{background:`${e.color}20`,color:e.color,fontSize:"0.7rem"},children:e.category})]})]})]}),(0,x.jsx)("p",{className:"text-white-50 mb-2",style:{fontSize:"0.85rem",lineHeight:"1.4"},children:e.description}),(0,x.jsxs)("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[(0,x.jsxs)("div",{className:"d-flex align-items-center",children:[(0,x.jsxs)("div",{className:"d-flex align-items-center me-3",children:[[...Array(5)].map((s,a)=>(0,x.jsx)("i",{className:"fas fa-star "+(a<Math.floor(e.rating||0)?"text-warning":"text-white-50"),style:{fontSize:"0.7rem"}},a)),(0,x.jsx)("span",{className:"text-white-50 ms-1",style:{fontSize:"0.8rem"},children:e.rating})]}),(0,x.jsxs)("small",{className:"text-white-50",children:[(0,x.jsx)("i",{className:"fas fa-download me-1"}),e.downloads," downloads"]})]}),(0,x.jsxs)("small",{className:"text-success fw-semibold",children:[(0,x.jsx)("i",{className:"fas fa-check-circle me-1"}),"Verified Design"]})]}),(0,x.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,x.jsxs)("div",{className:"price-section",children:[(0,x.jsxs)("div",{className:"d-flex align-items-baseline",children:[(0,x.jsxs)("span",{className:"fw-bold text-success me-2",style:{fontSize:"1.8rem"},children:["$",e.price]}),e.originalPrice&&e.originalPrice>e.price&&(0,x.jsxs)("small",{className:"text-white-50 text-decoration-line-through",children:["$",e.originalPrice]})]}),e.originalPrice&&e.originalPrice>e.price&&(0,x.jsxs)("small",{className:"text-success fw-semibold",children:[Math.round(100*(1-e.price/e.originalPrice)),"% OFF Limited Time!"]})]}),(0,x.jsxs)("div",{className:"d-flex gap-1 flex-wrap justify-content-center",children:[r&&(0,x.jsxs)("button",{className:"btn px-2 fw-bold",onClick:()=>r(e),style:{background:"linear-gradient(135deg, #667eea, #764ba2)",border:"none",color:"white",borderRadius:"20px",fontSize:"0.7rem",transition:"all 0.2s ease",minWidth:"65px",height:"32px",boxShadow:"0 3px 10px rgba(102, 126, 234, 0.3)"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 5px 15px rgba(102, 126, 234, 0.4)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0px)",e.currentTarget.style.boxShadow="0 3px 10px rgba(102, 126, 234, 0.3)"},children:[(0,x.jsx)("i",{className:"fas fa-eye me-1"}),"View"]}),(0,x.jsx)("button",{className:"btn px-2 fw-bold",onClick:()=>a(e),style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.3)",color:"white",borderRadius:"20px",fontSize:"0.7rem",transition:"all 0.2s ease",minWidth:"35px",height:"32px"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.background="rgba(255, 255, 255, 0.2)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0px)",e.currentTarget.style.background="rgba(255, 255, 255, 0.1)"},title:"Add to Cart",children:(0,x.jsx)("i",{className:"fas fa-cart-plus"})}),(0,x.jsxs)("button",{className:"btn px-3 fw-bold flex-grow-1",onClick:()=>(e=>{a(e),setTimeout(()=>{n()},100)})(e),style:{background:"linear-gradient(135deg, #28a745, #20c997)",border:"none",color:"white",borderRadius:"25px",fontSize:"0.85rem",boxShadow:"0 4px 15px rgba(40, 167, 69, 0.3)",transition:"all 0.2s ease",minWidth:"100px",height:"36px"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(40, 167, 69, 0.4)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0px)",e.currentTarget.style.boxShadow="0 4px 15px rgba(40, 167, 69, 0.3)"},children:[(0,x.jsx)("i",{className:"fas fa-shopping-cart me-2"}),"Buy Now"]})]})]})]})})},e.id||s))})})})})]})},X=({show:e,onClose:s,onSubmit:a,uploadedFile:n})=>{const[r,l]=(0,t.useState)({designName:"",description:"",price:"",category:"",fileOrigin:"",licenseType:"commercial",originDeclaration:!1,qualityAssurance:!1,technicalSpecs:"",tags:"",instructions:""});(0,t.useEffect)(()=>{if(n&&n.name){const e=n.name.replace(/\.[^/.]+$/,"").replace(/[_-]/g," ").replace(/\b\w/g,e=>e.toUpperCase());l(s=>({...s,designName:e}))}},[n]);const i={background:"rgba(255, 255, 255, 0.08)",border:"1px solid rgba(255, 255, 255, 0.2)",color:"white",padding:"0.75rem",borderRadius:"8px"},o={background:"rgba(255, 255, 255, 0.08)",border:"1px solid rgba(255, 255, 255, 0.2)",color:"white",padding:"0.75rem",borderRadius:"8px"},c=e=>{const{name:s,value:a,type:t}=e.target;if("checkbox"===t){const a=e.target.checked;l(e=>({...e,[s]:a}))}else l(e=>({...e,[s]:a}))};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("style",{children:"\n          .sell-design-modal input::placeholder,\n          .sell-design-modal textarea::placeholder {\n            color: rgba(255, 255, 255, 0.5) !important;\n            opacity: 1;\n          }\n          .sell-design-modal select option {\n            background-color: #1a1a2e !important;\n            color: white !important;\n          }\n          .sell-design-modal select {\n            color: white !important;\n          }\n        "}),(0,x.jsxs)(_.A,{show:e,onHide:s,size:"lg",centered:!0,backdrop:"static",className:"sell-design-modal",children:[(0,x.jsx)(_.A.Header,{closeButton:!0,style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderBottom:"2px solid rgba(255, 255, 255, 0.1)",color:"white"},children:(0,x.jsxs)(_.A.Title,{className:"d-flex align-items-center w-100",children:[(0,x.jsx)("img",{src:"/curfdlogo.png",alt:"CURFD",style:{height:"40px",marginRight:"1rem",filter:"brightness(1.2) contrast(1.1)"}}),(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{style:{fontSize:"1.3rem",fontWeight:"bold"},children:[(0,x.jsx)("i",{className:"fas fa-dollar-sign",style:{color:"#FFD700",marginRight:"0.5rem"}}),"Sell Your Design"]}),(0,x.jsx)("small",{style:{opacity:.9,fontSize:"0.85rem"},children:"Join our marketplace and earn from your creativity"})]})]})}),(0,x.jsx)(_.A.Body,{style:{background:"linear-gradient(to bottom, #1a1a2e 0%, #16213e 100%)",maxHeight:"70vh",overflowY:"auto",padding:"2rem"},children:(0,x.jsxs)(O.A,{onSubmit:e=>{e.preventDefault(),a(r),s(),l({designName:"",description:"",price:"",category:"",fileOrigin:"",licenseType:"commercial",originDeclaration:!1,qualityAssurance:!1,technicalSpecs:"",tags:"",instructions:""})},children:[(0,x.jsxs)("div",{className:"alert mb-4",style:{background:"rgba(102, 126, 234, 0.1)",border:"1px solid rgba(102, 126, 234, 0.3)",borderRadius:"8px",color:"#a8b3ff"},children:[(0,x.jsx)("i",{className:"fas fa-info-circle me-2"}),"Fill out the details below to list your design on our marketplace. All fields marked with * are required."]}),n&&(0,x.jsx)("div",{className:"mb-4 p-3",style:{background:"rgba(16, 185, 129, 0.1)",border:"1px solid rgba(16, 185, 129, 0.3)",borderRadius:"12px",color:"white"},children:(0,x.jsxs)("div",{className:"d-flex align-items-center",children:[(0,x.jsx)("div",{className:"me-3",style:{width:"50px",height:"50px",background:"linear-gradient(135deg, #10B981, #059669)",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,x.jsx)("i",{className:"fas fa-cube",style:{fontSize:"1.5rem",color:"white"}})}),(0,x.jsxs)("div",{className:"flex-grow-1",children:[(0,x.jsxs)("h6",{style:{margin:0,color:"#10B981",fontWeight:"bold"},children:[(0,x.jsx)("i",{className:"fas fa-check-circle me-2"}),"Design File Ready"]}),(0,x.jsx)("div",{style:{fontSize:"1rem",fontWeight:"600",color:"white",marginTop:"0.25rem"},children:n.name}),n.size&&(0,x.jsxs)("small",{style:{color:"#9CA3AF"},children:["File size: ",n.size]})]}),(0,x.jsx)("div",{className:"text-end",children:(0,x.jsx)("span",{className:"badge",style:{background:"#10B981",color:"white",padding:"0.5rem 1rem",borderRadius:"8px",fontSize:"0.75rem"},children:"Uploaded & Analyzed"})})]})}),(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsxs)(O.A.Label,{style:{color:"#e0e0e0",fontWeight:"500"},children:["Design Name ",(0,x.jsx)("span",{style:{color:"#ff6b6b"},children:"*"})]}),(0,x.jsx)(O.A.Control,{type:"text",name:"designName",value:r.designName,onChange:c,required:!0,placeholder:"e.g., Premium Aerodynamic Wing Design",style:i,className:"form-control-lg"})]}),(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsxs)(O.A.Label,{style:{color:"#e0e0e0",fontWeight:"500"},children:["Description ",(0,x.jsx)("span",{style:{color:"#ff6b6b"},children:"*"})]}),(0,x.jsx)(O.A.Control,{as:"textarea",rows:4,name:"description",value:r.description,onChange:c,required:!0,placeholder:"Describe your design in detail. What makes it unique? What problems does it solve?",style:i})]}),(0,x.jsxs)(O.A.Group,{className:"mb-4",children:[(0,x.jsxs)(O.A.Label,{style:{color:"#e0e0e0",fontWeight:"500"},children:["Price (USD) ",(0,x.jsx)("span",{style:{color:"#ff6b6b"},children:"*"})]}),(0,x.jsxs)("div",{className:"input-group",children:[(0,x.jsx)("span",{className:"input-group-text",style:{background:"rgba(102, 126, 234, 0.2)",border:"1px solid rgba(102, 126, 234, 0.3)",color:"#667eea",fontWeight:"bold"},children:(0,x.jsx)("i",{className:"fas fa-dollar-sign"})}),(0,x.jsx)(O.A.Control,{type:"number",name:"price",value:r.price,onChange:c,required:!0,min:"0",step:"0.01",placeholder:"29.99",style:i,className:"form-control-lg"})]}),(0,x.jsx)("small",{style:{color:"#888",marginTop:"0.25rem",display:"block"},children:"Suggested price range: $19.99 - $199.99"})]}),(0,x.jsxs)("div",{className:"row",children:[(0,x.jsx)("div",{className:"col-md-6",children:(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsxs)(O.A.Label,{style:{color:"#e0e0e0",fontWeight:"500"},children:["Category ",(0,x.jsx)("span",{style:{color:"#ff6b6b"},children:"*"})]}),(0,x.jsxs)(O.A.Select,{name:"category",value:r.category,onChange:c,required:!0,style:o,children:[(0,x.jsx)("option",{value:"",style:{color:"rgba(255,255,255,0.5)"},children:"Select a category"}),(0,x.jsx)("option",{value:"aerospace",children:"Aerospace"}),(0,x.jsx)("option",{value:"automotive",children:"Automotive"}),(0,x.jsx)("option",{value:"mechanical",children:"Mechanical"}),(0,x.jsx)("option",{value:"architecture",children:"Architecture"}),(0,x.jsx)("option",{value:"industrial",children:"Industrial"}),(0,x.jsx)("option",{value:"other",children:"Other"})]})]})}),(0,x.jsx)("div",{className:"col-md-6",children:(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsxs)(O.A.Label,{style:{color:"#e0e0e0",fontWeight:"500"},children:["License Type ",(0,x.jsx)("span",{style:{color:"#ff6b6b"},children:"*"})]}),(0,x.jsxs)(O.A.Select,{name:"licenseType",value:r.licenseType,onChange:c,required:!0,style:o,children:[(0,x.jsx)("option",{value:"commercial",children:"Commercial - Full Rights"}),(0,x.jsx)("option",{value:"personal",children:"Personal Use Only"}),(0,x.jsx)("option",{value:"attribution",children:"Attribution Required"}),(0,x.jsx)("option",{value:"non-commercial",children:"Non-Commercial"})]})]})})]}),(0,x.jsxs)(O.A.Group,{className:"mb-4",children:[(0,x.jsxs)(O.A.Label,{style:{color:"#e0e0e0",fontWeight:"500"},children:["File Origin ",(0,x.jsx)("span",{style:{color:"#ff6b6b"},children:"*"})]}),(0,x.jsxs)(O.A.Select,{name:"fileOrigin",value:r.fileOrigin,onChange:c,required:!0,style:o,children:[(0,x.jsx)("option",{value:"",style:{color:"rgba(255,255,255,0.5)"},children:"Select file origin"}),(0,x.jsx)("option",{value:"original",children:"Original Work - Created by Me"}),(0,x.jsx)("option",{value:"modified",children:"Modified from Open Source"}),(0,x.jsx)("option",{value:"commissioned",children:"Commissioned Work (I own rights)"})]})]}),(0,x.jsxs)("div",{style:{border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",padding:"1rem",background:"rgba(0, 0, 0, 0.2)",marginBottom:"1.5rem"},children:[(0,x.jsxs)("h6",{style:{color:"#a8b3ff",marginBottom:"1rem"},children:[(0,x.jsx)("i",{className:"fas fa-cog me-2"}),"Additional Details (Optional)"]}),(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{style:{color:"#e0e0e0",fontWeight:"400",fontSize:"0.9rem"},children:"Technical Specifications"}),(0,x.jsx)(O.A.Control,{as:"textarea",rows:2,name:"technicalSpecs",value:r.technicalSpecs,onChange:c,placeholder:"File format, polygon count, dimensions, etc.",style:{...i,fontSize:"0.9rem"}})]}),(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{style:{color:"#e0e0e0",fontWeight:"400",fontSize:"0.9rem"},children:"Usage Instructions"}),(0,x.jsx)(O.A.Control,{as:"textarea",rows:2,name:"instructions",value:r.instructions,onChange:c,placeholder:"How to use this design, any special requirements...",style:{...i,fontSize:"0.9rem"}})]}),(0,x.jsxs)(O.A.Group,{className:"mb-0",children:[(0,x.jsx)(O.A.Label,{style:{color:"#e0e0e0",fontWeight:"400",fontSize:"0.9rem"},children:"Tags (comma-separated)"}),(0,x.jsx)(O.A.Control,{type:"text",name:"tags",value:r.tags,onChange:c,placeholder:"e.g., aerodynamic, vehicle, high-detail",style:{...i,fontSize:"0.9rem"}})]})]}),(0,x.jsxs)("div",{style:{background:"rgba(255, 107, 107, 0.1)",border:"1px solid rgba(255, 107, 107, 0.3)",borderRadius:"8px",padding:"1.25rem",marginBottom:"1.5rem"},children:[(0,x.jsxs)("h6",{style:{color:"#ff6b6b",marginBottom:"1rem"},children:[(0,x.jsx)("i",{className:"fas fa-shield-alt me-2"}),"Legal Declarations"]}),(0,x.jsx)(O.A.Group,{className:"mb-3",children:(0,x.jsx)(O.A.Check,{type:"checkbox",name:"originDeclaration",checked:r.originDeclaration,onChange:c,required:!0,label:"I declare that I am the original creator or have the legal rights to sell this design",style:{color:"#e0e0e0"}})}),(0,x.jsx)(O.A.Group,{className:"mb-0",children:(0,x.jsx)(O.A.Check,{type:"checkbox",name:"qualityAssurance",checked:r.qualityAssurance,onChange:c,required:!0,label:"I confirm that this design is of high quality and suitable for its intended use",style:{color:"#e0e0e0"}})})]}),(0,x.jsxs)("div",{className:"d-flex justify-content-between align-items-center gap-3 mt-4",children:[(0,x.jsxs)("button",{type:"button",className:"btn btn-outline-light",onClick:s,style:{padding:"0.75rem 2rem",borderRadius:"8px",fontWeight:"500",flex:1},children:[(0,x.jsx)("i",{className:"fas fa-times me-2"}),"Cancel"]}),(0,x.jsxs)("button",{type:"submit",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",color:"white",padding:"0.75rem 2rem",borderRadius:"8px",fontWeight:"bold",fontSize:"1.05rem",flex:2,boxShadow:"0 4px 15px rgba(102, 126, 234, 0.4)"},className:"btn",children:[(0,x.jsx)("i",{className:"fas fa-rocket me-2"}),"List Design for Sale"]})]})]})})]})]})},ee="user_purchase_history",se=e=>{try{const s=localStorage.getItem(ee);if(!s)return ae(e);const a=JSON.parse(s)[e];if(!a)return ae(e);const t=new Date(a.lastUpdated).getTime();return Date.now()-t>2592e6?(console.log("Purchase history expired, creating fresh history"),ae(e)):a}catch(s){return console.error("Error loading purchase history:",s),ae(e)}},ae=e=>({userId:e,purchases:[],sales:[],totalSpent:0,totalEarned:0,lastUpdated:(new Date).toISOString()}),te=e=>{try{const s=localStorage.getItem(ee),a=s?JSON.parse(s):{};return a[e.userId]={...e,lastUpdated:(new Date).toISOString()},localStorage.setItem(ee,JSON.stringify(a)),console.log("Purchase history saved for user:",e.userId),!0}catch(e){return console.error("Error saving purchase history:",e),!1}},ne=e=>{const s=se(e),a=s.purchases.filter(e=>"completed"===e.status),t=s.sales.filter(e=>"active"===e.status),n=s.sales.filter(e=>"sold"===e.status);return{totalPurchases:a.length,totalSpent:s.totalSpent,totalSales:n.length,totalEarned:s.totalEarned,activeSales:t.length,recentPurchases:a.slice(0,5),recentSales:s.sales.slice(0,5)}};var re=a(4264);const le=({show:e,onClose:s,onBundleCreated:a})=>{const{user:n}=B(),[r,l]=(0,t.useState)([]),[i,o]=(0,t.useState)([]),[c,d]=(0,t.useState)(!1),[m,h]=(0,t.useState)(""),[u,g]=(0,t.useState)({name:"",description:"",category:"Bundle Pack",bundlePrice:0,discountPercentage:10,designIds:[]});(0,t.useEffect)(()=>{e&&n&&p()},[e,n]),(0,t.useEffect)(()=>{if(i.length>0){const e=i.reduce((e,s)=>e+s.price,0)*(1-u.discountPercentage/100);g(s=>({...s,bundlePrice:parseFloat(e.toFixed(2)),designIds:i.map(e=>e.id)}))}},[i,u.discountPercentage]);const p=async()=>{d(!0),h("");try{const e=(await T.designs.getAll()).filter(e=>e.seller_id===n?.id||e.seller_id===String(n?.id));l(e.map(e=>({id:e.id,name:e.name||e.design_name,price:parseFloat(e.price),description:e.description,category:e.category})))}catch(e){console.log("⚠️ API failed, using mock user designs");l([{id:"design_1",name:"Custom CPU Cooler",price:24.99,description:"High-performance CPU cooling solution",category:"Cooling"},{id:"design_2",name:"Gaming Case Fan Set",price:19.99,description:"RGB gaming case fans",category:"Cooling"},{id:"design_3",name:"Liquid Cooling Mount",price:15.99,description:"Universal liquid cooling mounting system",category:"Cooling"},{id:"design_4",name:"Performance Heatsink",price:12.99,description:"Aluminum performance heatsink",category:"Cooling"}])}finally{d(!1)}},b=(e,s)=>{g(a=>({...a,[e]:s}))},f=()=>i.reduce((e,s)=>e+s.price,0),j=()=>f()-u.bundlePrice,y=()=>{o([]),g({name:"",description:"",category:"Bundle Pack",bundlePrice:0,discountPercentage:10,designIds:[]}),h(""),s()};return(0,x.jsxs)(_.A,{show:e,onHide:y,size:"xl",centered:!0,className:"bundle-modal",children:[(0,x.jsx)("style",{children:"\n        .bundle-modal .modal-content {\n          background: linear-gradient(135deg, #1a365d 0%, #2d3748 50%, #1a202c 100%);\n          border: 1px solid rgba(79, 209, 197, 0.3);\n          color: #e2e8f0;\n        }\n        \n        .bundle-modal .modal-header {\n          border-bottom: 2px solid rgba(79, 209, 197, 0.3);\n          background: linear-gradient(90deg, rgba(79, 209, 197, 0.1) 0%, rgba(56, 178, 172, 0.1) 100%);\n        }\n        \n        .bundle-modal .design-card {\n          background: rgba(255, 255, 255, 0.05);\n          border: 1px solid rgba(79, 209, 197, 0.2);\n          border-radius: 12px;\n          padding: 1rem;\n          margin-bottom: 0.5rem;\n          transition: all 0.3s ease;\n          cursor: pointer;\n        }\n        \n        .bundle-modal .design-card:hover {\n          background: rgba(255, 255, 255, 0.1);\n          border-color: rgba(79, 209, 197, 0.4);\n        }\n        \n        .bundle-modal .design-card.selected {\n          background: rgba(79, 209, 197, 0.15);\n          border-color: #4fd1c5;\n          box-shadow: 0 0 15px rgba(79, 209, 197, 0.3);\n        }\n        \n        .bundle-modal .pricing-summary {\n          background: rgba(79, 209, 197, 0.1);\n          border: 1px solid rgba(79, 209, 197, 0.3);\n          border-radius: 12px;\n          padding: 1.5rem;\n        }\n        \n        .bundle-modal .form-control, .bundle-modal .form-select {\n          background: rgba(255, 255, 255, 0.1);\n          border: 1px solid rgba(79, 209, 197, 0.3);\n          color: #e2e8f0;\n        }\n        \n        .bundle-modal .form-control:focus, .bundle-modal .form-select:focus {\n          background: rgba(255, 255, 255, 0.15);\n          border-color: #4fd1c5;\n          box-shadow: 0 0 10px rgba(79, 209, 197, 0.3);\n          color: #e2e8f0;\n        }\n        \n        .bundle-modal .btn-primary {\n          background: linear-gradient(135deg, #4fd1c5, #38b2ac);\n          border: none;\n          color: white;\n          font-weight: 600;\n        }\n        \n        .bundle-modal .btn-secondary {\n          background: rgba(255, 255, 255, 0.1);\n          border: 1px solid rgba(255, 255, 255, 0.3);\n          color: #e2e8f0;\n        }\n      "}),(0,x.jsx)(_.A.Header,{closeButton:!0,children:(0,x.jsxs)(_.A.Title,{style:{fontSize:"1.5rem",fontWeight:"700",background:"linear-gradient(135deg, #4fd1c5, #38b2ac)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",display:"flex",alignItems:"center",gap:"12px"},children:[(0,x.jsx)("i",{className:"fas fa-box"}),"Create Design Bundle"]})}),(0,x.jsxs)(_.A.Body,{children:[m&&(0,x.jsx)(W.A,{variant:"danger",children:m}),(0,x.jsxs)("div",{className:"row",children:[(0,x.jsxs)("div",{className:"col-md-7",children:[(0,x.jsxs)("h5",{className:"mb-3",children:[(0,x.jsx)("i",{className:"fas fa-layer-group me-2"}),"Select Designs for Bundle"]}),c?(0,x.jsx)("div",{className:"text-center py-4",children:(0,x.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,x.jsx)("span",{className:"visually-hidden",children:"Loading designs..."})})}):0===r.length?(0,x.jsxs)("div",{className:"text-center py-4",children:[(0,x.jsx)("i",{className:"fas fa-cube fa-3x text-muted mb-3"}),(0,x.jsx)("h6",{className:"text-muted",children:"No designs available"}),(0,x.jsx)("p",{className:"text-muted",children:"Upload some designs first to create bundles."})]}):(0,x.jsx)("div",{style:{maxHeight:"400px",overflowY:"auto"},children:r.map(e=>(0,x.jsx)("div",{className:"design-card "+(i.find(s=>s.id===e.id)?"selected":""),onClick:()=>(e=>{o(s=>s.find(s=>s.id===e.id)?s.filter(s=>s.id!==e.id):[...s,e])})(e),children:(0,x.jsxs)("div",{className:"d-flex justify-content-between align-items-start",children:[(0,x.jsxs)("div",{className:"flex-grow-1",children:[(0,x.jsx)("h6",{className:"mb-1 text-white",children:e.name}),(0,x.jsx)("p",{className:"mb-1 text-white-50 small",children:e.description}),(0,x.jsx)(re.A,{bg:"secondary",children:e.category})]}),(0,x.jsxs)("div",{className:"text-end",children:[(0,x.jsxs)("div",{className:"h6 mb-0 text-success",children:["$",e.price.toFixed(2)]}),i.find(s=>s.id===e.id)&&(0,x.jsx)("i",{className:"fas fa-check-circle text-success mt-1"})]})]})},e.id))})]}),(0,x.jsxs)("div",{className:"col-md-5",children:[(0,x.jsxs)("h5",{className:"mb-3",children:[(0,x.jsx)("i",{className:"fas fa-cog me-2"}),"Bundle Configuration"]}),(0,x.jsxs)(O.A,{onSubmit:async e=>{if(e.preventDefault(),i.length<2)h("Please select at least 2 designs for a bundle");else if(u.name.trim()){d(!0),h("");try{const e={...u,totalValue:f(),savings:j(),designCount:i.length,designs:i},t=await T.designs.create({design_name:u.name,description:u.description,price:u.bundlePrice,category:u.category,bundle_data:JSON.stringify(e),is_bundle:!0});console.log("✅ Bundle created successfully:",t),a&&a(t),g({name:"",description:"",category:"Bundle Pack",bundlePrice:0,discountPercentage:10,designIds:[]}),o([]),s()}catch(e){console.error("❌ Bundle creation failed:",e),h("Failed to create bundle. Please try again.")}finally{d(!1)}}else h("Please enter a bundle name")},children:[(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{children:"Bundle Name *"}),(0,x.jsx)(O.A.Control,{type:"text",value:u.name,onChange:e=>b("name",e.target.value),placeholder:"e.g., Complete Cooling System Bundle",required:!0})]}),(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{children:"Category"}),(0,x.jsx)(O.A.Select,{value:u.category,onChange:e=>b("category",e.target.value),children:["Bundle Pack","Cooling Systems Bundle","Complete System Bundle","Premium Collection","Starter Pack","Professional Bundle"].map(e=>(0,x.jsx)("option",{value:e,children:e},e))})]}),(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{children:"Description"}),(0,x.jsx)(O.A.Control,{as:"textarea",rows:3,value:u.description,onChange:e=>b("description",e.target.value),placeholder:"Describe what's included in this bundle..."})]}),(0,x.jsxs)(O.A.Group,{className:"mb-4",children:[(0,x.jsx)(O.A.Label,{children:"Discount Percentage"}),(0,x.jsx)(O.A.Control,{type:"number",min:"5",max:"50",value:u.discountPercentage,onChange:e=>b("discountPercentage",parseFloat(e.target.value)||0)})]}),i.length>0&&(0,x.jsxs)("div",{className:"pricing-summary",children:[(0,x.jsxs)("h6",{className:"mb-3",children:[(0,x.jsx)("i",{className:"fas fa-calculator me-2"}),"Pricing Summary"]}),(0,x.jsxs)("div",{className:"d-flex justify-content-between mb-2",children:[(0,x.jsxs)("span",{children:["Selected Items (",i.length,"):"]}),(0,x.jsxs)("span",{children:["$",f().toFixed(2)]})]}),(0,x.jsxs)("div",{className:"d-flex justify-content-between mb-2",children:[(0,x.jsxs)("span",{children:["Discount (",u.discountPercentage,"%):"]}),(0,x.jsxs)("span",{className:"text-warning",children:["-$",j().toFixed(2)]})]}),(0,x.jsx)("hr",{style:{borderColor:"rgba(79, 209, 197, 0.3)"}}),(0,x.jsxs)("div",{className:"d-flex justify-content-between mb-3",children:[(0,x.jsx)("strong",{children:"Bundle Price:"}),(0,x.jsxs)("strong",{className:"text-success",children:["$",u.bundlePrice.toFixed(2)]})]}),(0,x.jsxs)("div",{className:"d-grid gap-2",children:[(0,x.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:c||i.length<2,children:c?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:(0,x.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),"Creating Bundle..."]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("i",{className:"fas fa-plus me-2"}),"Create Bundle"]})}),(0,x.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:y,disabled:c,children:"Cancel"})]})]}),0===i.length&&(0,x.jsxs)("div",{className:"text-center py-3",children:[(0,x.jsx)("i",{className:"fas fa-info-circle text-info me-2"}),(0,x.jsx)("span",{className:"text-white-50",children:"Select at least 2 designs to create a bundle"})]})]})]})]})]})]})},ie=({show:e,onClose:s,user:a})=>{const{user:n}=B(),l=((0,r.Zp)(),a||n),[i,o]=(0,t.useState)("overview"),[c,d]=(0,t.useState)([]),[m,h]=(0,t.useState)([]),[u,g]=(0,t.useState)({totalPurchases:0,totalSpent:0,totalSales:0,totalEarned:0,activeSales:0,recentPurchases:[],recentSales:[]}),[p,b]=(0,t.useState)(!0),[f,j]=(0,t.useState)(!1);(0,t.useEffect)(()=>{l&&e&&y()},[l,e]);const y=()=>{if(l){b(!0);try{const e=se(l.id.toString()),s=ne(l.id.toString());d(e.purchases),h(e.sales),g(s),console.log("Loaded user dashboard data:",{userHistory:e,userStats:s})}catch(e){console.error("Error loading user dashboard data:",e)}finally{b(!1)}}},v=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),N=e=>`$${e.toFixed(2)}`,w=e=>{switch(e){case"completed":case"sold":return(0,x.jsx)("span",{className:"status-badge status-success",children:e});case"pending":return(0,x.jsx)("span",{className:"status-badge status-warning",children:e});case"refunded":return(0,x.jsx)("span",{className:"status-badge status-danger",children:e});case"active":return(0,x.jsx)("span",{className:"status-badge status-info",children:e});case"inactive":return(0,x.jsx)("span",{className:"status-badge status-secondary",children:e});default:return(0,x.jsx)("span",{className:"status-badge status-light",children:e})}},S=()=>{console.log("📂 Opening file upload dialog..."),s(),window.dispatchEvent(new CustomEvent("triggerFileUpload"))},k=()=>{console.log("📊 Switching to analytics tab..."),o("analytics")},A=async()=>{console.log("💰 Requesting payout...");try{const e={amount:u.totalEarned+150.75,method:"paypal",netAmount:.97*(u.totalEarned+150.75)},s=await T.payouts.request(e);console.log("✅ Payout requested successfully:",s),o("payouts")}catch(e){console.error("❌ Payout request failed:",e)}},C=()=>{console.log("📦 Opening bundle creation modal..."),j(!0)},P=e=>{switch(console.log(`🔧 ${e} tool clicked`),e){case"Upload Models":S();break;case"Price Manager":console.log("💰 Price Manager tool - not yet implemented");break;case"Performance Tracker":case"Customer Analytics":k();break;case"Promotion Center":console.log("📢 Promotion Center - not yet implemented");break;case"Review Manager":console.log("⭐ Review Manager - not yet implemented");break;case"3D Preview Tools":console.log("🎮 3D Preview Tools - not yet implemented");break;case"Material Editor":console.log("🎨 Material Editor - not yet implemented");break;default:console.log(`Tool "${e}" not yet implemented`)}};return l?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("style",{children:"\n          .dashboard-modal .modal-content {\n            background: linear-gradient(135deg, #0f1419 0%, #1a202c 100%);\n            border: 1px solid #2d3748;\n            border-radius: 16px;\n            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);\n          }\n          \n          .dashboard-modal .modal-header-dark {\n            background: linear-gradient(135deg, #1a365d 0%, #2c5282 100%);\n            border-bottom: 1px solid #2d3748;\n            border-radius: 16px 16px 0 0;\n            padding: 1.5rem;\n          }\n          \n          .dashboard-modal .modal-body-dark {\n            background: transparent;\n            color: #e2e8f0;\n            padding: 0;\n          }\n          \n          .dashboard-modal .nav-tabs {\n            background: rgba(26, 32, 44, 0.8);\n            border-bottom: 2px solid #2d3748;\n            padding: 1rem 1.5rem 0;\n            margin: 0;\n          }\n          \n          .dashboard-modal .nav-tabs .nav-link {\n            background: transparent;\n            border: none;\n            color: #a0aec0;\n            font-weight: 600;\n            padding: 1rem 1.5rem;\n            margin: 0 0.25rem;\n            border-radius: 12px 12px 0 0;\n            transition: all 0.3s ease;\n            position: relative;\n          }\n          \n          .dashboard-modal .nav-tabs .nav-link:hover {\n            color: #e2e8f0;\n            background: rgba(74, 85, 104, 0.3);\n            transform: translateY(-2px);\n          }\n          \n          .dashboard-modal .nav-tabs .nav-link.active {\n            color: #ffffff;\n            background: linear-gradient(135deg, #3182ce 0%, #2c5282 100%);\n            box-shadow: 0 4px 12px rgba(49, 130, 206, 0.3);\n          }\n          \n          .dashboard-modal .tab-content {\n            padding: 2rem;\n            max-height: 70vh;\n            overflow-y: auto;\n            background: linear-gradient(to bottom, rgba(15, 20, 25, 0.95) 0%, rgba(26, 32, 44, 0.95) 100%);\n          }\n          \n          .dashboard-modal .stats-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n            gap: 1.5rem;\n            margin-bottom: 2rem;\n          }\n          \n          .dashboard-modal .stat-card {\n            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);\n            border: 1px solid rgba(255, 255, 255, 0.1);\n            border-radius: 16px;\n            padding: 2rem;\n            text-align: center;\n            transition: all 0.3s ease;\n            backdrop-filter: blur(10px);\n            position: relative;\n            overflow: hidden;\n          }\n          \n          .dashboard-modal .stat-card::before {\n            content: '';\n            position: absolute;\n            top: 0;\n            left: 0;\n            right: 0;\n            height: 4px;\n            background: var(--gradient);\n          }\n          \n          .dashboard-modal .stat-card:hover {\n            transform: translateY(-8px);\n            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);\n            border-color: rgba(255, 255, 255, 0.2);\n          }\n          \n          .dashboard-modal .stat-card.purchases {\n            --gradient: linear-gradient(135deg, #48bb78 0%, #38a169 100%);\n          }\n          \n          .dashboard-modal .stat-card.spending {\n            --gradient: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);\n          }\n          \n          .dashboard-modal .stat-card.sales {\n            --gradient: linear-gradient(135deg, #ed8936 0%, #dd6b20 100%);\n          }\n          \n          .dashboard-modal .stat-card.earnings {\n            --gradient: linear-gradient(135deg, #9f7aea 0%, #805ad5 100%);\n          }\n          \n          .dashboard-modal .stat-icon {\n            font-size: 2.5rem;\n            margin-bottom: 1rem;\n            color: #4a5568;\n          }\n          \n          .dashboard-modal .stat-value {\n            font-size: 2.5rem;\n            font-weight: 800;\n            color: #ffffff;\n            margin-bottom: 0.5rem;\n            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);\n          }\n          \n          .dashboard-modal .stat-label {\n            font-size: 0.9rem;\n            color: #a0aec0;\n            font-weight: 600;\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n          }\n          \n          .dashboard-modal .stat-change {\n            font-size: 0.8rem;\n            margin-top: 0.5rem;\n            color: #48bb78;\n          }\n          \n          .dashboard-modal .content-card {\n            background: rgba(26, 32, 44, 0.8);\n            border: 1px solid #2d3748;\n            border-radius: 16px;\n            padding: 1.5rem;\n            margin-bottom: 1.5rem;\n            backdrop-filter: blur(10px);\n          }\n          \n          .dashboard-modal .content-card h5 {\n            color: #e2e8f0;\n            margin-bottom: 1.5rem;\n            font-weight: 700;\n            display: flex;\n            align-items: center;\n            gap: 0.5rem;\n          }\n          \n          .dashboard-modal .table-dark {\n            background: transparent;\n            color: #e2e8f0;\n          }\n          \n          .dashboard-modal .table-dark thead th {\n            background: rgba(45, 55, 72, 0.8);\n            border-color: #2d3748;\n            color: #e2e8f0;\n            font-weight: 600;\n            padding: 1rem;\n          }\n          \n          .dashboard-modal .table-dark tbody td {\n            border-color: #2d3748;\n            padding: 1rem;\n            color: #cbd5e0;\n          }\n          \n          .dashboard-modal .table-dark tbody tr:hover {\n            background: rgba(45, 55, 72, 0.5);\n          }\n          \n          .dashboard-modal .status-badge {\n            padding: 0.4rem 0.8rem;\n            border-radius: 20px;\n            font-size: 0.75rem;\n            font-weight: 600;\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n          }\n          \n          .dashboard-modal .status-success {\n            background: rgba(72, 187, 120, 0.2);\n            color: #48bb78;\n            border: 1px solid rgba(72, 187, 120, 0.3);\n          }\n          \n          .dashboard-modal .status-warning {\n            background: rgba(237, 137, 54, 0.2);\n            color: #ed8936;\n            border: 1px solid rgba(237, 137, 54, 0.3);\n          }\n          \n          .dashboard-modal .status-danger {\n            background: rgba(245, 101, 101, 0.2);\n            color: #f56565;\n            border: 1px solid rgba(245, 101, 101, 0.3);\n          }\n          \n          .dashboard-modal .status-info {\n            background: rgba(66, 153, 225, 0.2);\n            color: #4299e1;\n            border: 1px solid rgba(66, 153, 225, 0.3);\n          }\n          \n          .dashboard-modal .status-secondary {\n            background: rgba(160, 174, 192, 0.2);\n            color: #a0aec0;\n            border: 1px solid rgba(160, 174, 192, 0.3);\n          }\n          \n          .dashboard-modal .empty-state {\n            text-align: center;\n            padding: 3rem;\n            color: #a0aec0;\n          }\n          \n          .dashboard-modal .empty-state i {\n            font-size: 4rem;\n            margin-bottom: 1rem;\n            color: #4a5568;\n          }\n          \n          .dashboard-modal .btn-primary-custom {\n            background: linear-gradient(135deg, #3182ce 0%, #2c5282 100%);\n            border: none;\n            border-radius: 12px;\n            padding: 0.75rem 1.5rem;\n            font-weight: 600;\n            color: white;\n            transition: all 0.3s ease;\n          }\n          \n          .dashboard-modal .btn-primary-custom:hover {\n            transform: translateY(-2px);\n            box-shadow: 0 8px 25px rgba(49, 130, 206, 0.3);\n          }\n          \n          .dashboard-modal .btn-outline-custom {\n            background: transparent;\n            border: 2px solid #4a5568;\n            border-radius: 12px;\n            padding: 0.5rem 1rem;\n            color: #e2e8f0;\n            font-weight: 600;\n            transition: all 0.3s ease;\n          }\n          \n          .dashboard-modal .btn-outline-custom:hover {\n            border-color: #3182ce;\n            color: #3182ce;\n            background: rgba(49, 130, 206, 0.1);\n          }\n          \n          .dashboard-modal .metric-row {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 0.75rem 0;\n            border-bottom: 1px solid #2d3748;\n          }\n          \n          .dashboard-modal .metric-row:last-child {\n            border-bottom: none;\n          }\n          \n          .dashboard-modal .metric-label {\n            color: #a0aec0;\n            font-weight: 500;\n          }\n          \n          .dashboard-modal .metric-value {\n            color: #e2e8f0;\n            font-weight: 700;\n          }\n          \n          .dashboard-modal .progress-bar {\n            height: 8px;\n            background: rgba(45, 55, 72, 0.8);\n            border-radius: 4px;\n            overflow: hidden;\n            margin: 0.5rem 0;\n          }\n          \n          .dashboard-modal .progress-fill {\n            height: 100%;\n            background: linear-gradient(135deg, #3182ce 0%, #2c5282 100%);\n            border-radius: 4px;\n            transition: width 0.3s ease;\n          }\n          \n          .dashboard-modal .tool-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n            gap: 1rem;\n            margin-top: 1.5rem;\n          }\n          \n          .dashboard-modal .tool-card {\n            background: rgba(45, 55, 72, 0.6);\n            border: 1px solid #4a5568;\n            border-radius: 12px;\n            padding: 1.5rem;\n            text-align: center;\n            transition: all 0.3s ease;\n            cursor: pointer;\n          }\n          \n          .dashboard-modal .tool-card:hover {\n            transform: translateY(-4px);\n            border-color: #3182ce;\n            background: rgba(49, 130, 206, 0.1);\n          }\n          \n          .dashboard-modal .tool-icon {\n            font-size: 2rem;\n            margin-bottom: 1rem;\n            color: #3182ce;\n          }\n          \n          .dashboard-modal .tool-title {\n            color: #e2e8f0;\n            font-weight: 600;\n            margin-bottom: 0.5rem;\n          }\n          \n          .dashboard-modal .tool-description {\n            color: #a0aec0;\n            font-size: 0.85rem;\n          }\n          \n          .dashboard-modal .btn-outline-custom.btn-sm {\n            padding: 0.25rem 0.5rem;\n            font-size: 0.75rem;\n          }\n\n          .dashboard-modal .empty-state {\n            text-align: center;\n            padding: 3rem 1.5rem;\n            color: #a0aec0;\n          }\n          .dashboard-modal .empty-state i {\n            font-size: 3rem;\n            color: #4a5568;\n            margin-bottom: 1rem;\n          }\n          .dashboard-modal .empty-state h6 {\n            color: #e2e8f0;\n            margin-bottom: 0.5rem;\n            font-weight: 600;\n          }\n\n          .dashboard-modal .tool-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n            gap: 1rem;\n            margin-top: 1rem;\n          }\n          .dashboard-modal .tool-card {\n            padding: 1.5rem;\n            background: linear-gradient(135deg, rgba(49, 130, 206, 0.1) 0%, rgba(79, 209, 197, 0.05) 100%);\n            border: 1px solid rgba(79, 209, 197, 0.2);\n            border-radius: 12px;\n            transition: all 0.3s ease;\n            cursor: pointer;\n            text-align: center;\n          }\n          .dashboard-modal .tool-card:hover {\n            transform: translateY(-2px);\n            background: linear-gradient(135deg, rgba(49, 130, 206, 0.15) 0%, rgba(79, 209, 197, 0.1) 100%);\n            border-color: rgba(79, 209, 197, 0.4);\n            box-shadow: 0 8px 25px rgba(79, 209, 197, 0.15);\n          }\n          .dashboard-modal .tool-icon {\n            font-size: 2rem;\n            color: #4fd1c5;\n            margin-bottom: 0.75rem;\n          }\n          .dashboard-modal .tool-title {\n            font-weight: 600;\n            color: #e2e8f0;\n            margin-bottom: 0.5rem;\n            font-size: 1.1rem;\n          }\n          .dashboard-modal .tool-description {\n            color: #a0aec0;\n            font-size: 0.9rem;\n            line-height: 1.4;\n          }\n\n          .dashboard-modal .progress-bar {\n            width: 100%;\n            height: 4px;\n            background: rgba(79, 209, 197, 0.1);\n            border-radius: 2px;\n            overflow: hidden;\n            margin-top: 0.5rem;\n          }\n          .dashboard-modal .progress-fill {\n            height: 100%;\n            background: linear-gradient(90deg, #4fd1c5, #38b2ac);\n            transition: width 0.8s ease;\n          }\n\n          .dashboard-modal .text-success { color: #48bb78 !important; }\n          .dashboard-modal .text-info { color: #4299e1 !important; }\n          .dashboard-modal .text-warning { color: #ed8936 !important; }\n          .dashboard-modal .text-danger { color: #f56565 !important; }\n          .dashboard-modal .text-primary { color: #4fd1c5 !important; }\n        "}),(0,x.jsxs)(_.A,{show:e,onHide:s,size:"xl",centered:!0,className:"dashboard-modal",children:[(0,x.jsx)(_.A.Header,{closeButton:!0,className:"modal-header-dark",children:(0,x.jsxs)(_.A.Title,{children:[(0,x.jsx)("i",{className:"fas fa-tachometer-alt me-2"}),l.firstName||l.name,"'s Dashboard"]})}),(0,x.jsx)(_.A.Body,{className:"modal-body-dark",children:p?(0,x.jsxs)("div",{className:"text-center py-5",children:[(0,x.jsx)("div",{className:"spinner-border text-primary",role:"status",style:{width:"3rem",height:"3rem"},children:(0,x.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,x.jsx)("h5",{className:"mt-3 text-white",children:"Loading your dashboard..."})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("ul",{className:"nav nav-tabs",children:[(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsxs)("button",{className:"nav-link "+("overview"===i?"active":""),onClick:()=>o("overview"),children:[(0,x.jsx)("i",{className:"fas fa-chart-line me-2"}),"Overview"]})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsxs)("button",{className:"nav-link "+("purchases"===i?"active":""),onClick:()=>o("purchases"),children:[(0,x.jsx)("i",{className:"fas fa-shopping-cart me-2"}),"Purchases (",u.totalPurchases,")"]})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsxs)("button",{className:"nav-link "+("sales"===i?"active":""),onClick:()=>o("sales"),children:[(0,x.jsx)("i",{className:"fas fa-store me-2"}),"Sales & Tools"]})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsxs)("button",{className:"nav-link "+("analytics"===i?"active":""),onClick:()=>o("analytics"),children:[(0,x.jsx)("i",{className:"fas fa-chart-bar me-2"}),"Analytics"]})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsxs)("button",{className:"nav-link "+("payouts"===i?"active":""),onClick:()=>o("payouts"),children:[(0,x.jsx)("i",{className:"fas fa-money-bill-wave me-2"}),"Payouts"]})})]}),(0,x.jsxs)("div",{className:"tab-content",children:["overview"===i&&(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{className:"stats-grid",children:[(0,x.jsxs)("div",{className:"stat-card purchases",children:[(0,x.jsx)("i",{className:"fas fa-shopping-bag stat-icon"}),(0,x.jsx)("div",{className:"stat-value",children:u.totalPurchases}),(0,x.jsx)("div",{className:"stat-label",children:"Total Purchases"}),(0,x.jsxs)("div",{className:"stat-change",children:[(0,x.jsx)("i",{className:"fas fa-arrow-up me-1"}),"+12% this month"]})]}),(0,x.jsxs)("div",{className:"stat-card spending",children:[(0,x.jsx)("i",{className:"fas fa-dollar-sign stat-icon"}),(0,x.jsx)("div",{className:"stat-value",children:N(u.totalSpent)}),(0,x.jsx)("div",{className:"stat-label",children:"Total Spent"}),(0,x.jsxs)("div",{className:"stat-change",children:[(0,x.jsx)("i",{className:"fas fa-arrow-up me-1"}),"+5% this month"]})]}),(0,x.jsxs)("div",{className:"stat-card sales",children:[(0,x.jsx)("i",{className:"fas fa-chart-line stat-icon"}),(0,x.jsx)("div",{className:"stat-value",children:u.totalSales}),(0,x.jsx)("div",{className:"stat-label",children:"Items Sold"}),(0,x.jsxs)("div",{className:"stat-change",children:[(0,x.jsx)("i",{className:"fas fa-arrow-up me-1"}),"+25% this month"]})]}),(0,x.jsxs)("div",{className:"stat-card earnings",children:[(0,x.jsx)("i",{className:"fas fa-coins stat-icon"}),(0,x.jsx)("div",{className:"stat-value",children:N(u.totalEarned)}),(0,x.jsx)("div",{className:"stat-label",children:"Total Earned"}),(0,x.jsxs)("div",{className:"stat-change",children:[(0,x.jsx)("i",{className:"fas fa-arrow-up me-1"}),"+18% this month"]})]})]}),(0,x.jsxs)("div",{className:"row",children:[(0,x.jsx)("div",{className:"col-lg-6",children:(0,x.jsxs)("div",{className:"content-card",children:[(0,x.jsxs)("h5",{children:[(0,x.jsx)("i",{className:"fas fa-shopping-cart text-primary"}),"Recent Purchases"]}),0===u.recentPurchases.length?(0,x.jsxs)("div",{className:"empty-state",children:[(0,x.jsx)("i",{className:"fas fa-shopping-cart"}),(0,x.jsx)("h6",{children:"No purchases yet"}),(0,x.jsx)("p",{children:"Start shopping to see your purchase history here."})]}):u.recentPurchases.map(e=>(0,x.jsxs)("div",{className:"metric-row",children:[(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{className:"metric-label",children:[e.items.length," item(s)"]}),(0,x.jsx)("small",{style:{color:"#718096"},children:v(e.purchaseDate)})]}),(0,x.jsxs)("div",{className:"text-end",children:[(0,x.jsx)("div",{className:"metric-value text-success",children:N(e.total)}),w(e.status)]})]},e.id))]})}),(0,x.jsx)("div",{className:"col-lg-6",children:(0,x.jsxs)("div",{className:"content-card",children:[(0,x.jsxs)("h5",{children:[(0,x.jsx)("i",{className:"fas fa-chart-line text-warning"}),"Recent Sales Activity"]}),0===u.recentSales.length?(0,x.jsxs)("div",{className:"empty-state",children:[(0,x.jsx)("i",{className:"fas fa-store"}),(0,x.jsx)("h6",{children:"No sales yet"}),(0,x.jsx)("p",{children:"List your first item to start selling and earning."})]}):u.recentSales.map(e=>(0,x.jsxs)("div",{className:"metric-row",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"metric-label",children:e.item.name}),(0,x.jsx)("small",{style:{color:"#718096"},children:v(e.saleDate)})]}),(0,x.jsxs)("div",{className:"text-end",children:[(0,x.jsx)("div",{className:"metric-value text-warning",children:N(e.salePrice)}),w(e.status)]})]},e.id))]})})]}),(0,x.jsxs)("div",{className:"content-card",children:[(0,x.jsxs)("h5",{children:[(0,x.jsx)("i",{className:"fas fa-bolt text-info"}),"Quick Actions"]}),(0,x.jsxs)("div",{className:"tool-grid",children:[(0,x.jsxs)("div",{className:"tool-card",onClick:S,children:[(0,x.jsx)("i",{className:"fas fa-upload tool-icon"}),(0,x.jsx)("div",{className:"tool-title",children:"Upload Design"}),(0,x.jsx)("div",{className:"tool-description",children:"Add new 3D models to sell"})]}),(0,x.jsxs)("div",{className:"tool-card",onClick:C,children:[(0,x.jsx)("i",{className:"fas fa-box tool-icon"}),(0,x.jsx)("div",{className:"tool-title",children:"Create Bundle"}),(0,x.jsx)("div",{className:"tool-description",children:"Bundle designs for better sales"})]}),(0,x.jsxs)("div",{className:"tool-card",onClick:k,children:[(0,x.jsx)("i",{className:"fas fa-chart-pie tool-icon"}),(0,x.jsx)("div",{className:"tool-title",children:"View Analytics"}),(0,x.jsx)("div",{className:"tool-description",children:"Track your performance"})]}),(0,x.jsxs)("div",{className:"tool-card",onClick:A,children:[(0,x.jsx)("i",{className:"fas fa-money-bill-wave tool-icon"}),(0,x.jsx)("div",{className:"tool-title",children:"Request Payout"}),(0,x.jsx)("div",{className:"tool-description",children:"Withdraw your earnings"})]})]})]})]}),"purchases"===i&&(0,x.jsx)("div",{children:(0,x.jsxs)("div",{className:"content-card",children:[(0,x.jsxs)("h5",{children:[(0,x.jsx)("i",{className:"fas fa-shopping-cart text-primary"}),"Purchase History & Management"]}),0===c.length?(0,x.jsxs)("div",{className:"empty-state",children:[(0,x.jsx)("i",{className:"fas fa-shopping-cart"}),(0,x.jsx)("h6",{children:"No purchases yet"}),(0,x.jsx)("p",{children:"Your purchase history will appear here after you buy something from the store."}),(0,x.jsxs)("button",{className:"btn btn-primary-custom mt-3",onClick:()=>{console.log("🛍️ Navigating to store..."),s(),window.dispatchEvent(new CustomEvent("switchToStore"))},children:[(0,x.jsx)("i",{className:"fas fa-store me-2"}),"Browse Store"]})]}):(0,x.jsx)("div",{className:"table-responsive",children:(0,x.jsxs)("table",{className:"table table-dark table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Order ID"}),(0,x.jsx)("th",{children:"Items"}),(0,x.jsx)("th",{children:"Date"}),(0,x.jsx)("th",{children:"Total"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Actions"})]})}),(0,x.jsx)("tbody",{children:c.map(e=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:(0,x.jsxs)("code",{style:{color:"#3182ce",fontSize:"0.85rem"},children:["#",e.id.slice(-8)]})}),(0,x.jsx)("td",{children:(0,x.jsx)("div",{children:e.items.map((e,s)=>(0,x.jsxs)("div",{className:"small",children:[(0,x.jsx)("strong",{children:e.name})," × ",e.quantity]},s))})}),(0,x.jsx)("td",{className:"small",children:v(e.purchaseDate)}),(0,x.jsxs)("td",{children:[(0,x.jsx)("strong",{style:{color:"#48bb78"},children:N(e.total)}),(0,x.jsx)("br",{}),(0,x.jsxs)("small",{style:{color:"#a0aec0"},children:["Tax: ",N(e.tax)]})]}),(0,x.jsx)("td",{children:w(e.status)}),(0,x.jsx)("td",{children:(0,x.jsxs)("div",{className:"d-flex gap-1",children:[(0,x.jsx)("button",{className:"btn btn-outline-custom btn-sm",title:"View Details",onClick:()=>(e=>{console.log("🔍 Viewing purchase details:",e.id)})(e),children:(0,x.jsx)("i",{className:"fas fa-eye"})}),(0,x.jsx)("button",{className:"btn btn-outline-custom btn-sm",title:"Download",onClick:()=>(e=>{console.log("⬇️ Downloading purchase:",e.id)})(e),children:(0,x.jsx)("i",{className:"fas fa-download"})}),(0,x.jsx)("button",{className:"btn btn-outline-custom btn-sm",title:"Support",onClick:()=>(e=>{console.log("🎧 Opening support for purchase:",e.id)})(e),children:(0,x.jsx)("i",{className:"fas fa-question-circle"})})]})})]},e.id))})]})})]})}),"sales"===i&&(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{className:"content-card mb-4",children:[(0,x.jsxs)("h5",{children:[(0,x.jsx)("i",{className:"fas fa-tools text-warning"}),"3D Marketplace Tools"]}),(0,x.jsxs)("div",{className:"tool-grid",children:[(0,x.jsxs)("div",{className:"tool-card",onClick:()=>P("Upload Models"),children:[(0,x.jsx)("i",{className:"fas fa-upload tool-icon"}),(0,x.jsx)("div",{className:"tool-title",children:"Upload Models"}),(0,x.jsx)("div",{className:"tool-description",children:"Add new 3D designs to your store"})]}),(0,x.jsxs)("div",{className:"tool-card",onClick:C,children:[(0,x.jsx)("i",{className:"fas fa-box tool-icon"}),(0,x.jsx)("div",{className:"tool-title",children:"Create Bundle"}),(0,x.jsx)("div",{className:"tool-description",children:"Bundle multiple designs for better value"})]}),(0,x.jsxs)("div",{className:"tool-card",onClick:()=>P("Price Manager"),children:[(0,x.jsx)("i",{className:"fas fa-tags tool-icon"}),(0,x.jsx)("div",{className:"tool-title",children:"Price Manager"}),(0,x.jsx)("div",{className:"tool-description",children:"Set competitive pricing strategies"})]}),(0,x.jsxs)("div",{className:"tool-card",onClick:()=>P("Performance Tracker"),children:[(0,x.jsx)("i",{className:"fas fa-chart-line tool-icon"}),(0,x.jsx)("div",{className:"tool-title",children:"Performance Tracker"}),(0,x.jsx)("div",{className:"tool-description",children:"Monitor views, likes, and downloads"})]}),(0,x.jsxs)("div",{className:"tool-card",onClick:()=>P("Promotion Center"),children:[(0,x.jsx)("i",{className:"fas fa-bullhorn tool-icon"}),(0,x.jsx)("div",{className:"tool-title",children:"Promotion Center"}),(0,x.jsx)("div",{className:"tool-description",children:"Boost visibility with campaigns"})]}),(0,x.jsxs)("div",{className:"tool-card",onClick:()=>P("Customer Analytics"),children:[(0,x.jsx)("i",{className:"fas fa-users tool-icon"}),(0,x.jsx)("div",{className:"tool-title",children:"Customer Analytics"}),(0,x.jsx)("div",{className:"tool-description",children:"Understand your buyers better"})]}),(0,x.jsxs)("div",{className:"tool-card",onClick:()=>P("Review Manager"),children:[(0,x.jsx)("i",{className:"fas fa-star tool-icon"}),(0,x.jsx)("div",{className:"tool-title",children:"Review Manager"}),(0,x.jsx)("div",{className:"tool-description",children:"Manage ratings and feedback"})]}),(0,x.jsxs)("div",{className:"tool-card",onClick:()=>P("Material Editor"),children:[(0,x.jsx)("i",{className:"fas fa-palette tool-icon"}),(0,x.jsx)("div",{className:"tool-title",children:"Material Editor"}),(0,x.jsx)("div",{className:"tool-description",children:"Customize textures and materials"})]})]})]}),(0,x.jsxs)("div",{className:"content-card",children:[(0,x.jsxs)("h5",{children:[(0,x.jsx)("i",{className:"fas fa-history text-info"}),"Sales History"]}),0===m.length?(0,x.jsxs)("div",{className:"empty-state",children:[(0,x.jsx)("i",{className:"fas fa-store"}),(0,x.jsx)("h6",{children:"No sales yet"}),(0,x.jsx)("p",{children:"Start selling your 3D designs and track your progress here."}),(0,x.jsxs)("button",{className:"btn btn-primary-custom mt-3",onClick:()=>{console.log("📋 Opening file upload to list first item..."),s(),window.dispatchEvent(new CustomEvent("triggerFileUpload"))},children:[(0,x.jsx)("i",{className:"fas fa-plus me-2"}),"List Your First Item"]})]}):(0,x.jsx)("div",{className:"table-responsive",children:(0,x.jsxs)("table",{className:"table table-dark table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Item"}),(0,x.jsx)("th",{children:"Category"}),(0,x.jsx)("th",{children:"Price"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Views"}),(0,x.jsx)("th",{children:"Revenue"}),(0,x.jsx)("th",{children:"Actions"})]})}),(0,x.jsx)("tbody",{children:m.map(e=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{style:{color:"#e2e8f0"},children:e.item.name}),(0,x.jsxs)("div",{className:"small text-muted",children:["Listed ",v(e.saleDate)]})]})}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{className:"badge",style:{background:"rgba(66, 153, 225, 0.2)",color:"#4299e1"},children:"3D Models"})}),(0,x.jsx)("td",{children:(0,x.jsx)("strong",{style:{color:"#48bb78"},children:N(e.salePrice)})}),(0,x.jsx)("td",{children:w(e.status)}),(0,x.jsx)("td",{children:(0,x.jsxs)("div",{style:{color:"#ed8936"},children:[(0,x.jsx)("i",{className:"fas fa-eye me-1"}),Math.floor(500*Math.random())+50]})}),(0,x.jsx)("td",{children:(0,x.jsx)("strong",{style:{color:"#9f7aea"},children:N(e.salePrice*Math.floor(5*Math.random()))})}),(0,x.jsx)("td",{children:(0,x.jsxs)("div",{className:"d-flex gap-1",children:[(0,x.jsx)("button",{className:"btn btn-outline-custom btn-sm",title:"Edit Listing",onClick:()=>(e=>{console.log("✏️ Editing listing:",e.id)})(e),children:(0,x.jsx)("i",{className:"fas fa-edit"})}),(0,x.jsx)("button",{className:"btn btn-outline-custom btn-sm",title:"Analytics",onClick:()=>(e=>{console.log("📈 Viewing analytics for sale:",e.id),o("analytics")})(e),children:(0,x.jsx)("i",{className:"fas fa-chart-bar"})}),(0,x.jsx)("button",{className:"btn btn-outline-custom btn-sm",title:"Promote",onClick:()=>(e=>{console.log("📢 Promoting listing:",e.id)})(e),children:(0,x.jsx)("i",{className:"fas fa-bullhorn"})})]})})]},e.id))})]})})]})]}),"analytics"===i&&(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{className:"row mb-4",children:[(0,x.jsx)("div",{className:"col-lg-8",children:(0,x.jsxs)("div",{className:"content-card",children:[(0,x.jsxs)("h5",{children:[(0,x.jsx)("i",{className:"fas fa-chart-bar text-info"}),"Performance Analytics"]}),(0,x.jsxs)("div",{className:"row",children:[(0,x.jsxs)("div",{className:"col-md-6",children:[(0,x.jsxs)("div",{className:"metric-row",children:[(0,x.jsx)("span",{className:"metric-label",children:"Conversion Rate"}),(0,x.jsx)("span",{className:"metric-value text-success",children:"12.5%"})]}),(0,x.jsx)("div",{className:"progress-bar",children:(0,x.jsx)("div",{className:"progress-fill",style:{width:"12.5%"}})})]}),(0,x.jsxs)("div",{className:"col-md-6",children:[(0,x.jsxs)("div",{className:"metric-row",children:[(0,x.jsx)("span",{className:"metric-label",children:"Avg. Order Value"}),(0,x.jsx)("span",{className:"metric-value text-info",children:N(32.39)})]}),(0,x.jsx)("div",{className:"progress-bar",children:(0,x.jsx)("div",{className:"progress-fill",style:{width:"65%"}})})]})]}),(0,x.jsxs)("div",{className:"row mt-3",children:[(0,x.jsxs)("div",{className:"col-md-6",children:[(0,x.jsxs)("div",{className:"metric-row",children:[(0,x.jsx)("span",{className:"metric-label",children:"Return Customer Rate"}),(0,x.jsx)("span",{className:"metric-value text-warning",children:"34%"})]}),(0,x.jsx)("div",{className:"progress-bar",children:(0,x.jsx)("div",{className:"progress-fill",style:{width:"34%"}})})]}),(0,x.jsxs)("div",{className:"col-md-6",children:[(0,x.jsxs)("div",{className:"metric-row",children:[(0,x.jsx)("span",{className:"metric-label",children:"Customer Satisfaction"}),(0,x.jsx)("span",{className:"metric-value text-success",children:"4.8/5"})]}),(0,x.jsx)("div",{className:"progress-bar",children:(0,x.jsx)("div",{className:"progress-fill",style:{width:"96%"}})})]})]})]})}),(0,x.jsx)("div",{className:"col-lg-4",children:(0,x.jsxs)("div",{className:"content-card",children:[(0,x.jsxs)("h5",{children:[(0,x.jsx)("i",{className:"fas fa-trophy text-warning"}),"Top Categories"]}),(0,x.jsxs)("div",{className:"metric-row",children:[(0,x.jsx)("span",{className:"metric-label",children:"Aerospace Models"}),(0,x.jsx)("span",{className:"metric-value",children:"45%"})]}),(0,x.jsxs)("div",{className:"metric-row",children:[(0,x.jsx)("span",{className:"metric-label",children:"Automotive Parts"}),(0,x.jsx)("span",{className:"metric-value",children:"28%"})]}),(0,x.jsxs)("div",{className:"metric-row",children:[(0,x.jsx)("span",{className:"metric-label",children:"Architecture"}),(0,x.jsx)("span",{className:"metric-value",children:"18%"})]}),(0,x.jsxs)("div",{className:"metric-row",children:[(0,x.jsx)("span",{className:"metric-label",children:"Industrial"}),(0,x.jsx)("span",{className:"metric-value",children:"9%"})]})]})})]}),(0,x.jsxs)("div",{className:"content-card",children:[(0,x.jsxs)("h5",{children:[(0,x.jsx)("i",{className:"fas fa-globe text-primary"}),"Traffic & Discovery Sources"]}),(0,x.jsxs)("div",{className:"row",children:[(0,x.jsx)("div",{className:"col-md-3",children:(0,x.jsxs)("div",{className:"metric-row",children:[(0,x.jsx)("span",{className:"metric-label",children:"Direct Search"}),(0,x.jsx)("span",{className:"metric-value text-success",children:"52%"})]})}),(0,x.jsx)("div",{className:"col-md-3",children:(0,x.jsxs)("div",{className:"metric-row",children:[(0,x.jsx)("span",{className:"metric-label",children:"Social Media"}),(0,x.jsx)("span",{className:"metric-value text-info",children:"23%"})]})}),(0,x.jsx)("div",{className:"col-md-3",children:(0,x.jsxs)("div",{className:"metric-row",children:[(0,x.jsx)("span",{className:"metric-label",children:"Referrals"}),(0,x.jsx)("span",{className:"metric-value text-warning",children:"15%"})]})}),(0,x.jsx)("div",{className:"col-md-3",children:(0,x.jsxs)("div",{className:"metric-row",children:[(0,x.jsx)("span",{className:"metric-label",children:"Featured"}),(0,x.jsx)("span",{className:"metric-value text-danger",children:"10%"})]})})]})]})]}),"payouts"===i&&(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{className:"stats-grid mb-4",children:[(0,x.jsxs)("div",{className:"stat-card earnings",children:[(0,x.jsx)("i",{className:"fas fa-wallet stat-icon"}),(0,x.jsx)("div",{className:"stat-value",children:N(u.totalEarned+150.75)}),(0,x.jsx)("div",{className:"stat-label",children:"Available Balance"}),(0,x.jsx)("div",{className:"stat-change",children:"Ready to withdraw"})]}),(0,x.jsxs)("div",{className:"stat-card sales",children:[(0,x.jsx)("i",{className:"fas fa-clock stat-icon"}),(0,x.jsx)("div",{className:"stat-value",children:N(75.5)}),(0,x.jsx)("div",{className:"stat-label",children:"Pending Payouts"}),(0,x.jsx)("div",{className:"stat-change",children:"Processing 2-3 days"})]}),(0,x.jsxs)("div",{className:"stat-card purchases",children:[(0,x.jsx)("i",{className:"fas fa-check-circle stat-icon"}),(0,x.jsx)("div",{className:"stat-value",children:N(u.totalEarned)}),(0,x.jsx)("div",{className:"stat-label",children:"Total Paid Out"}),(0,x.jsx)("div",{className:"stat-change",children:"All time earnings"})]}),(0,x.jsxs)("div",{className:"stat-card spending",children:[(0,x.jsx)("i",{className:"fas fa-calendar-alt stat-icon"}),(0,x.jsx)("div",{className:"stat-value",children:"Nov 1"}),(0,x.jsx)("div",{className:"stat-label",children:"Next Auto Payout"}),(0,x.jsx)("div",{className:"stat-change",children:"Monthly schedule"})]})]}),(0,x.jsxs)("div",{className:"row",children:[(0,x.jsx)("div",{className:"col-lg-8",children:(0,x.jsxs)("div",{className:"content-card",children:[(0,x.jsxs)("h5",{children:[(0,x.jsx)("i",{className:"fas fa-history text-success"}),"Payout History"]}),(0,x.jsx)("div",{className:"table-responsive",children:(0,x.jsxs)("table",{className:"table table-dark table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Payout ID"}),(0,x.jsx)("th",{children:"Amount"}),(0,x.jsx)("th",{children:"Method"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Date"}),(0,x.jsx)("th",{children:"Fee"})]})}),(0,x.jsxs)("tbody",{children:[(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:(0,x.jsx)("code",{style:{color:"#3182ce"},children:"#PO_001"})}),(0,x.jsx)("td",{children:(0,x.jsx)("strong",{style:{color:"#48bb78"},children:N(125)})}),(0,x.jsxs)("td",{children:[(0,x.jsx)("i",{className:"fab fa-paypal text-primary me-2"}),"PayPal"]}),(0,x.jsx)("td",{children:w("completed")}),(0,x.jsx)("td",{children:v(new Date(Date.now()-6048e5).toISOString())}),(0,x.jsx)("td",{children:N(3.75)})]}),(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:(0,x.jsx)("code",{style:{color:"#3182ce"},children:"#PO_002"})}),(0,x.jsx)("td",{children:(0,x.jsx)("strong",{style:{color:"#48bb78"},children:N(75.5)})}),(0,x.jsxs)("td",{children:[(0,x.jsx)("i",{className:"fas fa-university text-info me-2"}),"Bank"]}),(0,x.jsx)("td",{children:w("pending")}),(0,x.jsx)("td",{children:v(new Date(Date.now()-1728e5).toISOString())}),(0,x.jsx)("td",{children:N(2.5)})]})]})]})})]})}),(0,x.jsxs)("div",{className:"col-lg-4",children:[(0,x.jsxs)("div",{className:"content-card",children:[(0,x.jsxs)("h5",{children:[(0,x.jsx)("i",{className:"fas fa-cog text-warning"}),"Payout Settings"]}),(0,x.jsxs)("div",{className:"metric-row",children:[(0,x.jsx)("span",{className:"metric-label",children:"Auto Payout Threshold"}),(0,x.jsx)("span",{className:"metric-value",children:N(100)})]}),(0,x.jsxs)("div",{className:"metric-row",children:[(0,x.jsx)("span",{className:"metric-label",children:"Payout Schedule"}),(0,x.jsx)("span",{className:"metric-value",children:"Monthly"})]}),(0,x.jsxs)("div",{className:"metric-row",children:[(0,x.jsx)("span",{className:"metric-label",children:"Payment Method"}),(0,x.jsx)("span",{className:"metric-value",children:"PayPal"})]}),(0,x.jsxs)("div",{className:"metric-row",children:[(0,x.jsx)("span",{className:"metric-label",children:"Processing Fee"}),(0,x.jsx)("span",{className:"metric-value",children:"3%"})]}),(0,x.jsxs)("div",{className:"mt-4",children:[(0,x.jsxs)("button",{className:"btn btn-primary-custom w-100 mb-2",onClick:A,children:[(0,x.jsx)("i",{className:"fas fa-money-bill-wave me-2"}),"Request Payout"]}),(0,x.jsxs)("button",{className:"btn btn-outline-custom w-100",onClick:()=>{console.log("⚙️ Opening payout settings...")},children:[(0,x.jsx)("i",{className:"fas fa-cog me-2"}),"Update Settings"]})]})]}),(0,x.jsxs)("div",{className:"content-card mt-3",children:[(0,x.jsxs)("h5",{children:[(0,x.jsx)("i",{className:"fas fa-credit-card text-info"}),"Payment Methods"]}),(0,x.jsxs)("div",{className:"d-flex align-items-center p-3 mb-2",style:{background:"rgba(49, 130, 206, 0.1)",border:"1px solid rgba(49, 130, 206, 0.3)",borderRadius:"8px"},children:[(0,x.jsx)("i",{className:"fab fa-paypal text-primary fa-2x me-3"}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{color:"#e2e8f0",fontWeight:"600"},children:"PayPal"}),(0,x.jsx)("small",{style:{color:"#a0aec0"},children:"user@example.com"})]}),(0,x.jsx)("span",{className:"ms-auto status-badge status-success",children:"Primary"})]}),(0,x.jsxs)("button",{className:"btn btn-outline-custom w-100",onClick:()=>{console.log("💳 Adding new payment method...")},children:[(0,x.jsx)("i",{className:"fas fa-plus me-2"}),"Add Payment Method"]})]})]})]})]})]})]})})]}),(0,x.jsx)(le,{show:f,onClose:()=>j(!1),onBundleCreated:e=>{console.log("✅ Bundle created successfully:",e)}})]}):(0,x.jsxs)(_.A,{show:e,onHide:s,size:"lg",centered:!0,className:"dashboard-modal",children:[(0,x.jsx)(_.A.Header,{closeButton:!0,className:"modal-header-dark",children:(0,x.jsxs)(_.A.Title,{className:"text-white",children:[(0,x.jsx)("i",{className:"fas fa-tachometer-alt me-2"}),"Dashboard"]})}),(0,x.jsx)(_.A.Body,{className:"modal-body-dark text-center py-5",children:(0,x.jsxs)("div",{className:"auth-required",children:[(0,x.jsx)("i",{className:"fas fa-lock fa-3x text-primary mb-3"}),(0,x.jsx)("h4",{className:"text-white mb-3",children:"Authentication Required"}),(0,x.jsx)("p",{className:"text-light",children:"Please log in to access your dashboard and view your purchase and sales history."})]})})]})},oe=e=>{const s=(e.full_name||e.name||"").split(" "),a=s[0]||"",t=s.slice(1).join(" ")||"";return{id:e.id.toString(),email:e.email,firstName:a,lastName:t,username:e.username}},ce=({show:e,onClose:s,onAuthSuccess:a,initialMode:n="login"})=>{const[r,l]=(0,t.useState)(n),[i,o]=(0,t.useState)(!1),[c,d]=(0,t.useState)(""),[m,h]=(0,t.useState)({email:"",password:"",username:""}),[u,g]=(0,t.useState)({firstName:"",lastName:"",username:"",email:"",password:"",confirmPassword:"",agreeToTerms:!1}),p={background:"rgba(255, 255, 255, 0.08)",border:"1px solid rgba(255, 255, 255, 0.2)",color:"white",padding:"0.75rem",borderRadius:"8px"},b=e=>{const{name:s,value:a}=e.target;h(e=>({...e,[s]:a}))},f=e=>{const{name:s,value:a,type:t,checked:n}=e.target;g(e=>({...e,[s]:"checkbox"===t?n:a}))},j=async e=>{d(""),o(!0);try{await new Promise(e=>setTimeout(e,1500));const t={google:{firstName:"John",lastName:"Smith",email:"john.smith@gmail.com"},facebook:{firstName:"Jane",lastName:"Doe",email:"jane.doe@facebook.com"},github:{firstName:"Dev",lastName:"User",email:"dev.user@github.com"},linkedin:{firstName:"Professional",lastName:"User",email:"professional.user@linkedin.com"}}[e],n={id:`${e}_`+Date.now(),email:t.email,firstName:t.firstName,lastName:t.lastName,username:t.email.split("@")[0]};a(n),s()}catch(s){d(`Failed to sign in with ${e}. Please try again.`)}finally{o(!1)}},y=()=>{l("login"===r?"signup":"login"),d("")};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("style",{children:"\n          .auth-modal input::placeholder {\n            color: rgba(255, 255, 255, 0.5) !important;\n            opacity: 1;\n          }\n          .auth-modal .social-btn:hover:not(:disabled) {\n            transform: translateY(-1px);\n            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);\n            opacity: 0.9;\n          }\n          .auth-modal .social-btn:active:not(:disabled) {\n            transform: translateY(0px);\n          }\n          .auth-modal .social-btn:disabled {\n            opacity: 0.6;\n            cursor: not-allowed;\n          }\n        "}),(0,x.jsxs)(_.A,{show:e,onHide:s,centered:!0,backdrop:"static",className:"auth-modal",children:[(0,x.jsx)(_.A.Header,{closeButton:!0,style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderBottom:"2px solid rgba(255, 255, 255, 0.1)",color:"white"},children:(0,x.jsxs)(_.A.Title,{className:"d-flex align-items-center w-100",children:[(0,x.jsx)("img",{src:"/curfdlogo.png",alt:"CURFD",style:{height:"40px",marginRight:"1rem",filter:"brightness(1.2) contrast(1.1)"}}),(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{style:{fontSize:"1.3rem",fontWeight:"bold"},children:[(0,x.jsx)("i",{className:"fas "+("login"===r?"fa-sign-in-alt":"fa-user-plus"),style:{color:"#FFD700",marginRight:"0.5rem"}}),"login"===r?"Welcome Back":"Join CURFD"]}),(0,x.jsx)("small",{style:{opacity:.9,fontSize:"0.85rem"},children:"login"===r?"Sign in to your account":"Create your account to start selling"})]})]})}),(0,x.jsxs)(_.A.Body,{style:{background:"linear-gradient(to bottom, #1a1a2e 0%, #16213e 100%)",padding:"2rem"},children:[c&&(0,x.jsxs)(W.A,{variant:"danger",style:{background:"rgba(255, 107, 107, 0.1)",border:"1px solid rgba(255, 107, 107, 0.3)",color:"#ff6b6b"},children:[(0,x.jsx)("i",{className:"fas fa-exclamation-triangle me-2"}),c]}),"login"===r?(0,x.jsxs)(O.A,{onSubmit:async e=>{e.preventDefault(),d(""),o(!0);try{const e=await E(m.username,m.password);localStorage.setItem("authToken",e.access_token);const t=await L(),n=oe(t);a(n),s(),h({username:"",password:"",email:""})}catch(e){d("Invalid email or password. Please try again.")}finally{o(!1)}},children:[(0,x.jsxs)("div",{className:"alert mb-4",style:{background:"rgba(102, 126, 234, 0.1)",border:"1px solid rgba(102, 126, 234, 0.3)",borderRadius:"8px",color:"#a8b3ff"},children:[(0,x.jsx)("i",{className:"fas fa-info-circle me-2"}),"Sign in to access the marketplace and start selling your designs."]}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsx)("div",{className:"text-center mb-4",children:(0,x.jsx)("div",{style:{color:"#b0b0b0",fontSize:"0.9rem",fontWeight:"400",letterSpacing:"0.5px"},children:"Sign in with your social account"})}),(0,x.jsxs)("div",{className:"d-flex flex-column gap-3",children:[(0,x.jsxs)("div",{className:"row g-3",children:[(0,x.jsx)("div",{className:"col-6",children:(0,x.jsxs)("button",{type:"button",onClick:()=>j("google"),disabled:i,className:"btn w-100 social-btn d-flex align-items-center justify-content-center",style:{background:"rgba(219, 68, 55, 0.1)",border:"1px solid rgba(219, 68, 55, 0.3)",color:"#db4437",padding:"0.85rem 1rem",borderRadius:"10px",fontWeight:"500",fontSize:"0.9rem",transition:"all 0.2s ease",minHeight:"45px"},children:[(0,x.jsx)("i",{className:"fab fa-google",style:{fontSize:"1.1rem",marginRight:"8px"}}),"Google"]})}),(0,x.jsx)("div",{className:"col-6",children:(0,x.jsxs)("button",{type:"button",onClick:()=>j("facebook"),disabled:i,className:"btn w-100 social-btn d-flex align-items-center justify-content-center",style:{background:"rgba(66, 103, 178, 0.1)",border:"1px solid rgba(66, 103, 178, 0.3)",color:"#4267B2",padding:"0.85rem 1rem",borderRadius:"10px",fontWeight:"500",fontSize:"0.9rem",transition:"all 0.2s ease",minHeight:"45px"},children:[(0,x.jsx)("i",{className:"fab fa-facebook-f",style:{fontSize:"1.1rem",marginRight:"8px"}}),"Facebook"]})})]}),(0,x.jsxs)("div",{className:"row g-3",children:[(0,x.jsx)("div",{className:"col-6",children:(0,x.jsxs)("button",{type:"button",onClick:()=>j("github"),disabled:i,className:"btn w-100 social-btn d-flex align-items-center justify-content-center",style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.3)",color:"#ffffff",padding:"0.85rem 1rem",borderRadius:"10px",fontWeight:"500",fontSize:"0.9rem",transition:"all 0.2s ease",minHeight:"45px"},children:[(0,x.jsx)("i",{className:"fab fa-github",style:{fontSize:"1.1rem",marginRight:"8px"}}),"GitHub"]})}),(0,x.jsx)("div",{className:"col-6",children:(0,x.jsxs)("button",{type:"button",onClick:()=>j("linkedin"),disabled:i,className:"btn w-100 social-btn d-flex align-items-center justify-content-center",style:{background:"rgba(0, 119, 181, 0.1)",border:"1px solid rgba(0, 119, 181, 0.3)",color:"#0077B5",padding:"0.85rem 1rem",borderRadius:"10px",fontWeight:"500",fontSize:"0.9rem",transition:"all 0.2s ease",minHeight:"45px"},children:[(0,x.jsx)("i",{className:"fab fa-linkedin-in",style:{fontSize:"1.1rem",marginRight:"8px"}}),"LinkedIn"]})})]})]}),(0,x.jsxs)("div",{className:"d-flex align-items-center my-5",children:[(0,x.jsx)("hr",{style:{flex:1,border:"none",height:"1px",background:"linear-gradient(to right, transparent, rgba(255, 255, 255, 0.2), transparent)"}}),(0,x.jsx)("span",{className:"px-4",style:{color:"#b0b0b0",fontSize:"0.85rem",fontWeight:"400",letterSpacing:"0.5px",whiteSpace:"nowrap"},children:"or continue with email"}),(0,x.jsx)("hr",{style:{flex:1,border:"none",height:"1px",background:"linear-gradient(to left, transparent, rgba(255, 255, 255, 0.2), transparent)"}})]})]}),(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{style:{color:"#e0e0e0",fontWeight:"500"},children:"User Name"}),(0,x.jsx)(O.A.Control,{type:"username",name:"username",value:m.username,onChange:b,required:!0,placeholder:"Enter your username",style:p,className:"form-control-lg"})]}),(0,x.jsxs)(O.A.Group,{className:"mb-4",children:[(0,x.jsx)(O.A.Label,{style:{color:"#e0e0e0",fontWeight:"500"},children:"Password"}),(0,x.jsx)(O.A.Control,{type:"password",name:"password",value:m.password,onChange:b,required:!0,placeholder:"Enter your password",style:p,className:"form-control-lg"})]}),(0,x.jsxs)("div",{className:"d-flex justify-content-between align-items-center gap-3",children:[(0,x.jsx)("button",{type:"button",className:"btn btn-outline-light",onClick:s,disabled:i,style:{padding:"0.75rem 2rem",borderRadius:"8px",fontWeight:"500",flex:1},children:"Cancel"}),(0,x.jsx)("button",{type:"submit",disabled:i,style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",color:"white",padding:"0.75rem 2rem",borderRadius:"8px",fontWeight:"bold",fontSize:"1.05rem",flex:2,boxShadow:"0 4px 15px rgba(102, 126, 234, 0.4)"},className:"btn",children:i?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("i",{className:"fas fa-spinner fa-spin me-2"}),"Signing In..."]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("i",{className:"fas fa-sign-in-alt me-2"}),"Sign In"]})})]}),(0,x.jsxs)("div",{className:"text-center mt-4",children:[(0,x.jsx)("span",{style:{color:"#888"},children:"Don't have an account? "}),(0,x.jsx)("button",{type:"button",onClick:y,style:{background:"none",border:"none",color:"#667eea",textDecoration:"underline",cursor:"pointer"},children:"Sign up here"})]})]}):(0,x.jsxs)(O.A,{onSubmit:async e=>{if(e.preventDefault(),d(""),u.password===u.confirmPassword)if(u.password.length<6)d("Password must be at least 6 characters long.");else{o(!0);try{const e=`${u.firstName} ${u.lastName}`;try{const s={username:u.username,email:u.email,password:u.password,name:e,full_name:e},t=await z(s),n=oe(t);a(n)}catch(e){console.error("Registration failed:",e),d(e.response?.data?.detail||"Failed to create account. Email or username may already be taken.")}finally{o(!1)}s(),g({firstName:"",lastName:"",username:"",email:"",password:"",confirmPassword:"",agreeToTerms:!1})}catch(e){d("Failed to create account. Please try again.")}finally{o(!1)}}else d("Passwords do not match.")},children:[(0,x.jsxs)("div",{className:"alert mb-4",style:{background:"rgba(102, 126, 234, 0.1)",border:"1px solid rgba(102, 126, 234, 0.3)",borderRadius:"8px",color:"#a8b3ff"},children:[(0,x.jsx)("i",{className:"fas fa-rocket me-2"}),"Join thousands of creators earning from their designs on CURFD."]}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsx)("div",{className:"text-center mb-4",children:(0,x.jsx)("div",{style:{color:"#b0b0b0",fontSize:"0.9rem",fontWeight:"400",letterSpacing:"0.5px"},children:"Quick signup with your social account"})}),(0,x.jsxs)("div",{className:"d-flex flex-column gap-3",children:[(0,x.jsxs)("div",{className:"row g-3",children:[(0,x.jsx)("div",{className:"col-6",children:(0,x.jsxs)("button",{type:"button",onClick:()=>j("google"),disabled:i,className:"btn w-100 social-btn d-flex align-items-center justify-content-center",style:{background:"rgba(219, 68, 55, 0.1)",border:"1px solid rgba(219, 68, 55, 0.3)",color:"#db4437",padding:"0.85rem 1rem",borderRadius:"10px",fontWeight:"500",fontSize:"0.9rem",transition:"all 0.2s ease",minHeight:"45px"},children:[(0,x.jsx)("i",{className:"fab fa-google",style:{fontSize:"1.1rem",marginRight:"8px"}}),"Google"]})}),(0,x.jsx)("div",{className:"col-6",children:(0,x.jsxs)("button",{type:"button",onClick:()=>j("facebook"),disabled:i,className:"btn w-100 social-btn d-flex align-items-center justify-content-center",style:{background:"rgba(66, 103, 178, 0.1)",border:"1px solid rgba(66, 103, 178, 0.3)",color:"#4267B2",padding:"0.85rem 1rem",borderRadius:"10px",fontWeight:"500",fontSize:"0.9rem",transition:"all 0.2s ease",minHeight:"45px"},children:[(0,x.jsx)("i",{className:"fab fa-facebook-f",style:{fontSize:"1.1rem",marginRight:"8px"}}),"Facebook"]})})]}),(0,x.jsxs)("div",{className:"row g-3",children:[(0,x.jsx)("div",{className:"col-6",children:(0,x.jsxs)("button",{type:"button",onClick:()=>j("github"),disabled:i,className:"btn w-100 social-btn d-flex align-items-center justify-content-center",style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.3)",color:"#ffffff",padding:"0.85rem 1rem",borderRadius:"10px",fontWeight:"500",fontSize:"0.9rem",transition:"all 0.2s ease",minHeight:"45px"},children:[(0,x.jsx)("i",{className:"fab fa-github",style:{fontSize:"1.1rem",marginRight:"8px"}}),"GitHub"]})}),(0,x.jsx)("div",{className:"col-6",children:(0,x.jsxs)("button",{type:"button",onClick:()=>j("linkedin"),disabled:i,className:"btn w-100 social-btn d-flex align-items-center justify-content-center",style:{background:"rgba(0, 119, 181, 0.1)",border:"1px solid rgba(0, 119, 181, 0.3)",color:"#0077B5",padding:"0.85rem 1rem",borderRadius:"10px",fontWeight:"500",fontSize:"0.9rem",transition:"all 0.2s ease",minHeight:"45px"},children:[(0,x.jsx)("i",{className:"fab fa-linkedin-in",style:{fontSize:"1.1rem",marginRight:"8px"}}),"LinkedIn"]})})]})]}),(0,x.jsxs)("div",{className:"d-flex align-items-center my-5",children:[(0,x.jsx)("hr",{style:{flex:1,border:"none",height:"1px",background:"linear-gradient(to right, transparent, rgba(255, 255, 255, 0.2), transparent)"}}),(0,x.jsx)("span",{className:"px-4",style:{color:"#b0b0b0",fontSize:"0.85rem",fontWeight:"400",letterSpacing:"0.5px",whiteSpace:"nowrap"},children:"or create account with email"}),(0,x.jsx)("hr",{style:{flex:1,border:"none",height:"1px",background:"linear-gradient(to left, transparent, rgba(255, 255, 255, 0.2), transparent)"}})]})]}),(0,x.jsxs)("div",{className:"row",children:[(0,x.jsx)("div",{className:"col-md-6",children:(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{style:{color:"#e0e0e0",fontWeight:"500"},children:"First Name"}),(0,x.jsx)(O.A.Control,{type:"text",name:"firstName",value:u.firstName,onChange:f,required:!0,placeholder:"First name",style:p})]})}),(0,x.jsx)("div",{className:"col-md-6",children:(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{style:{color:"#e0e0e0",fontWeight:"500"},children:"Last Name"}),(0,x.jsx)(O.A.Control,{type:"text",name:"lastName",value:u.lastName,onChange:f,required:!0,placeholder:"Last name",style:p})]})})]}),(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{style:{color:"#e0e0e0",fontWeight:"500"},children:"Username"}),(0,x.jsx)(O.A.Control,{type:"text",name:"username",value:u.username,onChange:f,required:!0,placeholder:"Choose a username",style:p})]}),(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{style:{color:"#e0e0e0",fontWeight:"500"},children:"Email Address"}),(0,x.jsx)(O.A.Control,{type:"email",name:"email",value:u.email,onChange:f,required:!0,placeholder:"Enter your email",style:p})]}),(0,x.jsxs)("div",{className:"row",children:[(0,x.jsx)("div",{className:"col-md-6",children:(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{style:{color:"#e0e0e0",fontWeight:"500"},children:"Password"}),(0,x.jsx)(O.A.Control,{type:"password",name:"password",value:u.password,onChange:f,required:!0,placeholder:"Create password",style:p})]})}),(0,x.jsx)("div",{className:"col-md-6",children:(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{style:{color:"#e0e0e0",fontWeight:"500"},children:"Confirm Password"}),(0,x.jsx)(O.A.Control,{type:"password",name:"confirmPassword",value:u.confirmPassword,onChange:f,required:!0,placeholder:"Confirm password",style:p})]})})]}),(0,x.jsx)(O.A.Group,{className:"mb-4",children:(0,x.jsx)(O.A.Check,{type:"checkbox",name:"agreeToTerms",checked:u.agreeToTerms,onChange:f,required:!0,label:(0,x.jsxs)("span",{style:{color:"#e0e0e0"},children:["I agree to the ",(0,x.jsx)("span",{style:{color:"#667eea",textDecoration:"underline",cursor:"pointer"},children:"Terms of Service"})," and ",(0,x.jsx)("span",{style:{color:"#667eea",textDecoration:"underline",cursor:"pointer"},children:"Privacy Policy"})]})})}),(0,x.jsxs)("div",{className:"d-flex justify-content-between align-items-center gap-3",children:[(0,x.jsx)("button",{type:"button",className:"btn btn-outline-light",onClick:s,disabled:i,style:{padding:"0.75rem 2rem",borderRadius:"8px",fontWeight:"500",flex:1},children:"Cancel"}),(0,x.jsx)("button",{type:"submit",disabled:i,style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",color:"white",padding:"0.75rem 2rem",borderRadius:"8px",fontWeight:"bold",fontSize:"1.05rem",flex:2,boxShadow:"0 4px 15px rgba(102, 126, 234, 0.4)"},className:"btn",children:i?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("i",{className:"fas fa-spinner fa-spin me-2"}),"Creating Account..."]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("i",{className:"fas fa-user-plus me-2"}),"Create Account"]})})]}),(0,x.jsxs)("div",{className:"text-center mt-4",children:[(0,x.jsx)("span",{style:{color:"#888"},children:"Already have an account? "}),(0,x.jsx)("button",{type:"button",onClick:y,style:{background:"none",border:"none",color:"#667eea",textDecoration:"underline",cursor:"pointer"},children:"Sign in here"})]})]})]})]}),(0,x.jsx)("style",{children:"\n          .social-btn {\n            position: relative;\n            overflow: hidden;\n          }\n          \n          .social-btn:hover:not(:disabled) {\n            transform: translateY(-2px);\n            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);\n          }\n          \n          .social-btn:hover:not(:disabled):before {\n            content: '';\n            position: absolute;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            background: rgba(255, 255, 255, 0.1);\n            pointer-events: none;\n          }\n          \n          .social-btn:active:not(:disabled) {\n            transform: translateY(0);\n            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);\n          }\n          \n          .social-btn:disabled {\n            opacity: 0.6;\n            cursor: not-allowed;\n          }\n          \n          .social-btn i {\n            transition: transform 0.2s ease;\n          }\n          \n          .social-btn:hover:not(:disabled) i {\n            transform: scale(1.1);\n          }\n        "})]})},de=({onUploadModel:e,onResetView:s,onToggleGrid:a,onAutoRotate:t,onScreenshot:n,gridVisible:r,autoRotateEnabled:l})=>{const i=e=>{const s="btn rounded-pill mx-1 border-0";return e?`${s} btn-primary text-white`:`${s} btn-outline-secondary text-white`};return(0,x.jsxs)("div",{className:"bg-light bg-opacity-75 rounded-pill p-2 border border-secondary d-flex",children:[(0,x.jsxs)("button",{className:i(r),onClick:a,children:[(0,x.jsx)("i",{className:"fas fa-th me-2"}),"Grid"]}),(0,x.jsxs)("button",{className:i(l),onClick:t,children:[(0,x.jsx)("i",{className:"fas fa-sync-alt me-2"}),"Auto Rotate"]}),(0,x.jsxs)("button",{className:i(!1),onClick:s,children:[(0,x.jsx)("i",{className:"fas fa-refresh me-2"}),"Reset View"]}),(0,x.jsxs)("button",{className:i(!1),onClick:e,children:[(0,x.jsx)("i",{className:"fas fa-upload me-2"}),"Upload"]}),(0,x.jsxs)("button",{className:i(!1),onClick:n,children:[(0,x.jsx)("i",{className:"fas fa-camera me-2"}),"Screenshot"]})]})};async function me(e,s,a="gpt-4-turbo",t){return t?.apiUrl||{REACT_APP_STRIPE_PUBLISHABLE_KEY:void 0,REACT_APP_API_URL:void 0}.REACT_APP_AI_API_URL?async function(e,s,a,t){const n=t?.apiUrl||{REACT_APP_STRIPE_PUBLISHABLE_KEY:void 0,REACT_APP_API_URL:void 0}.REACT_APP_AI_API_URL;if(!n)return"[API URL not configured]";try{if(s){const t=new FormData;t.append("message",e),t.append("file",s),a&&t.append("model",a);const r=await fetch(n,{method:"POST",body:t});if(!r.ok)throw new Error(`API returned ${r.status}`);const l=await r.json();return l?.reply||JSON.stringify(l)}const t=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,model:a})});if(!t.ok)throw new Error(`API returned ${t.status}`);const r=await t.json();return r?.reply||JSON.stringify(r)}catch(e){return console.error("API error:",e),`[API error] ${e?.message||String(e)}`}}(e,s,a,t):a.startsWith("gpt-")?async function(e,s,a="gpt-4-turbo",t){const n=t?.apiKey||{REACT_APP_STRIPE_PUBLISHABLE_KEY:void 0,REACT_APP_API_URL:void 0}.REACT_APP_OPENAI_API_KEY;if(!n)return"[OpenAI API key not configured]";try{let t=[{role:"user",content:e}];if(s){const a=await new Promise(e=>{const a=new FileReader;a.onload=()=>e(a.result),a.readAsDataURL(s)});t=[{role:"system",content:"The user is uploading a 3D model file for analysis."},{role:"user",content:`Analyzing file: ${s.name}\nBase64 data: ${a}\n\nUser message: ${e}`}]}const r=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({model:a,messages:t,temperature:.7})});if(!r.ok)throw new Error(`OpenAI API returned ${r.status}`);const l=await r.json();return l.choices?.[0]?.message?.content||JSON.stringify(l)}catch(e){return console.error("OpenAI API error:",e),`[OpenAI error] ${e?.message||String(e)}`}}(e,s,a,t):a.startsWith("claude-")?async function(e,s,a="claude-3-opus-20240229",t){const n=t?.apiKey||{REACT_APP_STRIPE_PUBLISHABLE_KEY:void 0,REACT_APP_API_URL:void 0}.REACT_APP_ANTHROPIC_API_KEY;if(!n)return"[Claude API key not configured]";try{let t=[{role:"user",content:e}];if(s){const a=await new Promise(e=>{const a=new FileReader;a.onload=()=>e(a.result),a.readAsDataURL(s)});t=[{role:"system",content:"You are analyzing 3D model files for CFD simulation."},{role:"user",content:`File: ${s.name}\nData: ${a}\n\nQuery: ${e}`}]}const r=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":n,"anthropic-version":"2023-06-01"},body:JSON.stringify({model:a,messages:t,max_tokens:1024})});if(!r.ok)throw new Error(`Claude API returned ${r.status}`);const l=await r.json();return l.content?.[0]?.text||JSON.stringify(l)}catch(e){return console.error("Claude API error:",e),`[Claude error] ${e?.message||String(e)}`}}(e,s,a,t):"gemini-pro"===a?async function(e,s,a){const t=a?.apiKey||{REACT_APP_STRIPE_PUBLISHABLE_KEY:void 0,REACT_APP_API_URL:void 0}.REACT_APP_GEMINI_API_KEY;if(!t)return"[Gemini API key not configured]";try{const a=[{text:e}];if(s){const e=await new Promise(e=>{const a=new FileReader;a.onload=()=>e(a.result),a.readAsDataURL(s)});a.push({inlineData:{mimeType:s.type,data:e.split(",")[1]}})}const n=await fetch(`https://generativelanguage.googleapis.com/v1/models/gemini-pro:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:a}]})});if(!n.ok)throw new Error(`Gemini API returned ${n.status}`);const r=await n.json();return r.candidates?.[0]?.content?.parts?.[0]?.text||JSON.stringify(r)}catch(e){return console.error("Gemini API error:",e),`[Gemini error] ${e?.message||String(e)}`}}(e,s,t):"openfoam"===a?"[OpenFOAM integration not yet implemented]":`[Unknown model: ${a}] Please configure an AI provider`}a(3110),a(94);const he=()=>{(0,r.Zp)();const e=(0,r.zy)(),{user:s}=B(),a=(()=>{try{const e=localStorage.getItem("curfd-app-state"),s=localStorage.getItem("curfd-has-uploaded-file"),a=localStorage.getItem("curfd-user-data");if(e){const t=JSON.parse(e);return{state:{leftDockExpanded:!1,isTyping:!1,chatMessages:[{type:"ai",content:"Hello! I'm CURFD AI. Upload a 3D model to begin CFD analysis.",time:(new Date).toLocaleTimeString()}],selectedAiModel:"gpt-4-turbo",uploadedFiles:[],status:"Ready for analysis",gridVisible:!0,autoRotateEnabled:!1,view:"main",...t},hasFile:!!s&&JSON.parse(s),user:a?JSON.parse(a):null}}}catch(e){console.warn("Failed to load state from localStorage:",e)}return{state:{leftDockExpanded:!1,isTyping:!1,chatMessages:[{type:"ai",content:"Hello! I'm CURFD AI. Upload a 3D model to begin CFD analysis.",time:(new Date).toLocaleTimeString()}],selectedAiModel:"gpt-4-turbo",uploadedFiles:[],status:"Ready for analysis",gridVisible:!0,autoRotateEnabled:!1,view:"main"},hasFile:!1,user:null}})(),[n,l]=(0,t.useState)(a.state),[i,o]=(0,t.useState)(!1),[c,d]=(0,t.useState)(!1),[m,h]=(0,t.useState)(!1),[u,g]=(0,t.useState)(!1),[p,b]=(0,t.useState)([]),[f,v]=(0,t.useState)(a.user),[w,S]=(0,t.useState)("header"),[k,A]=(0,t.useState)(a.hasFile),[C,P]=(0,t.useState)(0),[F,R]=(0,t.useState)("store"===a.state.view&&a.hasFile),[D,I]=(0,t.useState)(new Set),[E,z]=(0,t.useState)(()=>{try{const e=localStorage.getItem("chatbot-minimized");return null===e||JSON.parse(e)}catch{return!0}}),L=(0,t.useRef)(null),U=(0,t.useRef)(null),$=(0,t.useRef)(null),{subtotal:M,tax:_,total:O}=(0,t.useMemo)(()=>{const e=p.reduce((e,s)=>e+s.price*s.quantity,0),s=.08*e;return{subtotal:e,tax:s,total:e+s}},[p]);console.log("🔍 Initial app state:",{hasUploadedFile:k,uploadedFilesCount:n.uploadedFiles.length,uploadedFiles:n.uploadedFiles,cartItems:p.length}),console.log(`🔄 MainPageApp Render: Total=${O.toFixed(2)}, Subtotal=${M.toFixed(2)}, Items=${p.length}`);const W=e=>{l(s=>({...s,...e}))};(0,t.useEffect)(()=>{try{localStorage.setItem("chatbot-minimized",JSON.stringify(E))}catch(e){console.warn("Could not save chatbot state:",e)}},[E]);(0,t.useEffect)(()=>{(()=>{const e=n.uploadedFiles.length>0;k!==e&&(console.log("🔄 Syncing file state: hasUploadedFile:",k,"→",e),A(e),e||(console.log("🗑️ No files detected, clearing listed designs"),I(new Set)))})()},[n.uploadedFiles]),(0,t.useEffect)(()=>{},[n.view]),(0,t.useEffect)(()=>{((e,s,a)=>{try{const t={...e,chatMessages:e.chatMessages.slice(-5)};localStorage.setItem("curfd-app-state",JSON.stringify(t)),localStorage.setItem("curfd-has-uploaded-file",JSON.stringify(s)),a?localStorage.setItem("curfd-user-data",JSON.stringify(a)):localStorage.removeItem("curfd-user-data")}catch(e){console.warn("Failed to save state to localStorage:",e)}})(n,k,f)},[n,k,f]),(0,t.useEffect)(()=>{if("store"===e.state?.view&&e.state?.uploadedModel){if(console.log("📍 Navigated from upload form, switching to store view and loading model..."),W({view:"store"}),e.state.uploadedModel&&L.current){const s=e.state.uploadedModel;W({uploadedFiles:[s],status:`Loading ${s.name}...`}),A(!0),setTimeout(()=>{W({status:`${s.name} ready for viewing in store`})},1e3)}window.history.replaceState({},"",e.pathname)}},[e.state]),(0,t.useEffect)(()=>{const e=()=>{console.log("🎯 Dashboard triggered file upload"),G()},s=()=>{console.log("🏪 Dashboard triggered store view"),W({view:"store"})};return window.addEventListener("triggerFileUpload",e),window.addEventListener("switchToStore",s),()=>{window.removeEventListener("triggerFileUpload",e),window.removeEventListener("switchToStore",s)}},[]),(0,t.useEffect)(()=>{(async()=>{if(console.log("RestoreState - hasUploadedFile:",k,"view:",n.view,"uploadedFiles:",n.uploadedFiles),await new Promise(e=>setTimeout(e,1e3)),k&&n.uploadedFiles.length>0){const e=n.uploadedFiles[0];console.log("Attempting to restore file:",e.name,"in view:",n.view),"main"===n.view&&W({status:"Previous file detected. Use Upload page to restore file session."})}})()},[]),(0,t.useEffect)(()=>{if(console.log("View changed to:",n.view,"hasUploadedFile:",k),"main"===n.view&&k&&n.uploadedFiles.length>0){const e=n.uploadedFiles[0];console.log("In main view with file info:",e.name)}},[n.view]);const q=(e,s)=>{console.log(`Three action: ${e}`,s),L.current&&L.current[e]?L.current[e](s):console.warn(`Three action ${e} not available`)},G=()=>{console.log("Upload button clicked"),U.current&&U.current.click()};(0,t.useEffect)(()=>{const e=()=>{const e=window.innerHeight,s=.35*e+160+24,a=76+.6*(e-76-120-180),t=Math.max(s+80,a),n=e-120-180-20;P(Math.min(t,n))};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]);const H=()=>{console.log("🔍 Dashboard click DEBUG - AuthContext user:",s,"Local user:",f),console.log("🔍 User check result:",!(!s&&!f)),s||f?(console.log("✅ User authenticated - opening dashboard"),d(!0)):(console.log("❌ User not authenticated - showing login"),h(!0))},Y=()=>{if(console.log("🎯 Sell design clicked, checking conditions..."),f){const e=n.uploadedFiles[n.uploadedFiles.length-1],s=e?.name,a=k&&n.uploadedFiles.length>0&&s&&n.status.includes("ready");if(console.log("📊 File validation:",{hasUploadedFile:k,uploadedFilesCount:n.uploadedFiles.length,currentFileName:s,status:n.status,fileIsRendered:a}),a){if(s&&D.has(s))return void W({status:`❌ "${s}" has already been listed for sale. Upload a new design to list another.`});console.log("✅ Opening sell modal for file:",s),o(!0)}else W({status:"❌ Please upload and load a 3D design file first before listing it for sale."})}else S("sellDesign"),h(!0)},J=()=>{console.log("Processing checkout - AuthUser:",s,"Local User:",f,"Cart items:",p);const e=s||f;if(0===p.length)return console.log("Cart is empty"),void W({status:"Your cart is empty"});try{console.log("💳 Initiating Stripe checkout for total:",O.toFixed(2)),W({status:`Processing payment of $${O.toFixed(2)}... (Stripe integration will be added here)`});const s=((e,s,a,t,n)=>{const r=se(e),l={id:`purchase_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,items:[...s],total:a,subtotal:t,tax:n,purchaseDate:(new Date).toISOString(),userId:e,status:"completed"};return r.purchases.unshift(l),r.totalSpent+=a,te(r),console.log("Added purchase:",l),l})(e.id.toString(),p,O,M,_);console.log("Purchase completed:",s)}catch(e){console.error("Checkout error:",e),W({status:`Checkout failed: ${e.message}. Please try again.`})}};return(0,x.jsxs)("div",{className:"app vh-100 vw-100 p-0 m-0 bg-dark overflow-hidden",children:[(0,x.jsxs)("div",{className:"fixed-top d-flex align-items-center px-4 py-2",style:{zIndex:1050,background:"var(--chat-bg)",backdropFilter:"blur(20px)",borderBottom:"1px solid var(--chat-border)"},children:[(0,x.jsxs)("div",{className:"d-flex align-items-center gap-3",children:[(0,x.jsx)("img",{src:"/curfdlogo.png",alt:"CURFD",style:{height:"40px",filter:"brightness(1.2) contrast(1.1)"}}),(0,x.jsxs)("div",{className:"d-flex flex-column",children:[(0,x.jsx)("strong",{className:"text-white",style:{fontSize:"1.2rem"},children:"CURFD"}),(0,x.jsx)("small",{className:"text-white-50",children:"V3 - Advanced AI CFD Engine"})]})]}),(0,x.jsxs)("div",{className:"ms-auto d-flex align-items-center gap-3",children:[(0,x.jsx)("span",{className:"text-white-50",children:n.status}),f?(0,x.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,x.jsxs)("div",{className:"rounded-circle d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px",background:"linear-gradient(135deg, #667eea, #764ba2)",color:"white",fontWeight:"bold",fontSize:"0.9rem"},children:[f.firstName.charAt(0),f.lastName.charAt(0)]}),(0,x.jsxs)("div",{className:"d-flex flex-column",children:[(0,x.jsxs)("small",{className:"text-white",style:{fontSize:"0.8rem",lineHeight:1},children:[f.firstName," ",f.lastName]}),(0,x.jsx)("button",{onClick:()=>{v(null),W({status:"Logged out successfully."})},style:{background:"none",border:"none",color:"#667eea",fontSize:"0.7rem",padding:0,textDecoration:"underline",cursor:"pointer",lineHeight:1},children:"Logout"})]})]}):(0,x.jsx)("button",{onClick:()=>{S("header"),h(!0)},style:{background:"linear-gradient(135deg, #667eea, #764ba2)",border:"none",color:"white",fontSize:"0.9rem",padding:"8px 16px",borderRadius:"20px",cursor:"pointer",fontWeight:"500",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(102, 126, 234, 0.4)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},children:"Login"})]})]}),(0,x.jsx)("div",{className:"position-fixed inset-0 w-100 h-100",style:{top:"60px",opacity:"main"===n.view?1:0,pointerEvents:"main"===n.view?"auto":"none",zIndex:"main"===n.view?1:-1},children:(0,x.jsx)(j,{ref:L,onStateUpdate:W,appState:n})}),"store"===n.view&&(0,x.jsx)(Z,{onBack:()=>W({view:"main"}),cartItems:p,onAddToCart:e=>{b(s=>{if(s.find(s=>s.id===e.id))return s.map(s=>s.id===e.id?{...s,quantity:s.quantity+1}:s);{const a={id:e.id,name:e.name,price:Number(e.price),originalPrice:e.originalPrice?Number(e.originalPrice):void 0,size:e.size||"0 MB",color:e.color,icon:e.icon,quantity:1};return[...s,a]}})},onShowCart:()=>g(!0),onViewItem:e=>{console.log("Viewing item:",e),W({view:"main",status:`Previewing ${e.name} - ${e.description||"Premium 3D design"}`}),setTimeout(()=>{W({status:`${e.name} loaded successfully! This is a preview - purchase to download the full model.`})},1e3)}}),E?(0,x.jsx)("div",{className:"position-fixed",style:{bottom:"20px",right:"16px",width:"60px",height:"60px",backgroundColor:"#667eea",borderRadius:"50%",cursor:"pointer",zIndex:1060,display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>z(!1),title:"Open AI Assistant",children:(0,x.jsx)("i",{className:"fas fa-comments text-white",style:{fontSize:"20px"}})}):(0,x.jsx)("div",{ref:$,className:"position-fixed",style:{top:"120px",right:"16px",bottom:"20px",width:"min(400px, calc(100vw - 32px))",maxHeight:"calc(100vh - 180px)",minHeight:"400px",zIndex:1050},children:(0,x.jsx)(N,{onSendMessage:async(e,s)=>{const a={type:"user",content:e||(s?`Uploaded ${s.name}`:""),time:(new Date).toLocaleTimeString()};if(W({chatMessages:[...n.chatMessages,a],isTyping:!0}),s){q("loadFile",s),A(!0),console.log("🔄 New file uploaded via chat, resetting listed designs state"),I(new Set);const e={name:s.name,size:`${(s.size/1048576).toFixed(1)} MB`,color:"#4CAF50",icon:"fas fa-cube"};W({status:`Loading ${s.name}...`,uploadedFiles:[e]}),setTimeout(()=>{W({status:`${s.name} loaded - Analysis ready`}),A(!0)},1e3)}q("processMessage",{message:e,file:s});let t="";try{t=await me(e,s,n.selectedAiModel)}catch(e){t=`[AI error] ${e?.message||String(e)}`}const r={type:"ai",content:t,time:(new Date).toLocaleTimeString()};W({chatMessages:[...n.chatMessages,a,r],isTyping:!1})},selectedModel:n.selectedAiModel,onModelChange:e=>W({selectedAiModel:e}),onMinimize:()=>z(!0)})}),(0,x.jsx)(y,{visible:k&&"main"===n.view&&!c&&!i&&!m&&!u,onClose:()=>{},placement:{top:C,left:0}}),(0,x.jsx)("div",{className:"fab-container",children:"main"===n.view?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("button",{className:"fab-button",onClick:()=>W({view:"store"}),children:"Store"}),(0,x.jsx)("button",{className:"fab-button "+(n.gridVisible?"active":""),onClick:()=>{const e=!n.gridVisible;W({gridVisible:e}),q("toggleGrid")},children:"Grid"}),(0,x.jsx)("button",{className:"fab-button "+(n.autoRotateEnabled?"active":""),onClick:()=>{const e=!n.autoRotateEnabled;W({autoRotateEnabled:e}),q("toggleAutoRotate")},children:"Auto Rotate"}),(0,x.jsx)("button",{className:"fab-button",onClick:()=>{console.log("Reset view called"),q("resetCamera")},children:"Reset View"}),(0,x.jsx)("button",{className:"fab-button",onClick:()=>U.current?.click(),children:"Upload"}),(0,x.jsx)("button",{className:"fab-button",onClick:()=>q("takeScreenshot"),children:"Screenshot"}),f&&(()=>{const e=n.uploadedFiles[n.uploadedFiles.length-1],s=e?.name,a=k&&n.uploadedFiles.length>0&&!!s&&n.status.includes("ready"),t=s&&D.has(s);return console.log("🎯 Sell button state:",{hasUploadedFile:k,uploadedFilesCount:n.uploadedFiles.length,currentFileName:s,status:n.status,hasValidFile:a,isListed:t}),(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("button",{className:"fab-button",onClick:H,style:{minWidth:"100px",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",whiteSpace:"nowrap"},children:(0,x.jsx)("span",{children:"Dashboard"})}),(0,x.jsxs)("button",{className:"fab-button",onClick:Y,disabled:!(a&&!t),style:{minWidth:"120px",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.3rem",whiteSpace:"nowrap",background:t?"linear-gradient(135deg, #9CA3AF 0%, #6B7280 100%)":a?"linear-gradient(135deg, #10B981 0%, #059669 100%)":void 0,border:t?"2px solid #9CA3AF":a?"2px solid #10B981":void 0,boxShadow:a&&!t?"0 0 15px rgba(16, 185, 129, 0.5)":void 0,transform:a&&!t?"scale(1.02)":void 0,opacity:t?.6:a?1:.5,cursor:!a||t?"not-allowed":"pointer"},title:t?`"${s}" is already listed for sale`:a?`Sell "${s}"`:"Upload a design file first to enable selling",children:[(0,x.jsx)("span",{style:{color:"#FFD700",fontSize:"1.1rem",fontWeight:"bold"},children:t?"✓":"$"}),(0,x.jsx)("span",{children:t?"Listed":"Sell Design"})]})]})})(),!f&&(()=>{const e=n.uploadedFiles[n.uploadedFiles.length-1],s=e?.name,a=k&&n.uploadedFiles.length>0&&!!s&&n.status.includes("ready");return console.log("🎯 Non-user sell button state:",{hasUploadedFile:k,uploadedFilesCount:n.uploadedFiles.length,currentFileName:s,status:n.status,hasValidFile:a}),a&&(0,x.jsxs)("button",{className:"fab-button",onClick:Y,style:{minWidth:"120px",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.3rem",whiteSpace:"nowrap",background:"linear-gradient(135deg, #10B981 0%, #059669 100%)",border:"2px solid #10B981",boxShadow:"0 0 15px rgba(16, 185, 129, 0.5)",transform:"scale(1.02)"},title:`Sell "${s}" (Login required)`,children:[(0,x.jsx)("span",{style:{color:"#FFD700",fontSize:"1.1rem",fontWeight:"bold"},children:"$"}),(0,x.jsx)("span",{children:"Sell Design"})]})})()]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("button",{className:"fab-button",onClick:()=>W({view:"main"}),children:[(0,x.jsx)("i",{className:"fas fa-arrow-left me-2"}),"Back"]}),(0,x.jsxs)("button",{className:"fab-button",onClick:()=>console.log("Sort by price"),children:[(0,x.jsx)("i",{className:"fas fa-sort-amount-down me-2"}),"Sort by Price"]}),(0,x.jsxs)("button",{className:"fab-button",onClick:()=>console.log("Filter"),children:[(0,x.jsx)("i",{className:"fas fa-filter me-2"}),"Filter"]}),(0,x.jsxs)("button",{className:"fab-button",onClick:()=>g(!0),style:{position:"relative"},children:[(0,x.jsx)("i",{className:"fas fa-shopping-cart me-2"}),"Cart",p.length>0&&(0,x.jsx)("span",{className:"position-absolute top-0 start-100 translate-middle badge rounded-pill",style:{background:"#dc3545",fontSize:"0.7rem",minWidth:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center"},children:p.reduce((e,s)=>e+s.quantity,0)})]})]})}),(0,x.jsx)("input",{ref:U,type:"file",className:"d-none",accept:".stl,.obj,.step,.stp,.iges,.glb",onChange:e=>{if(console.log("📁 File input changed",e.target.files),e.target.files?.[0]){const s=e.target.files[0];console.log("📂 Selected file:",{name:s.name,size:s.size,type:s.type}),q("loadFile",s),A(!0),console.log("🔄 New file uploaded, resetting listed designs state"),I(new Set);const a={name:s.name,size:`${(s.size/1048576).toFixed(1)} MB`,color:"#4CAF50",icon:"fas fa-cube"};W({status:`Loading ${s.name}...`,uploadedFiles:[a]}),console.log("📊 Updated app state with file:",a),setTimeout(()=>{W({status:`${s.name} loaded - Analysis ready`}),console.log("✅ File load complete, app state:",{uploadedFiles:[a],hasUploadedFile:!0,status:`${s.name} loaded - Analysis ready`}),A(!0)},1e3),e.target.value=""}}}),"main"===n.view&&(0,x.jsxs)("div",{className:"position-fixed start-0 ms-4 rounded chat-container",style:{zIndex:1040,top:"35%",transform:"translateY(-50%)",padding:"1.5rem",background:"rgba(0, 0, 0, 0.8)",backdropFilter:"blur(12px)",border:"1px solid rgba(255, 255, 255, 0.15)"},children:[(0,x.jsxs)("div",{className:"d-flex align-items-center gap-3",children:[(0,x.jsxs)("div",{className:"d-flex flex-column justify-content-between",style:{height:"260px"},children:[(0,x.jsx)("div",{className:"text-white-50",style:{fontSize:"0.75rem",textAlign:"right"},children:"100 kPa"}),(0,x.jsx)("div",{className:"text-white-50",style:{fontSize:"0.75rem",textAlign:"right"},children:"75"}),(0,x.jsx)("div",{className:"text-white-50",style:{fontSize:"0.75rem",textAlign:"right"},children:"50"}),(0,x.jsx)("div",{className:"text-white-50",style:{fontSize:"0.75rem",textAlign:"right"},children:"25"}),(0,x.jsx)("div",{className:"text-white-50",style:{fontSize:"0.75rem",textAlign:"right"},children:"0 kPa"})]}),(0,x.jsxs)("div",{className:"d-flex flex-column align-items-center gap-2",children:[(0,x.jsx)("div",{className:"text-white small mb-1 fw-bold",children:"High"}),(0,x.jsxs)("div",{style:{width:"32px",height:"220px",background:"linear-gradient(to bottom, #F44336, #FFC107, #4CAF50)",borderRadius:"14px",boxShadow:"0 6px 20px rgba(0,0,0,0.4) inset, 0 4px 12px rgba(0,0,0,0.3)",border:"2px solid rgba(255,255,255,0.08)",position:"relative"},children:[(0,x.jsx)("div",{style:{position:"absolute",left:"-8px",top:"0",width:"8px",height:"1px",background:"rgba(255,255,255,0.3)"}}),(0,x.jsx)("div",{style:{position:"absolute",left:"-8px",top:"25%",width:"8px",height:"1px",background:"rgba(255,255,255,0.3)"}}),(0,x.jsx)("div",{style:{position:"absolute",left:"-8px",top:"50%",width:"8px",height:"1px",background:"rgba(255,255,255,0.3)"}}),(0,x.jsx)("div",{style:{position:"absolute",left:"-8px",top:"75%",width:"8px",height:"1px",background:"rgba(255,255,255,0.3)"}}),(0,x.jsx)("div",{style:{position:"absolute",left:"-8px",bottom:"0",width:"8px",height:"1px",background:"rgba(255,255,255,0.3)"}})]}),(0,x.jsx)("div",{className:"text-white small mt-1 fw-bold",children:"Low"})]})]}),(0,x.jsx)("div",{className:"text-white-50 small text-center mt-3",style:{width:"140px"},children:"Pressure Distribution"})]}),(0,x.jsx)(X,{show:i,onClose:()=>o(!1),onSubmit:async e=>{if(console.log("🚀 Starting sell design submission:",e),console.log("👤 Current user:",f),console.log("📁 Current files:",n.uploadedFiles),!f)return void W({status:"❌ Error: User not authenticated."});const s=n.uploadedFiles[n.uploadedFiles.length-1];if(s)try{W({status:"⏳ Listing your design for sale..."});const a={...e,fileName:s.name,fileSize:s.size||"0 MB"};let t;console.log("📤 Sending to API:",a),console.log("🔗 Commerce API available:",!!T),console.log("🔗 Sell design method available:",!!T?.designs?.sellDesign);try{t=await T.designs.sellDesign(a),console.log("✅ Raw API Response:",t)}catch(s){console.error("🚨 API Error Details:",{message:s.message,response:s.response,status:s.response?.status,data:s.response?.data}),console.log("⚠️ API failed, creating mock success for testing..."),t={success:!0,designId:Date.now(),message:"Design listed successfully (mock response)",designName:e.designName}}console.log("✅ Final API Response:",t);const n=new Set([...D,s.name]);I(n),console.log("📝 Updated listed designs:",Array.from(n)),o(!1),W({status:`✅ "${e.designName}" listed successfully! Your design will be reviewed and published soon.`})}catch(e){console.error("❌ Error listing design:",e),console.error("❌ Error details:",{message:e.message,response:e.response?.data,status:e.response?.status}),W({status:`❌ Failed to list design: ${e.response?.data?.detail||e.message||"Unknown error"}. Please try again.`})}else W({status:"❌ Error: No file uploaded."})},uploadedFile:n.uploadedFiles.length>0?{...n.uploadedFiles[n.uploadedFiles.length-1],size:n.uploadedFiles[n.uploadedFiles.length-1].size||"Unknown size"}:void 0}),(0,x.jsx)(ie,{show:c,onClose:()=>d(!1),user:s||f}),(0,x.jsx)(ce,{show:m,onClose:()=>h(!1),onAuthSuccess:"header"===w?e=>{v(e),h(!1),W({status:`Welcome ${e.firstName}! Logged in successfully.`})}:e=>{if(v(e),h(!1),W({status:`Welcome ${e.firstName}! You can now access your sales dashboard.`}),"sellDesign"===w)if(k&&n.uploadedFiles.length>0){const s=n.uploadedFiles[n.uploadedFiles.length-1],a=s?.name;a&&D.has(a)?W({status:`Welcome ${e.firstName}! Note: "${a}" has already been listed for sale.`}):setTimeout(()=>{o(!0)},500)}else W({status:`Welcome ${e.firstName}! Please upload a 3D design file first to list it for sale.`});else"checkout"===w&&(W({status:`Welcome ${e.firstName}! Proceeding with your purchase...`}),setTimeout(()=>{J()},500))},initialMode:"signup"}),(0,x.jsx)(Q,{show:u,onClose:()=>g(!1),cartItems:p,onUpdateQuantity:(e,s)=>{b(a=>a.map(a=>a.id===e?{...a,quantity:s}:a))},onRemoveItem:e=>{b(s=>s.filter(s=>s.id!==e))},onCheckout:()=>{console.log("Checkout initiated - AuthUser:",s,"Local User:",f,"Cart items:",p);if(!(s||f))return console.log("User not authenticated, requiring login for checkout"),W({status:"Please log in to complete your purchase",view:"main"}),S("checkout"),h(!0),void g(!1);J()}})]})};var ue=a(1660),ge=a(9211),xe=a(9101),pe=a(6132);function be(e){return e.replace(/_([a-z])/g,(e,s)=>s.toUpperCase())}function fe(e,s){return Array.isArray(e)?e.map(e=>fe(e,s)):null!==e&&"object"==typeof e?Object.keys(e).reduce((a,t)=>(a[s(t)]=fe(e[t],s),a),{}):e}const je=({onModelSelect:e,onBackToMain:s})=>{const[a,n]=(0,t.useState)([]),[r,l]=(0,t.useState)(!0),[i,o]=(0,t.useState)("");(0,t.useEffect)(()=>{c()},[]);const c=async()=>{try{l(!0);const e=(await P()).map(e=>function(e){return fe(e,be)}(e));n(e)}catch(e){o("Failed to load models"),console.error("Error fetching models:",e)}finally{l(!1)}},d=e=>{switch(e){case"completed":return(0,x.jsx)(re.A,{bg:"success",children:"Completed"});case"in-progress":return(0,x.jsx)(re.A,{bg:"warning",children:"In Progress"});case"pending":default:return(0,x.jsx)(re.A,{bg:"secondary",children:"Pending"});case"error":return(0,x.jsx)(re.A,{bg:"danger",children:"Error"})}},m=e=>({stl:"fas fa-cube",obj:"fas fa-shapes",glb:"fas fa-cube",gltf:"fas fa-cube",step:"fas fa-project-diagram",stp:"fas fa-project-diagram"}[e]||"fas fa-file"),h=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never";return r?(0,x.jsx)("div",{className:"bg-light min-vh-100 text-white",children:(0,x.jsx)(ue.A,{className:"py-4",children:(0,x.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{height:"50vh"},children:(0,x.jsxs)("div",{className:"text-center",children:[(0,x.jsx)(q.A,{animation:"border",role:"status",className:"mb-3",children:(0,x.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,x.jsx)("p",{children:"Loading your models..."})]})})})}):i?(0,x.jsx)("div",{className:"bg-light min-vh-100 text-white",children:(0,x.jsx)(ue.A,{className:"py-4",children:(0,x.jsx)("div",{className:"alert alert-danger",role:"alert",children:i})})}):(0,x.jsx)("div",{className:"bg-light min-vh-100 text-white",children:(0,x.jsxs)(ue.A,{className:"py-4",children:[(0,x.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,x.jsxs)("div",{children:[(0,x.jsxs)("h1",{className:"h3 mb-1",children:[(0,x.jsx)("i",{className:"fas fa-folder-open text-primary me-2"}),"My Models"]}),(0,x.jsxs)("p",{className:"text-muted mb-0",children:[a.length," model",1!==a.length?"s":""," uploaded"]})]}),(0,x.jsxs)("button",{className:"btn btn-outline-primary",onClick:s,children:[(0,x.jsx)("i",{className:"fas fa-arrow-left me-2"}),"Back to Analysis"]})]}),(0,x.jsx)(ge.A,{children:a.map(s=>(0,x.jsx)(xe.A,{lg:4,md:6,className:"mb-4",children:(0,x.jsxs)(pe.A,{className:"h-100 bg-light border-secondary hover-shadow",children:[(0,x.jsxs)("div",{className:"position-relative",children:[s.thumbnail?(0,x.jsx)(pe.A.Img,{variant:"top",src:s.thumbnail,alt:`Thumbnail for ${s.name}`,style:{height:"200px",objectFit:"cover",borderTopLeftRadius:"0.375rem",borderTopRightRadius:"0.375rem"}}):(0,x.jsx)("div",{className:"bg-secondary bg-opacity-25 d-flex align-items-center justify-content-center",style:{height:"200px",borderTopLeftRadius:"0.375rem",borderTopRightRadius:"0.375rem"},children:(0,x.jsx)("i",{className:`${m(s.fileType)} text-primary`,style:{fontSize:"3rem"}})}),(0,x.jsx)("div",{className:"position-absolute top-0 end-0 m-2",children:d(s.analysisStatus)})]}),(0,x.jsxs)(pe.A.Body,{className:"d-flex flex-column",children:[(0,x.jsxs)("div",{className:"mb-2",children:[(0,x.jsx)("h6",{className:"card-title text-white mb-1",children:s.name}),(0,x.jsxs)("small",{className:"text-muted",children:[(0,x.jsx)("i",{className:`${m(s.fileType)} me-1`}),s.fileType.toUpperCase()," • ",s.fileSize]})]}),(0,x.jsxs)("div",{className:"mb-3",children:[s.tags.slice(0,3).map((e,s)=>(0,x.jsx)(re.A,{bg:"outline-secondary",text:"muted",className:"me-1 mb-1 border border-secondary",style:{fontSize:"0.7rem"},children:e},s)),s.tags.length>3&&(0,x.jsxs)(re.A,{bg:"outline-secondary",text:"muted",className:"border border-secondary",style:{fontSize:"0.7rem"},children:["+",s.tags.length-3]})]}),(0,x.jsx)("div",{className:"mt-auto",children:(0,x.jsxs)("div",{className:"d-flex justify-content-between text-muted small",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("i",{className:"fas fa-calendar me-1"}),h(s.createdAt)]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("i",{className:"fas fa-clock me-1"}),h(s.lastOpened)]})]})})]}),(0,x.jsx)(pe.A.Footer,{className:"bg-light border-secondary",children:(0,x.jsx)("div",{className:"d-grid gap-2",children:(0,x.jsxs)("button",{className:"btn btn-primary btn-sm",onClick:()=>e(s),children:[(0,x.jsx)("i",{className:"fas fa-wind me-2"}),"Analyze Model"]})})})]})},s.id))}),0===a.length&&(0,x.jsxs)("div",{className:"text-center py-5",children:[(0,x.jsx)("div",{className:"mb-4",children:(0,x.jsx)("i",{className:"fas fa-folder-open text-muted",style:{fontSize:"4rem"}})}),(0,x.jsx)("h4",{className:"text-muted mb-3",children:"No models uploaded yet"}),(0,x.jsx)("p",{className:"text-muted mb-4",children:"Upload your first 3D model to get started with CFD analysis."}),(0,x.jsxs)("button",{className:"btn btn-primary",onClick:s,children:[(0,x.jsx)("i",{className:"fas fa-upload me-2"}),"Upload First Model"]})]})]})})};a(7059),a(8323),a(2361),a(8377),a(6409);const ye="fluidSimulatorState",ve=e=>{try{const s={...Ne(),...e};localStorage.setItem(ye,JSON.stringify(s)),console.log("✅ App state saved:",s)}catch(e){console.error("❌ Failed to save app state:",e)}},Ne=()=>{try{const e=localStorage.getItem(ye);if(e){const s=JSON.parse(e);return console.log("✅ App state restored:",s),s}}catch(e){console.error("❌ Failed to restore app state:",e)}return{}},we="uploadSession",Se=async(e,s,a,t)=>{try{if(e.size>52428800)return console.warn("⚠️ File too large for persistence, skipping save"),"";const n=`upload_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,r=await(e=>new Promise((s,a)=>{const t=new FileReader;t.readAsDataURL(e),t.onload=()=>{const e=t.result;s(e.split(",")[1])},t.onerror=e=>a(e)}))(e),l={id:n,fileName:e.name,fileData:r,fileType:e.type,fileSize:e.size,formData:s,uploadProgress:a,uploadedModel:t,timestamp:Date.now()};return localStorage.setItem(we,JSON.stringify(l)),console.log("✅ Upload session saved:",{id:n,fileName:e.name,size:`${(e.size/1024/1024).toFixed(2)}MB`,progress:a}),ve({uploadSession:l}),n}catch(e){return console.error("❌ Failed to save upload session:",e),""}},ke=()=>{try{const e=localStorage.getItem(we);if(e){const s=JSON.parse(e),a=864e5;return Date.now()-s.timestamp>a?(console.warn("⚠️ Upload session expired, clearing"),Ce(),null):(console.log("✅ Upload session restored:",{id:s.id,fileName:s.fileName,size:`${(s.fileSize/1024/1024).toFixed(2)}MB`,age:`${Math.round((Date.now()-s.timestamp)/1e3/60)}min ago`}),s)}}catch(e){console.error("❌ Failed to restore upload session:",e),Ce()}return null},Ae=e=>{try{console.log("🔄 Restoring file from session:",{fileName:e.fileName,fileType:e.fileType,dataLength:e.fileData.length});const s=((e,s,a)=>{try{console.log("🔄 Converting base64 to file:",{fileName:s,fileType:a,base64Length:e.length});const t=atob(e),n=new Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);const r=new Uint8Array(n),l=new File([r],s,{type:a});return console.log("✅ File conversion successful:",{name:l.name,size:l.size,type:l.type}),l}catch(e){throw console.error("❌ Failed to convert base64 to file:",e),e}})(e.fileData,e.fileName,e.fileType);return console.log("✅ File restored successfully:",{name:s.name,size:s.size,type:s.type}),s}catch(e){return console.error("❌ Failed to restore file from session:",e),null}},Ce=()=>{try{localStorage.removeItem(we),console.log("✅ Upload session cleared");const e=Ne();e.uploadSession&&(delete e.uploadSession,ve(e))}catch(e){console.error("❌ Failed to clear upload session:",e)}},Pe=e=>{try{const s=ke();s&&(s.uploadProgress=e,localStorage.setItem(we,JSON.stringify(s)),console.log(`📈 Upload progress: ${e}%`))}catch(e){console.error("❌ Failed to update upload progress:",e)}},Te=()=>{const e=ke();return null!==e&&(!e.uploadProgress||e.uploadProgress<100)},Fe=({onUpload:e,onCancel:s})=>{const a=(0,r.Zp)(),[n,l]=(0,t.useState)(null),[i,o]=(0,t.useState)(""),[c,d]=(0,t.useState)(""),[m,h]=(0,t.useState)(""),[u,g]=(0,t.useState)(""),[p,b]=(0,t.useState)(""),[f,j]=(0,t.useState)(""),[y,v]=(0,t.useState)("meters"),[N,w]=(0,t.useState)(1),[S,k]=(0,t.useState)(!1),[A,P]=(0,t.useState)(""),[T,F]=(0,t.useState)(0),[R,D]=(0,t.useState)(!1),[I,E]=(0,t.useState)(null),{user:z}=B();(0,t.useEffect)(()=>{console.log("🔍 Checking for upload session...");try{localStorage.setItem("test","test"),localStorage.removeItem("test"),console.log("✅ localStorage is working")}catch(e){return void console.error("❌ localStorage not available:",e)}const e=ke();if(console.log("📄 Session found:",e),e&&!R){console.log("🔄 Restoring session data...");try{if(o(e.formData.name),d(e.formData.description),h(e.formData.tags),g(e.formData.projectName),b(e.formData.designer),j(e.formData.revision),v(e.formData.units),w(e.formData.scaleFactor),F(e.uploadProgress||0),e.fileData){console.log("📁 Restoring file:",e.fileName);const s=Ae(e);s?(l(s),E({name:e.fileName,size:e.fileSize}),console.log("✅ File restored successfully:",s.name)):(console.log("❌ Failed to restore file"),E({name:e.fileName,size:e.fileSize}))}else console.log("📁 No file data in session");D(!0),console.log("✅ Session restoration complete")}catch(e){console.error("❌ Failed to restore upload session:",e),Ce()}}else e?R&&console.log("✅ Session already restored"):console.log("📭 No upload session found")},[R]);return(0,x.jsxs)(O.A,{onSubmit:async s=>{if(s.preventDefault(),console.log("🚀 Form submitted with file:",n?.name),n)if(console.log("👤 User auth state:",z?"authenticated":"not authenticated"),z||console.log("⚠️ User not authenticated, but continuing for testing..."),i.trim()){console.log("📝 Starting upload process..."),k(!0),P(""),F(10);try{const s={name:i,description:c,tags:m,projectName:u,designer:p,revision:f,units:y,scaleFactor:N};await Se(n,s,10);const t=new FormData;let r;t.append("file",n),t.append("name",i||n.name),t.append("description",c),t.append("tags",JSON.stringify(m.split(",").map(e=>e.trim()).filter(Boolean))),t.append("project_name",u),t.append("designer",p),t.append("revision",f),t.append("units",y),t.append("scale_factor",N.toString()),t.append("components","[]"),F(30),Pe(30),console.log("🌐 Calling modelsAPI.upload...");try{r=await C(t),console.log("✅ Upload successful, model received:",r)}catch(e){console.log("⚠️ API upload failed, creating mock model for testing:",e),r={id:Date.now(),name:i||n.name,file_name:n.name,file_size:`${(n.size/1024/1024).toFixed(2)}MB`,file_type:n.type,description:c,tags:m.split(",").map(e=>e.trim()).filter(Boolean)}}F(100),(e=>{try{const s=ke();s&&(s.uploadedModel=e,s.uploadProgress=100,localStorage.setItem(we,JSON.stringify(s)),console.log("✅ Upload marked as complete:",e))}catch(e){console.error("❌ Failed to mark upload complete:",e)}})(r),console.log("📞 Calling onUpload callback with model and file..."),e(r,n),console.log("✅ onUpload callback completed"),console.log("🏪 Navigating to store listing after successful upload..."),a("/",{state:{view:"store",uploadedModel:r,showUploadedModel:!0}}),l(null),o(""),d(""),h(""),g(""),b(""),j(""),F(0),setTimeout(()=>{Ce()},5e3)}catch(e){P(e.response?.data?.detail||"Upload failed"),F(0),Pe(0)}finally{k(!1)}}else P("Please enter a model name");else P("Please select a file first")},className:"p-3 bg-light rounded",children:[A&&(0,x.jsx)(W.A,{variant:"danger",children:A}),(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{htmlFor:"file-upload",children:"3D Model File *"}),(0,x.jsx)(O.A.Control,{id:"file-upload",type:"file",accept:".stl,.obj,.glb,.gltf,.step,.stp",onChange:async e=>{const s=e.target.files?.[0];if(console.log("📁 File selected:",s?.name),!s)return void l(null);const a=s.name.split(".").pop()?.toLowerCase()??"";if(!["stl","obj","glb","gltf","step","stp"].includes(a))return P("Unsupported file type. Allowed: STL, OBJ, GLB, GLTF, STEP, STP"),void l(null);l(s),i||o(s.name.replace(/\.[^/.]+$/,"")),P("");const t={name:i||s.name.replace(/\.[^/.]+$/,""),description:c,tags:m,projectName:u,designer:p,revision:f,units:y,scaleFactor:N};console.log("💾 Saving file to session...",{fileName:s.name,fileSize:s.size,formData:t});try{await Se(s,t,0),console.log("✅ File saved to session successfully")}catch(e){console.error("❌ Failed to save file to session:",e)}},required:!0,disabled:S}),n&&(0,x.jsxs)(O.A.Text,{className:"text-success",children:["Selected: ",n.name," (",(n.size/1024/1024).toFixed(2),"MB)",R&&(0,x.jsx)("span",{className:"ms-2 badge bg-info",children:"Restored from session"})]}),!n&&I&&(0,x.jsx)("div",{className:"mt-2",children:(0,x.jsx)(W.A,{variant:"warning",className:"py-2",children:(0,x.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,x.jsxs)("span",{children:[(0,x.jsx)("i",{className:"fas fa-exclamation-triangle me-2"}),"Previous file: ",I.name," (",(I.size/1024/1024).toFixed(2),"MB)"]}),(0,x.jsx)("button",{type:"button",className:"btn btn-sm btn-primary",onClick:()=>{const e=ke();if(e&&e.fileData){console.log("🔄 Manually restoring file from session...");const s=Ae(e);s&&(l(s),console.log("✅ File manually restored:",s.name))}},children:"Restore File"})]})})})]}),(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{htmlFor:"model-name",children:"Model Name *"}),(0,x.jsx)(O.A.Control,{id:"model-name",type:"text",value:i,onChange:e=>o(e.target.value),placeholder:"Enter model name",required:!0,disabled:S})]}),(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{children:"Description"}),(0,x.jsx)(O.A.Control,{as:"textarea",rows:3,value:c,onChange:e=>d(e.target.value),placeholder:"Describe your model (optional)",disabled:S})]}),(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{children:"Tags"}),(0,x.jsx)(O.A.Control,{type:"text",value:m,onChange:e=>h(e.target.value),placeholder:"comma, separated, tags",disabled:S})]}),(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{children:"Project Name"}),(0,x.jsx)(O.A.Control,{type:"text",value:u,onChange:e=>g(e.target.value),placeholder:"Associated project name",disabled:S})]}),(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{children:"Designer"}),(0,x.jsx)(O.A.Control,{type:"text",value:p,onChange:e=>b(e.target.value),placeholder:"Model designer/creator",disabled:S})]}),(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{children:"Revision"}),(0,x.jsx)(O.A.Control,{type:"text",value:f,onChange:e=>j(e.target.value),placeholder:"Model revision/version",disabled:S})]}),(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{children:"Units"}),(0,x.jsxs)(O.A.Select,{value:y,onChange:e=>v(e.target.value),disabled:S,children:[(0,x.jsx)("option",{value:"millimeters",children:"Millimeters"}),(0,x.jsx)("option",{value:"centimeters",children:"Centimeters"}),(0,x.jsx)("option",{value:"meters",children:"Meters"}),(0,x.jsx)("option",{value:"inches",children:"Inches"}),(0,x.jsx)("option",{value:"feet",children:"Feet"})]})]}),(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{children:"Scale Factor"}),(0,x.jsx)(O.A.Control,{type:"number",step:"0.01",min:"0.01",max:"1000",value:N,onChange:e=>w(parseFloat(e.target.value)||1),disabled:S}),(0,x.jsx)(O.A.Text,{className:"text-muted",children:"Adjust if your model needs scaling (1.0 = no scaling)"})]}),(0,x.jsxs)("div",{className:"d-flex gap-2",children:[(0,x.jsx)("button",{type:"button",className:"btn btn-secondary text-white rounded",onClick:s,disabled:S,children:"Cancel"}),(0,x.jsx)("button",{type:"submit",className:"btn btn-primary text-white rounded",disabled:!n||S,children:S?(0,x.jsxs)("span",{children:[(0,x.jsx)(q.A,{animation:"border",size:"sm",className:"me-2"}),"Uploading... ",T,"%"]}):"Upload Model"})]}),(S||T>0)&&(0,x.jsx)("div",{className:"mt-3",children:(0,x.jsx)("div",{className:"progress",children:(0,x.jsxs)("div",{className:"progress-bar",role:"progressbar",style:{width:`${T}%`},"aria-valuenow":T,"aria-valuemin":0,"aria-valuemax":100,children:[T,"%"]})})}),R&&(0,x.jsxs)(W.A,{variant:"info",className:"mt-3",children:[(0,x.jsx)("i",{className:"fas fa-info-circle me-2"}),"Upload session restored from previous visit. Your file and form data have been recovered.",(0,x.jsx)("button",{type:"button",className:"btn btn-link btn-sm float-end",onClick:Ce,children:"Clear Session"})]})]})},Re=()=>{const e=(0,r.Zp)();return(0,x.jsx)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",paddingTop:"2rem",paddingBottom:"2rem"},children:(0,x.jsx)(ue.A,{children:(0,x.jsx)(ge.A,{className:"justify-content-center",children:(0,x.jsx)(xe.A,{md:8,lg:6,children:(0,x.jsxs)("div",{className:"bg-white rounded shadow-lg p-4",style:{background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)"},children:[(0,x.jsxs)("div",{className:"text-center mb-4",children:[(0,x.jsxs)("h2",{className:"text-primary mb-3",children:[(0,x.jsx)("i",{className:"fas fa-cloud-upload-alt me-2"}),"Upload 3D Model"]}),(0,x.jsx)("p",{className:"text-muted",children:"Upload your 3D design files to analyze with CFD simulation or list in the marketplace"})]}),(0,x.jsx)(Fe,{onUpload:(e,s)=>{console.log("✅ Model uploaded successfully:",e)},onCancel:()=>{console.log("❌ Upload cancelled, returning to main page"),e("/")}}),(0,x.jsx)("div",{className:"text-center mt-4",children:(0,x.jsx)("small",{className:"text-muted",children:"Supported formats: STL, OBJ, GLB, GLTF, STEP, STP"})})]})})})})})},De=()=>{const[e,s]=(0,t.useState)("");return(0,t.useEffect)(()=>{const e=()=>{try{const e=Object.keys(localStorage).map(e=>({key:e,value:localStorage.getItem(e),size:localStorage.getItem(e)?.length||0}));s(JSON.stringify(e,null,2)),console.log("📊 localStorage contents:",e)}catch(e){console.error("❌ Error reading localStorage:",e),s("Error reading localStorage: "+e)}};e();const a=setInterval(e,5e3);return()=>clearInterval(a)},[]),(0,x.jsxs)("div",{className:"p-3",children:[(0,x.jsx)("h4",{children:"🔍 localStorage Debug"}),(0,x.jsxs)(W.A,{variant:"info",children:[(0,x.jsx)("h6",{children:"localStorage Contents:"}),(0,x.jsx)("pre",{style:{fontSize:"12px",maxHeight:"400px",overflow:"auto"},children:e})]})]})},Ie=()=>{const e=(0,t.useRef)(null),[s,a]=(0,t.useState)(null),[n,r]=(0,t.useState)(!1),[l,i]=(0,t.useState)(null),[o,c]=(0,t.useState)({gridVisible:!0,autoRotateEnabled:!1,chatMessages:[],leftDockExpanded:!1,selectedAiModel:"gpt-4-turbo",status:"Ready for upload",uploadedFiles:[],isTyping:!1,view:"models-list"});(0,t.useEffect)(()=>{(()=>{const s=ke(),t=Te(),n=(()=>{const e=ke();return e?{fileName:e.fileName,progress:e.uploadProgress||0,model:e.uploadedModel}:null})();if(r(t),i(n),s&&s.uploadedModel){a(s.uploadedModel),c(e=>({...e,uploadedFiles:[s.uploadedModel],status:"Model loaded from previous session"}));try{const a=Ae(s);e.current&&e.current.loadFile&&e.current.loadFile(a)}catch(e){console.error("❌ Failed to restore file in canvas:",e)}}})()},[]);const d=e=>{c(s=>({...s,...e}))};return(0,x.jsxs)("div",{className:"p-3",style:{maxHeight:"100vh",overflowY:"auto"},children:[n&&l&&(0,x.jsx)(W.A,{variant:"success",className:"mb-3",children:(0,x.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("i",{className:"fas fa-cloud-download-alt me-2"}),(0,x.jsx)("strong",{children:"Upload session restored!"}),(0,x.jsxs)("span",{className:"ms-2",children:["File: ",l.fileName,l.progress>0&&` (${l.progress}% complete)`]})]}),(0,x.jsx)("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>{Ce(),r(!1),i(null),a(null),c(e=>({...e,uploadedFiles:[],status:"Ready for upload"})),e.current&&e.current.clearScene&&e.current.clearScene()},children:"Clear Session"})]})}),(0,x.jsx)(De,{}),(0,x.jsx)(Fe,{onUpload:(s,t)=>{console.log("🎯 Model uploaded in UploadModelDemo:",s),console.log("📁 File received:",t.name,t.size,t.type),a(s),c(e=>({...e,uploadedFiles:[...e.uploadedFiles,s],status:`Loading ${s.name}...`})),console.log("🎮 Attempting to load file into ThreeJSCanvas..."),e.current&&e.current.loadFile?(console.log("✅ ThreeJSCanvas ref available, calling loadFile"),e.current.loadFile(t),setTimeout(()=>{c(e=>({...e,status:`${s.name} loaded successfully`}))},1e3)):(console.warn("❌ ThreeJSCanvas ref or loadFile method not available"),console.log("canvasRef.current:",e.current),e.current&&console.log("Available methods:",Object.keys(e.current)),c(e=>({...e,status:"File uploaded but 3D viewer not ready"})))},onCancel:()=>{if(console.log("Back to main"),Te()){window.confirm("You have an active upload session. Do you want to clear it before leaving?")&&Ce()}window.history.back()}}),(0,x.jsx)("div",{className:"mt-3",style:{height:"500px",position:"relative",border:"1px solid #ccc",borderRadius:"4px"},children:(0,x.jsx)(j,{ref:e,appState:o,onStateUpdate:d})}),(0,x.jsxs)("div",{className:"mt-2 p-2 bg-light rounded",children:[(0,x.jsxs)("small",{className:"text-muted",children:["Status: ",o.status]}),s&&(0,x.jsx)("div",{className:"mt-1",children:(0,x.jsxs)("small",{className:"text-success",children:["Loaded: ",s.name," (ID: ",s.id,")"]})})]}),(0,x.jsx)("div",{className:"mt-2",children:(0,x.jsx)(de,{gridVisible:o.gridVisible,autoRotateEnabled:o.autoRotateEnabled,onToggleGrid:()=>d({gridVisible:!o.gridVisible}),onAutoRotate:()=>d({autoRotateEnabled:!o.autoRotateEnabled}),onResetView:()=>e.current?.resetCamera?.(),onUploadModel:()=>console.log("Trigger upload"),onScreenshot:()=>e.current?.takeScreenshot?.()})})]})},Ee=()=>{const[e,s]=(0,t.useState)(""),[a,n]=(0,t.useState)(""),[l,i]=(0,t.useState)(""),[o,c]=(0,t.useState)(""),[d,m]=(0,t.useState)(""),[h,u]=(0,t.useState)(""),[g,p]=(0,t.useState)(!1),[b,f]=(0,t.useState)(""),[j,y]=(0,t.useState)(!0),{login:v,register:N}=B(),w=(0,r.Zp)(),S=e=>{let s="Authentication failed";e.response?.data?.detail?Array.isArray(e.response.data.detail)?s=e.response.data.detail.map(e=>e.msg).join(", "):"string"==typeof e.response.data.detail?s=e.response.data.detail:e.response.data.detail.msg&&(s=e.response.data.detail.msg):e.response?.data?.message?s=e.response.data.message:e.message?s=e.message:422===e.response?.status&&(s="Invalid request data. Please check your input."),f(s)},k=()=>{y(!j),s(""),n(""),i(""),c(""),m(""),u(""),f("")};return(0,x.jsx)(ue.A,{fluid:!0,className:"bg-dark min-vh-100 d-flex align-items-center",children:(0,x.jsx)(ge.A,{className:"w-100 justify-content-center",children:(0,x.jsx)(xe.A,{md:6,lg:4,children:(0,x.jsx)(pe.A,{className:"shadow",children:(0,x.jsxs)(pe.A.Body,{className:"p-5",children:[(0,x.jsxs)("div",{className:"text-center mb-4",children:[(0,x.jsxs)("h2",{className:"text-primary",children:[(0,x.jsx)("i",{className:"fas fa-wind me-2"}),"CFD Analyzer"]}),(0,x.jsx)("p",{className:"text-muted",children:j?"Sign in to your account":"Create your account"})]}),b&&(0,x.jsx)(W.A,{variant:"danger",className:"mb-3",children:b}),j?(0,x.jsxs)(O.A,{onSubmit:async s=>{if(s.preventDefault(),p(!0),f(""),!e||!a)return f("Please fill in all fields"),void p(!1);try{await v(e,a),w("/")}catch(e){console.error("Login error:",e),S(e)}finally{p(!1)}},children:[(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{children:"Username"}),(0,x.jsx)(O.A.Control,{type:"text",value:e,onChange:e=>s(e.target.value),required:!0,placeholder:"Enter your username",disabled:g})]}),(0,x.jsxs)(O.A.Group,{className:"mb-4",children:[(0,x.jsx)(O.A.Label,{children:"Password"}),(0,x.jsx)(O.A.Control,{type:"password",value:a,onChange:e=>n(e.target.value),required:!0,placeholder:"Enter your password",disabled:g})]}),(0,x.jsx)("div",{className:"d-grid mb-3",children:(0,x.jsx)("button",{type:"submit",className:"btn btn-primary btn-lg",disabled:g,children:g?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status",children:(0,x.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),"Signing In..."]}):"Sign In"})}),(0,x.jsx)("div",{className:"text-center mb-3",children:(0,x.jsxs)("button",{type:"button",className:"btn btn-outline-danger w-100",onClick:()=>{window.location.href="http://localhost:8000/auth/google"},disabled:g,children:[(0,x.jsx)("i",{className:"fab fa-google me-2"}),"Continue with Google"]})}),(0,x.jsx)("div",{className:"text-center",children:(0,x.jsx)("button",{type:"button",className:"btn btn-link text-decoration-none",onClick:k,disabled:g,children:"Don't have an account? Sign up"})})]}):(0,x.jsxs)(O.A,{onSubmit:async e=>{if(e.preventDefault(),p(!0),f(""),!(l&&o&&d&&h))return f("Please fill in all fields"),void p(!1);if(d.length<6)return f("Password must be at least 6 characters long"),void p(!1);try{await N(l,o,d,h),w("/")}catch(e){console.error("Register error:",e),S(e)}finally{p(!1)}},children:[(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{children:"Full Name"}),(0,x.jsx)(O.A.Control,{type:"text",value:h,onChange:e=>u(e.target.value),required:!0,placeholder:"Enter your full name",disabled:g})]}),(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{children:"Username"}),(0,x.jsx)(O.A.Control,{type:"text",value:l,onChange:e=>i(e.target.value),required:!0,placeholder:"Choose a username",disabled:g})]}),(0,x.jsxs)(O.A.Group,{className:"mb-3",children:[(0,x.jsx)(O.A.Label,{children:"Email"}),(0,x.jsx)(O.A.Control,{type:"email",value:o,onChange:e=>c(e.target.value),required:!0,placeholder:"Enter your email",disabled:g})]}),(0,x.jsxs)(O.A.Group,{className:"mb-4",children:[(0,x.jsx)(O.A.Label,{children:"Password"}),(0,x.jsx)(O.A.Control,{type:"password",value:d,onChange:e=>m(e.target.value),required:!0,placeholder:"Choose a password",minLength:6,disabled:g}),(0,x.jsx)(O.A.Text,{className:"text-muted",children:"Password must be at least 6 characters long"})]}),(0,x.jsx)("div",{className:"d-grid mb-3",children:(0,x.jsx)("button",{type:"submit",className:"btn btn-primary btn-lg",disabled:g,children:g?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status",children:(0,x.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),"Creating Account..."]}):"Create Account"})}),(0,x.jsx)("div",{className:"text-center",children:(0,x.jsx)("button",{type:"button",className:"btn btn-link text-decoration-none",onClick:k,disabled:g,children:"Already have an account? Sign in"})})]})]})})})})})},ze=()=>{const[e,s]=(0,t.useState)([]),[a,n]=(0,t.useState)(!1),[r,l]=(0,t.useState)(""),[i,o]=(0,t.useState)({username:"admin",password:"!Ch4ng3Th1sP4ssW0rd!"}),c=e=>{s(s=>[...s,e])},d=()=>{s([])},m=e=>{switch(e){case"success":return(0,x.jsx)("span",{className:"badge bg-success",children:"✅ Success"});case"error":return(0,x.jsx)("span",{className:"badge bg-danger",children:"❌ Error"});case"warning":return(0,x.jsx)("span",{className:"badge bg-warning text-dark",children:"⚠️ Warning"});case"testing":return(0,x.jsx)("span",{className:"badge bg-info",children:"🔄 Testing"});default:return(0,x.jsx)("span",{className:"badge bg-secondary",children:"❓ Unknown"})}};return(0,x.jsx)("div",{className:"comprehensive-backend-tester p-4",children:(0,x.jsxs)("div",{className:"card border-0 shadow",children:[(0,x.jsx)("div",{className:"card-header bg-primary text-white",children:(0,x.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,x.jsxs)("h5",{className:"mb-0",children:[(0,x.jsx)("i",{className:"fas fa-network-wired me-2"}),"Backend Connectivity & API Tester"]}),(0,x.jsx)("button",{onClick:async()=>{n(!0),d(),l(""),c({name:"Test Suite",endpoint:"Multiple",method:"ALL",status:"testing",message:"Starting comprehensive backend connectivity tests..."});const e=await(async()=>{const e=Date.now();try{const s=await w.A.get(`${S.apiUrl}/`,{timeout:5e3});return{name:"Server Health",endpoint:"/",method:"GET",status:"success",message:"Backend server is running",responseTime:Date.now()-e,statusCode:s.status,data:s.data}}catch(s){return{name:"Server Health",endpoint:"/",method:"GET",status:"error",message:`Server connection failed: ${s.message}`,responseTime:Date.now()-e}}})();c(e);const s=await(async()=>{const e=Date.now();try{const s=await w.A.get(`${S.apiUrl}/docs`,{timeout:5e3});return{name:"API Documentation",endpoint:"/docs",method:"GET",status:"success",message:"API documentation is accessible",responseTime:Date.now()-e,statusCode:s.status}}catch(s){return{name:"API Documentation",endpoint:"/docs",method:"GET",status:"error",message:`Documentation access failed: ${s.message}`,responseTime:Date.now()-e}}})();c(s);const a=await(async()=>{const e=Date.now(),s={username:`test_${Date.now()}`,email:`test${Date.now()}@example.com`,password:"testPassword123",full_name:"Test User"};try{const a=await w.A.post(`${S.apiUrl}/api/v1/register`,s,{timeout:1e4,headers:{"Content-Type":"application/json"}});return{name:"User Registration",endpoint:"/api/v1/register",method:"POST",status:"success",message:"✅ User registration endpoint working with full_name schema",responseTime:Date.now()-e,statusCode:a.status,data:{registered_user:a.data.email,full_name:a.data.full_name}}}catch(s){return{name:"User Registration",endpoint:"/api/v1/register",method:"POST",status:400===s.response?.status?"warning":"error",message:400===s.response?.status?"✅ Registration endpoint working (validation error expected for test data)":`❌ Registration failed: ${s.response?.data?.detail||s.message}`,responseTime:Date.now()-e,statusCode:s.response?.status}}})();c(a);const t=await(async()=>{const e=Date.now(),s=new FormData;s.append("username",i.username),s.append("password",i.password);try{const a=await w.A.post(`${S.apiUrl}/api/v1/login`,s,{timeout:1e4,headers:{"Content-Type":"multipart/form-data"}});return a.data.access_token?(l(a.data.access_token),{name:"User Login",endpoint:"/api/v1/login",method:"POST",status:"success",message:"✅ Authentication successful - JWT token received",responseTime:Date.now()-e,statusCode:a.status,data:{token_type:a.data.token_type,username:i.username}}):{name:"User Login",endpoint:"/api/v1/login",method:"POST",status:"warning",message:"Login response received but no token found",responseTime:Date.now()-e,statusCode:a.status}}catch(s){return{name:"User Login",endpoint:"/api/v1/login",method:"POST",status:"error",message:`❌ Login failed: ${s.response?.data?.detail||s.message}`,responseTime:Date.now()-e,statusCode:s.response?.status}}})();if(c(t),r){const e=await(async()=>{if(!r)return[{name:"Commerce Endpoints",endpoint:"/api/v1/commerce/*",method:"GET",status:"warning",message:"Skipped - requires authentication token"}];const e=[],s={Authorization:`Bearer ${r}`,"Content-Type":"application/json"};try{const a=Date.now(),t=await w.A.get(`${S.apiUrl}/api/v1/commerce/designs`,{headers:s,timeout:1e4});e.push({name:"Marketplace Designs",endpoint:"/api/v1/commerce/designs",method:"GET",status:"success",message:`Marketplace accessible (${Array.isArray(t.data)?t.data.length:0} designs)`,responseTime:Date.now()-a,statusCode:t.status,data:{design_count:Array.isArray(t.data)?t.data.length:0}})}catch(s){e.push({name:"Marketplace Designs",endpoint:"/api/v1/commerce/designs",method:"GET",status:"error",message:`Marketplace access failed: ${s.response?.data?.detail||s.message}`,statusCode:s.response?.status})}const a=Date.now();try{const t={designName:"Test Design",description:"Test description for design",price:"99.99",category:"mechanical",fileOrigin:"original",licenseType:"commercial",originDeclaration:!0,qualityAssurance:!0,technicalSpecs:"Test specifications",tags:"test,design",instructions:"Test instructions"},n=await w.A.post(`${S.apiUrl}/api/v1/commerce/designs/sell`,t,{headers:s,timeout:1e4});e.push({name:"Sell Design (Frontend Form)",endpoint:"/api/v1/commerce/designs/sell",method:"POST",status:"success",message:"✅ Frontend form endpoint working - design created!",responseTime:Date.now()-a,statusCode:n.status,data:{design_id:n.data.id,design_name:n.data.name}})}catch(s){const t=400===s.response?.status?"warning":"error",n=400===s.response?.status?"✅ Sell endpoint working (validation error expected for test data)":`❌ Sell endpoint failed: ${s.response?.data?.detail||s.message}`;e.push({name:"Sell Design (Frontend Form)",endpoint:"/api/v1/commerce/designs/sell",method:"POST",status:t,message:n,responseTime:Date.now()-a,statusCode:s.response?.status})}const t=Date.now();try{const a=await w.A.get(`${S.apiUrl}/api/v1/commerce/cart`,{headers:s,timeout:1e4});e.push({name:"Shopping Cart",endpoint:"/api/v1/commerce/cart",method:"GET",status:"success",message:`Shopping cart accessible (${Array.isArray(a.data)?a.data.length:0} items)`,responseTime:Date.now()-t,statusCode:a.status,data:{cart_items:Array.isArray(a.data)?a.data.length:0}})}catch(s){e.push({name:"Shopping Cart",endpoint:"/api/v1/commerce/cart",method:"GET",status:"error",message:`Cart access failed: ${s.response?.data?.detail||s.message}`,responseTime:Date.now()-t,statusCode:s.response?.status})}return e})();e.forEach(e=>c(e));const s=await(async()=>{if(!r)return[{name:"Chat Endpoints",endpoint:"/api/v1/chat/*",method:"GET",status:"warning",message:"Skipped - requires authentication token"}];const e=[],s={Authorization:`Bearer ${r}`,"Content-Type":"application/json"};try{const a=Date.now(),t=await w.A.get(`${S.apiUrl}/api/v1/chat/sessions`,{headers:s,timeout:1e4});e.push({name:"Chat Sessions",endpoint:"/api/v1/chat/sessions",method:"GET",status:"success",message:`Chat system accessible (${Array.isArray(t.data)?t.data.length:0} sessions)`,responseTime:Date.now()-a,statusCode:t.status,data:{session_count:Array.isArray(t.data)?t.data.length:0}})}catch(s){e.push({name:"Chat Sessions",endpoint:"/api/v1/chat/sessions",method:"GET",status:"error",message:`Chat access failed: ${s.response?.data?.detail||s.message}`,statusCode:s.response?.status})}return e})();s.forEach(e=>c(e));const a=await(async()=>{if(!r)return[{name:"Labeling Endpoints",endpoint:"/api/v1/labels/*",method:"GET",status:"warning",message:"Skipped - requires authentication token"}];const e=[],s={Authorization:`Bearer ${r}`,"Content-Type":"application/json"};try{const a=Date.now(),t=await w.A.get(`${S.apiUrl}/api/v1/labels/models/1/labels`,{headers:s,timeout:1e4});e.push({name:"3D Labeling System",endpoint:"/api/v1/labels/models/1/labels",method:"GET",status:"success",message:`Labeling system accessible (${Array.isArray(t.data)?t.data.length:0} labels)`,responseTime:Date.now()-a,statusCode:t.status,data:{label_count:Array.isArray(t.data)?t.data.length:0}})}catch(s){const a=404===s.response?.status?"warning":"error",t=404===s.response?.status?"Labeling system working (model not found - expected)":`Labeling access failed: ${s.response?.data?.detail||s.message}`;e.push({name:"3D Labeling System",endpoint:"/api/v1/labels/models/1/labels",method:"GET",status:a,message:t,statusCode:s.response?.status})}return e})();a.forEach(e=>c(e))}c({name:"Test Suite",endpoint:"Complete",method:"ALL",status:"success",message:"✅ Comprehensive backend connectivity test completed!"}),n(!1)},disabled:a,className:"btn btn-light btn-sm",children:a?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("i",{className:"fas fa-spinner fa-spin me-2"}),"Testing..."]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("i",{className:"fas fa-play me-2"}),"Run Full Test"]})})]})}),(0,x.jsxs)("div",{className:"card-body",children:[(0,x.jsxs)("div",{className:"alert alert-info mb-4",children:[(0,x.jsxs)("h6",{children:[(0,x.jsx)("i",{className:"fas fa-cog me-2"}),"Current Configuration"]}),(0,x.jsxs)("div",{className:"row",children:[(0,x.jsxs)("div",{className:"col-md-6",children:[(0,x.jsx)("strong",{children:"Backend URL:"})," ",(0,x.jsx)("code",{children:S.apiUrl})]}),(0,x.jsxs)("div",{className:"col-md-6",children:[(0,x.jsx)("strong",{children:"Test Credentials:"})," ",(0,x.jsx)("code",{children:i.username})]})]})]}),(0,x.jsxs)("div",{className:"row mb-4",children:[(0,x.jsx)("div",{className:"col-md-6",children:(0,x.jsxs)("div",{className:"card border-secondary",children:[(0,x.jsx)("div",{className:"card-header",children:(0,x.jsx)("h6",{className:"mb-0",children:"Test Credentials"})}),(0,x.jsxs)("div",{className:"card-body",children:[(0,x.jsx)("div",{className:"mb-2",children:(0,x.jsx)("input",{type:"text",className:"form-control form-control-sm",placeholder:"Username",value:i.username,onChange:e=>o(s=>({...s,username:e.target.value}))})}),(0,x.jsx)("div",{className:"mb-2",children:(0,x.jsx)("input",{type:"password",className:"form-control form-control-sm",placeholder:"Password",value:i.password,onChange:e=>o(s=>({...s,password:e.target.value}))})}),r&&(0,x.jsx)("div",{className:"alert alert-success py-2 mb-0",children:(0,x.jsxs)("small",{children:[(0,x.jsx)("i",{className:"fas fa-key me-1"}),"Token acquired"]})})]})]})}),(0,x.jsx)("div",{className:"col-md-6",children:(0,x.jsxs)("div",{className:"card border-secondary",children:[(0,x.jsx)("div",{className:"card-header",children:(0,x.jsx)("h6",{className:"mb-0",children:"Quick Actions"})}),(0,x.jsx)("div",{className:"card-body",children:(0,x.jsxs)("div",{className:"d-grid gap-2",children:[(0,x.jsxs)("a",{href:`${S.apiUrl}/docs`,target:"_blank",rel:"noopener noreferrer",className:"btn btn-outline-primary btn-sm",children:[(0,x.jsx)("i",{className:"fas fa-book me-2"}),"Open API Docs"]}),(0,x.jsxs)("a",{href:`${S.apiUrl}/admin`,target:"_blank",rel:"noopener noreferrer",className:"btn btn-outline-secondary btn-sm",children:[(0,x.jsx)("i",{className:"fas fa-user-shield me-2"}),"Open Admin Panel"]}),(0,x.jsxs)("button",{onClick:d,className:"btn btn-outline-danger btn-sm",children:[(0,x.jsx)("i",{className:"fas fa-trash me-2"}),"Clear Results"]})]})})]})})]}),(0,x.jsxs)("div",{className:"test-results",children:[(0,x.jsxs)("h6",{className:"mb-3",children:["Test Results (",e.length,")"]}),0===e.length&&(0,x.jsxs)("div",{className:"alert alert-secondary text-center",children:[(0,x.jsx)("i",{className:"fas fa-info-circle me-2"}),'No tests run yet. Click "Run Full Test" to check backend connectivity.']}),e.map((e,s)=>(0,x.jsx)("div",{className:"card mb-2",children:(0,x.jsx)("div",{className:"card-body p-3",children:(0,x.jsx)("div",{className:"d-flex justify-content-between align-items-start",children:(0,x.jsxs)("div",{className:"flex-grow-1",children:[(0,x.jsxs)("div",{className:"d-flex align-items-center mb-2",children:[(0,x.jsx)("strong",{className:"me-3",children:e.name}),m(e.status),e.responseTime&&(0,x.jsxs)("small",{className:"text-muted ms-2",children:[e.responseTime,"ms"]}),e.statusCode&&(0,x.jsx)("span",{className:"badge ms-2 "+(e.statusCode<300?"bg-success":e.statusCode<500?"bg-warning text-dark":"bg-danger"),children:e.statusCode})]}),(0,x.jsx)("div",{className:"mb-2",children:(0,x.jsxs)("code",{className:"text-muted",children:[e.method," ",e.endpoint]})}),(0,x.jsx)("div",{className:"text-muted",children:e.message}),e.data&&(0,x.jsxs)("details",{className:"mt-2",children:[(0,x.jsx)("summary",{className:"text-primary",style:{cursor:"pointer"},children:(0,x.jsx)("small",{children:"Show response data"})}),(0,x.jsx)("pre",{className:"mt-2 p-2 bg-light rounded small",style:{maxHeight:"150px",overflow:"auto"},children:JSON.stringify(e.data,null,2)})]})]})})})},s))]})]})]})})};class Le extends t.Component{state={hasError:!1};static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,s){console.error("❌ Application Error Caught by Boundary:",e,s)}render(){return this.state.hasError?(0,x.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",padding:"20px",textAlign:"center"},children:[(0,x.jsx)("div",{style:{fontSize:"64px",marginBottom:"20px"},children:"⚠️"}),(0,x.jsx)("h2",{style:{color:"#dc3545",marginBottom:"16px"},children:"Something went wrong"}),(0,x.jsx)("p",{style:{color:"#666",marginBottom:"20px",maxWidth:"500px"},children:"The application encountered an error. This could be due to:"}),(0,x.jsxs)("ul",{style:{color:"#666",textAlign:"left",marginBottom:"30px"},children:[(0,x.jsx)("li",{children:"Network connectivity issues with the backend"}),(0,x.jsx)("li",{children:"Browser storage quota exceeded"}),(0,x.jsx)("li",{children:"Incompatible browser features"}),(0,x.jsx)("li",{children:"Corrupted application state"})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap"},children:[(0,x.jsx)("button",{onClick:()=>{localStorage.clear(),window.location.reload()},style:{padding:"12px 24px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"16px"},children:"🔄 Clear Data & Reload"}),(0,x.jsx)("button",{onClick:()=>window.location.reload(),style:{padding:"12px 24px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"16px"},children:"🔁 Just Reload"}),(0,x.jsx)("button",{onClick:()=>this.setState({hasError:!1}),style:{padding:"12px 24px",backgroundColor:"#ffc107",color:"black",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"16px"},children:"↩️ Try Again"})]}),this.state.error&&(0,x.jsxs)("details",{style:{marginTop:"20px",textAlign:"left",maxWidth:"600px"},children:[(0,x.jsx)("summary",{style:{cursor:"pointer",color:"#007bff"},children:"Show technical details"}),(0,x.jsx)("pre",{style:{backgroundColor:"#f8f9fa",padding:"15px",marginTop:"10px",borderRadius:"4px",fontSize:"12px",overflow:"auto",maxHeight:"200px"},children:this.state.error.toString()})]})]}):this.props.children}}const Ue=Le,$e=({onBack:e})=>{const{user:s}=B(),[a,n]=(0,t.useState)("overview"),[r,l]=(0,t.useState)([]),[i,o]=(0,t.useState)([]),[c,d]=(0,t.useState)({totalPurchases:0,totalSpent:0,totalSales:0,totalEarned:0,activeSales:0,recentPurchases:[],recentSales:[]}),[m,h]=(0,t.useState)(!0);(0,t.useEffect)(()=>{s&&u()},[s]);const u=()=>{if(s){h(!0);try{const e=se(s.id.toString()),a=ne(s.id.toString());l(e.purchases),o(e.sales),d(a),console.log("Loaded user dashboard data:",{userHistory:e,userStats:a})}catch(e){console.error("Error loading user dashboard data:",e)}finally{h(!1)}}},g=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),p=e=>`$${e.toFixed(2)}`,b=e=>{const s="badge text-uppercase";switch(e){case"completed":case"sold":return`${s} bg-success`;case"pending":return`${s} bg-warning text-dark`;case"refunded":return`${s} bg-danger`;case"active":return`${s} bg-primary`;case"inactive":return`${s} bg-secondary`;default:return`${s} bg-light text-dark`}};return s?m?(0,x.jsx)("div",{className:"container-fluid h-100 d-flex align-items-center justify-content-center",style:{background:"var(--curfd-dark, #0A0F29)",color:"white"},children:(0,x.jsxs)("div",{className:"text-center",children:[(0,x.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,x.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,x.jsx)("h5",{className:"mt-3",children:"Loading your dashboard..."})]})}):(0,x.jsxs)("div",{className:"position-fixed inset-0",style:{zIndex:1030,paddingTop:"60px",background:"var(--curfd-dark, #0A0F29)",color:"white"},children:[(0,x.jsx)("div",{className:"container-fluid border-bottom border-secondary pb-3 mb-4",children:(0,x.jsxs)("div",{className:"row align-items-center",children:[(0,x.jsxs)("div",{className:"col",children:[(0,x.jsxs)("button",{className:"btn btn-outline-light me-3",onClick:e,children:[(0,x.jsx)("i",{className:"fas fa-arrow-left me-2"}),"Back"]}),(0,x.jsxs)("h2",{className:"d-inline-block mb-0",children:[(0,x.jsx)("i",{className:"fas fa-user-circle me-2"}),s.name,"'s Dashboard"]})]}),(0,x.jsx)("div",{className:"col-auto",children:(0,x.jsxs)("button",{className:"btn btn-outline-danger btn-sm",onClick:()=>{if(!s)return;if(window.confirm("Are you sure you want to clear all your purchase and sales history? This action cannot be undone.")){(e=>{try{const s=localStorage.getItem(ee);if(!s)return!0;const a=JSON.parse(s);return delete a[e],localStorage.setItem(ee,JSON.stringify(a)),console.log("Cleared purchase history for user:",e),!0}catch(e){return console.error("Error clearing purchase history:",e),!1}})(s.id.toString())?(u(),alert("Purchase history cleared successfully.")):alert("Failed to clear purchase history.")}},title:"Clear all purchase history",children:[(0,x.jsx)("i",{className:"fas fa-trash me-2"}),"Clear History"]})})]})}),(0,x.jsxs)("div",{className:"container-fluid",children:[(0,x.jsxs)("ul",{className:"nav nav-tabs mb-4",children:[(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsxs)("button",{className:"nav-link "+("overview"===a?"active":""),style:{background:"overview"===a?"rgba(255,255,255,0.1)":"transparent",color:"white",border:"none"},onClick:()=>n("overview"),children:[(0,x.jsx)("i",{className:"fas fa-chart-line me-2"}),"Overview"]})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsxs)("button",{className:"nav-link "+("purchases"===a?"active":""),style:{background:"purchases"===a?"rgba(255,255,255,0.1)":"transparent",color:"white",border:"none"},onClick:()=>n("purchases"),children:[(0,x.jsx)("i",{className:"fas fa-shopping-cart me-2"}),"Purchases (",c.totalPurchases,")"]})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsxs)("button",{className:"nav-link "+("sales"===a?"active":""),style:{background:"sales"===a?"rgba(255,255,255,0.1)":"transparent",color:"white",border:"none"},onClick:()=>n("sales"),children:[(0,x.jsx)("i",{className:"fas fa-store me-2"}),"Sales (",c.activeSales," active)"]})})]}),"overview"===a&&(0,x.jsxs)("div",{className:"row",children:[(0,x.jsx)("div",{className:"col-12 mb-4",children:(0,x.jsxs)("div",{className:"row g-3",children:[(0,x.jsx)("div",{className:"col-md-3",children:(0,x.jsx)("div",{className:"card bg-primary text-white",children:(0,x.jsxs)("div",{className:"card-body text-center",children:[(0,x.jsx)("i",{className:"fas fa-shopping-bag fa-3x mb-3"}),(0,x.jsx)("h4",{children:c.totalPurchases}),(0,x.jsx)("p",{className:"mb-0",children:"Total Purchases"})]})})}),(0,x.jsx)("div",{className:"col-md-3",children:(0,x.jsx)("div",{className:"card bg-success text-white",children:(0,x.jsxs)("div",{className:"card-body text-center",children:[(0,x.jsx)("i",{className:"fas fa-dollar-sign fa-3x mb-3"}),(0,x.jsx)("h4",{children:p(c.totalSpent)}),(0,x.jsx)("p",{className:"mb-0",children:"Total Spent"})]})})}),(0,x.jsx)("div",{className:"col-md-3",children:(0,x.jsx)("div",{className:"card bg-info text-white",children:(0,x.jsxs)("div",{className:"card-body text-center",children:[(0,x.jsx)("i",{className:"fas fa-store fa-3x mb-3"}),(0,x.jsx)("h4",{children:c.totalSales}),(0,x.jsx)("p",{className:"mb-0",children:"Items Sold"})]})})}),(0,x.jsx)("div",{className:"col-md-3",children:(0,x.jsx)("div",{className:"card bg-warning text-dark",children:(0,x.jsxs)("div",{className:"card-body text-center",children:[(0,x.jsx)("i",{className:"fas fa-coins fa-3x mb-3"}),(0,x.jsx)("h4",{children:p(c.totalEarned)}),(0,x.jsx)("p",{className:"mb-0",children:"Total Earned"})]})})})]})}),(0,x.jsx)("div",{className:"col-lg-6",children:(0,x.jsxs)("div",{className:"card bg-dark border-secondary",children:[(0,x.jsx)("div",{className:"card-header",children:(0,x.jsx)("h5",{className:"mb-0",children:"Recent Purchases"})}),(0,x.jsx)("div",{className:"card-body",children:0===c.recentPurchases.length?(0,x.jsx)("p",{className:"text-muted",children:"No purchases yet"}):c.recentPurchases.map(e=>(0,x.jsx)("div",{className:"border-bottom border-secondary pb-2 mb-2",children:(0,x.jsxs)("div",{className:"d-flex justify-content-between align-items-start",children:[(0,x.jsxs)("div",{children:[(0,x.jsxs)("strong",{children:[e.items.length," item(s)"]}),(0,x.jsx)("div",{className:"text-muted small",children:g(e.purchaseDate)})]}),(0,x.jsxs)("div",{className:"text-end",children:[(0,x.jsx)("div",{className:"text-success",children:p(e.total)}),(0,x.jsx)("span",{className:b(e.status),children:e.status})]})]})},e.id))})]})}),(0,x.jsx)("div",{className:"col-lg-6",children:(0,x.jsxs)("div",{className:"card bg-dark border-secondary",children:[(0,x.jsx)("div",{className:"card-header",children:(0,x.jsx)("h5",{className:"mb-0",children:"Recent Sales"})}),(0,x.jsx)("div",{className:"card-body",children:0===c.recentSales.length?(0,x.jsx)("p",{className:"text-muted",children:"No sales yet"}):c.recentSales.map(e=>(0,x.jsx)("div",{className:"border-bottom border-secondary pb-2 mb-2",children:(0,x.jsxs)("div",{className:"d-flex justify-content-between align-items-start",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:e.item.name}),(0,x.jsx)("div",{className:"text-muted small",children:g(e.saleDate)})]}),(0,x.jsxs)("div",{className:"text-end",children:[(0,x.jsx)("div",{className:"text-warning",children:p(e.salePrice)}),(0,x.jsx)("span",{className:b(e.status),children:e.status})]})]})},e.id))})]})})]}),"purchases"===a&&(0,x.jsx)("div",{className:"row",children:(0,x.jsx)("div",{className:"col-12",children:(0,x.jsxs)("div",{className:"card bg-dark border-secondary",children:[(0,x.jsx)("div",{className:"card-header",children:(0,x.jsx)("h5",{className:"mb-0",children:"Purchase History"})}),(0,x.jsx)("div",{className:"card-body",children:0===r.length?(0,x.jsxs)("div",{className:"text-center py-5",children:[(0,x.jsx)("i",{className:"fas fa-shopping-cart fa-4x text-muted mb-3"}),(0,x.jsx)("h5",{className:"text-muted",children:"No purchases yet"}),(0,x.jsx)("p",{className:"text-muted",children:"Your purchase history will appear here after you buy something."})]}):(0,x.jsx)("div",{className:"table-responsive",children:(0,x.jsxs)("table",{className:"table table-dark table-striped",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Order ID"}),(0,x.jsx)("th",{children:"Items"}),(0,x.jsx)("th",{children:"Date"}),(0,x.jsx)("th",{children:"Subtotal"}),(0,x.jsx)("th",{children:"Tax"}),(0,x.jsx)("th",{children:"Total"}),(0,x.jsx)("th",{children:"Status"})]})}),(0,x.jsx)("tbody",{children:r.map(e=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:(0,x.jsxs)("small",{className:"font-monospace",children:["#",e.id.slice(-8)]})}),(0,x.jsx)("td",{children:(0,x.jsx)("div",{children:e.items.map((e,s)=>(0,x.jsxs)("div",{className:"small",children:[e.name," × ",e.quantity]},s))})}),(0,x.jsx)("td",{className:"small",children:g(e.purchaseDate)}),(0,x.jsx)("td",{children:p(e.subtotal)}),(0,x.jsx)("td",{children:p(e.tax)}),(0,x.jsx)("td",{children:(0,x.jsx)("strong",{children:p(e.total)})}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{className:b(e.status),children:e.status})})]},e.id))})]})})})]})})}),"sales"===a&&(0,x.jsx)("div",{className:"row",children:(0,x.jsx)("div",{className:"col-12",children:(0,x.jsxs)("div",{className:"card bg-dark border-secondary",children:[(0,x.jsx)("div",{className:"card-header",children:(0,x.jsx)("h5",{className:"mb-0",children:"Sales History"})}),(0,x.jsx)("div",{className:"card-body",children:0===i.length?(0,x.jsxs)("div",{className:"text-center py-5",children:[(0,x.jsx)("i",{className:"fas fa-store fa-4x text-muted mb-3"}),(0,x.jsx)("h5",{className:"text-muted",children:"No sales yet"}),(0,x.jsx)("p",{className:"text-muted",children:"When you list items for sale, they will appear here."})]}):(0,x.jsx)("div",{className:"table-responsive",children:(0,x.jsxs)("table",{className:"table table-dark table-striped",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Item"}),(0,x.jsx)("th",{children:"Listed Date"}),(0,x.jsx)("th",{children:"Sale Price"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Buyer"})]})}),(0,x.jsx)("tbody",{children:i.map(e=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:e.item.name}),(0,x.jsx)("div",{className:"text-muted small",children:e.item.description})]})}),(0,x.jsx)("td",{className:"small",children:g(e.saleDate)}),(0,x.jsx)("td",{children:(0,x.jsx)("strong",{children:p(e.salePrice)})}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{className:b(e.status),children:e.status})}),(0,x.jsx)("td",{children:e.buyerId?(0,x.jsxs)("span",{className:"small font-monospace",children:["User #",e.buyerId]}):(0,x.jsx)("span",{className:"text-muted",children:"-"})})]},e.id))})]})})})]})})})]})]}):(0,x.jsx)("div",{className:"container-fluid h-100 d-flex align-items-center justify-content-center",style:{background:"var(--curfd-dark, #0A0F29)",color:"white"},children:(0,x.jsxs)("div",{className:"text-center",children:[(0,x.jsx)("h3",{children:"Please log in to view your dashboard"}),(0,x.jsx)("button",{className:"btn btn-primary mt-3",onClick:e,children:"Back to Main"})]})})},Me=()=>{const{loading:e}=B(),s=(0,r.zy)();return(0,t.useEffect)(()=>{var e;e=s.pathname,ve({lastRoute:e})},[s.pathname]),e?(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",flexDirection:"column"},children:[(0,x.jsx)("div",{style:{fontSize:"48px",marginBottom:"20px"},children:"🌊"}),(0,x.jsx)("div",{style:{fontSize:"18px",color:"#007bff"},children:"Loading Fluid Simulator..."}),(0,x.jsx)("div",{style:{fontSize:"14px",color:"#666",marginTop:"10px"},children:"Restoring your session"})]}):(0,x.jsx)("div",{children:(0,x.jsxs)(r.BV,{children:[(0,x.jsx)(r.qh,{path:"/",element:(0,x.jsx)(he,{})}),(0,x.jsx)(r.qh,{path:"/feed",element:(0,x.jsx)(je,{onModelSelect:e=>console.log("Selected:",e),onBackToMain:()=>window.history.back()})}),(0,x.jsx)(r.qh,{path:"/upload",element:(0,x.jsx)(Re,{})}),(0,x.jsx)(r.qh,{path:"/upload-demo",element:(0,x.jsx)(Ie,{})}),(0,x.jsx)(r.qh,{path:"/login",element:(0,x.jsx)(Ee,{})}),(0,x.jsx)(r.qh,{path:"/dashboard",element:(0,x.jsx)($e,{onBack:()=>window.history.back()})}),(0,x.jsx)(r.qh,{path:"/test-backend",element:(0,x.jsx)(ze,{})})]})})};function Be(){return(0,x.jsx)(Ue,{children:(0,x.jsx)(M,{children:(0,x.jsx)(Me,{})})})}const _e=document.createElement("div");document.body.appendChild(_e);n.createRoot(_e).render((0,x.jsx)(t.StrictMode,{children:(0,x.jsx)(r.Kd,{children:(0,x.jsx)(Be,{})})}))}},n={};function r(e){var s=n[e];if(void 0!==s)return s.exports;var a=n[e]={exports:{}};return t[e].call(a.exports,a,a.exports,r),a.exports}r.m=t,e=[],r.O=(s,a,t,n)=>{if(!a){var l=1/0;for(d=0;d<e.length;d++){for(var[a,t,n]=e[d],i=!0,o=0;o<a.length;o++)(!1&n||l>=n)&&Object.keys(r.O).every(e=>r.O[e](a[o]))?a.splice(o--,1):(i=!1,n<l&&(l=n));if(i){e.splice(d--,1);var c=t();void 0!==c&&(s=c)}}return s}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[a,t,n]},r.n=e=>{var s=e&&e.__esModule?()=>e.default:()=>e;return r.d(s,{a:s}),s},a=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,r.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var n=Object.create(null);r.r(n);var l={};s=s||[null,a({}),a([]),a(a)];for(var i=2&t&&e;("object"==typeof i||"function"==typeof i)&&!~s.indexOf(i);i=a(i))Object.getOwnPropertyNames(i).forEach(s=>l[s]=()=>e[s]);return l.default=()=>e,r.d(n,l),n},r.d=(e,s)=>{for(var a in s)r.o(s,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:s[a]})},r.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={792:0};r.O.j=s=>0===e[s];var s=(s,a)=>{var t,n,[l,i,o]=a,c=0;if(l.some(s=>0!==e[s])){for(t in i)r.o(i,t)&&(r.m[t]=i[t]);if(o)var d=o(r)}for(s&&s(a);c<l.length;c++)n=l[c],r.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return r.O(d)},a=globalThis.webpackChunk=globalThis.webpackChunk||[];a.forEach(s.bind(null,0)),a.push=s.bind(null,a.push.bind(a))})();var l=r.O(void 0,[634],()=>r(4579));l=r.O(l)})();